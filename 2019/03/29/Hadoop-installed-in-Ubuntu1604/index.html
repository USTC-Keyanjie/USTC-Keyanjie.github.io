<!DOCTYPE html>
<html lang="zh-CN">










<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="description">
    <meta name="author" content="Alan Ke">
    <meta name="keywords" content>
    <title>分布式lab1：Ubuntu16.04上Hadoop环境安装 ~ Alan&#39;s Notebook🦍</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.2/css/all.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/css/mdb.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_1067060_vr10bjtg3us.css">
    
        <link rel="stylesheet" href="/css/Prettify/tomorrow-night-eighties.min.css">
    
</head>

<body>
  <header style="height: 30vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
<div class="container">
    <a class="navbar-brand" href="/"><strong>Alan&#39;s Notebook🦍</strong></a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto text-center">
            
            <li class="nav-item">
                <a class="nav-link" href="/">Home🍹</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/archives/">Archives🍭</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">About🍧</a>
            </li>
            
        </ul>
    </div>
</div>


</nav>
    <div class="view intro-2" style='background: url("http://pp41mkw5b.bkt.clouddn.com/static/images/0_post.jpg")no-repeat center center;background-size: cover;'>
    <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
        <div class="container text-center white-text wow fadeInUp">
            <p class="h2">分布式lab1：Ubuntu16.04上Hadoop环境安装</p>
            <br>
            
            <p>Friday, March 29th 2019, 2:18 am</p>
            
        </div>
        </div>
    </div>
    </div>
  </header>

  <main>
  
  <div class="container-fluid">
    <div class="row">
        <div class="col-md-8 offset-md-2 ">
            <div class="post-content py-5 z-depth-3 main">
                <p>分布式第一次实验，怎么坑这么多！🤯</p>
<a id="more"></a>
<h2 id="VMware虚拟机桥接模式设置"><a href="#VMware虚拟机桥接模式设置" class="headerlink" title="VMware虚拟机桥接模式设置"></a>VMware虚拟机桥接模式设置</h2><p>参考这个<a href="https://blog.csdn.net/ccyhummer/article/details/80714430" target="_blank" rel="noopener">文章</a>，（没用过VMware23333）</p>
<h2 id="Parallels虚拟机桥接模式设置"><a href="#Parallels虚拟机桥接模式设置" class="headerlink" title="Parallels虚拟机桥接模式设置"></a>Parallels虚拟机桥接模式设置</h2><p>参考这个<a href="https://blog.csdn.net/wuxiangmujingli/article/details/52671448" target="_blank" rel="noopener">文章</a>，IP的起始地址设为192.168.1.11，结束地址设为192.168.1.31</p>
<h2 id="hostname的配置操作"><a href="#hostname的配置操作" class="headerlink" title="hostname的配置操作"></a>hostname的配置操作</h2><ol>
<li><p>修改hosts文件，如下（master节点、slave1节点、slave2节点都做）：</p>
<pre><code class="shell">sudo su root # 若当前不是root就进入root账户
gedit /etc/hosts
</code></pre>
<p>修改内容如下：</p>
<pre><code class="shell">192.168.1.11    master
192.168.1.12    slave1
192.168.1.13    slave2
</code></pre>
</li>
<li><p>修改hostname</p>
<pre><code class="shell"># master节点上修改为master，salve1节点和slave2节点上分别修改为slave1、slave2
hostname master/slave1/slave2
</code></pre>
<p>这样不能彻底修改hostname（主机名），重启后还会还原到默认的Ubuntu，要彻底修改要修改/etc/hostname，namenode和datanode各自修改为自己的hostname</p>
<p>直接用编辑器打开<strong>/etc/hostname</strong>这个文件<strong>，把原来的名称</strong>删掉<strong>，</strong>不要用#注释，直接删掉，因为#没用，<strong>修改内容</strong>：</p>
<pre><code class="shell"># master节点上修改为master，salve1节点和slave2节点上分别修改为slave1、slave2
master/slave1/slave2
</code></pre>
<p>退出shell客户端，重新进入，并且换成root操作(这是教程上的一步，没看懂这是什么操作)</p>
<pre><code class="shell">exit
sudo su root
</code></pre>
</li>
<li><p>这些工作都做好了，互相ping一下看看能不能ping通，ping 节点名称</p>
<pre><code class="shell">ping master/slave1/slave2
</code></pre>
</li>
</ol>
<h2 id="安装jdk-所有节点都做"><a href="#安装jdk-所有节点都做" class="headerlink" title="安装jdk(所有节点都做)"></a>安装jdk(所有节点都做)</h2><ol>
<li><p>前往<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="noopener">oracle Java官网</a>下载JDK</p>
</li>
<li><p>确保当前是系统账户</p>
<pre><code class="shell">sudo su root
</code></pre>
</li>
<li><p>解压缩到指定目录（以jdk-8u201-linux-x64.tar.gz为例）</p>
<p>创建目录:</p>
<pre><code class="shell">mkdir /usr/lib/jvm
</code></pre>
<p>解压缩到该目录:</p>
<pre><code class="shell">tar -zxvf jdk-8u201-linux-x64.tar.gz -C /usr/lib/jvm
</code></pre>
</li>
<li><p>修改环境变量，如果提示没有装vim就使用<code>apt install vim</code>装一个:　　</p>
<pre><code class="shell">vim ~/.bashrc
</code></pre>
<p>在文件末尾追加下面内容：</p>
<pre><code class="shell">#set oracle jdk environment
export JAVA_HOME=/usr/lib/jvm/jdk1.8.0_201  # 这里要注意目录要换成自己解压的jdk 目录
export JRE_HOME=${JAVA_HOME}/jre  
export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib  
export PATH=${JAVA_HOME}/bin:$PATH 
</code></pre>
</li>
<li><p>使环境变量马上生效：</p>
<pre><code class="shell">source ~/.bashrc
</code></pre>
</li>
<li><p>系统注册此jdk</p>
<pre><code class="shell">update-alternatives --install /usr/bin/java java /usr/lib/jvm/jdk1.8.0_201/bin/java 300
</code></pre>
</li>
<li><p>查看java版本，看看是否安装成功：</p>
<pre><code class="shell">java -version
</code></pre>
</li>
</ol>
<h2 id="SSH无密码验证配置"><a href="#SSH无密码验证配置" class="headerlink" title="SSH无密码验证配置"></a>SSH无密码验证配置</h2><h3 id="在master节点上："><a href="#在master节点上：" class="headerlink" title="在master节点上："></a>在master节点上：</h3><ol>
<li><p>先安装ssh</p>
<pre><code class="shell">sudo apt-get install ssh
</code></pre>
</li>
<li><p>先创建本地公钥：</p>
<pre><code class="shell">mkdir ~/.ssh
cd ~/.ssh               
rm ./id_rsa*            # 删除之前生成的公匙（如果有）
ssh-keygen -t rsa       # 一直按回车就可以
</code></pre>
</li>
<li><p>让 Master 节点需能无密码 SSH 本机，在 Master 节点上执行：</p>
<pre><code class="shell">cat ./id_rsa.pub &gt;&gt; ./authorized_keys
</code></pre>
</li>
<li><p>完成后可执行 <code>ssh Master</code> 验证一下（可能需要输入 yes，成功后执行 <code>exit</code> 返回原来的终端）。接着在 master 节点将上公匙传输到 slave1 节点和slave2节点：</p>
<pre><code class="shell">scp ./id_rsa.pub parallels@slave1:/home/parallels/  # 向slave1节点传
scp ./id_rsa.pub parallels@slave2:/home/parallels/  # 向slave2节点传
</code></pre>
</li>
</ol>
<h3 id="在slave1节点上（slave2同理）："><a href="#在slave1节点上（slave2同理）：" class="headerlink" title="在slave1节点上（slave2同理）："></a>在slave1节点上（slave2同理）：</h3><ol>
<li><p>将 ssh 公匙加入授权：</p>
<pre><code class="shell">mkdir /root/.ssh       # 如果不存在该文件夹需先创建，若已存在则忽略
cat /home/parallels/id_rsa.pub &gt;&gt; /root/.ssh/authorized_keys
</code></pre>
</li>
</ol>
<h3 id="在master节点上测试："><a href="#在master节点上测试：" class="headerlink" title="在master节点上测试："></a>在master节点上测试：</h3><p>执行<code>ssh slave1</code>，会有这样的结果：</p>
<img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_1.png">
<p>那么说明成功了，再执行<code>ssh slave2</code>看看。</p>
<h2 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h2><p><strong>所有节点上</strong>，执行<code>ufw disable</code>就好。</p>
<h2 id="安装Hadoop"><a href="#安装Hadoop" class="headerlink" title="安装Hadoop"></a>安装Hadoop</h2><h3 id="在master节点上：-1"><a href="#在master节点上：-1" class="headerlink" title="在master节点上："></a>在master节点上：</h3><p>[注]全程在root账户下运行</p>
<pre><code class="shell">sudo su root # 若当前不是root就进入root账户
</code></pre>
<ol>
<li><p>到Hadoop<a href="https://hadoop.apache.org/releases.html" target="_blank" rel="noopener">官网</a>下载binary的hadoop，我下载的是<strong>hadoop-2.8.5.tar.gz</strong>文件</p>
</li>
<li><p>在/usr/local目录下建立hadoop目录</p>
<pre><code class="shell">mkdir /usr/local/hadoop
</code></pre>
</li>
<li><p>把<strong>hadoop-2.8.5.tar.gz</strong>拷贝到/usr/local/<strong>hadoop</strong>目录下，然后解压，这里的<code>&lt;path&gt;</code>写自己的下载位置</p>
<pre><code class="shell">cp &lt;path&gt;/hadoop-2.8.5.tar.gz /usr/local/hadoop
cd /usr/local/hadoop
tar –zxvf hadoop-2.8.5.tar.gz
cd hadoop-2.8.5
</code></pre>
</li>
<li><p>在/usr/local/<strong>hadoop</strong>目录下新建tmp文件夹和hdfs文件夹</p>
<pre><code class="shell">cd /usr/local/hadoop
mkdir tmp
mkdir hdfs
</code></pre>
</li>
<li><p>编辑（可用<code>vim hadoop-env.sh</code>也可双击打开编辑）hadoop-2.8.5/etc/hadoop/<strong>hadoop-env.sh</strong>文件，把JAVA_HOME设置成Java安装根路径，如下：</p>
<pre><code class="shell">cd /usr/local/hadoop/hadoop-2.8.5/etc/hadoop
export JAVA_HOME=/usr/lib/jvm/jdk1.8.0_201
</code></pre>
</li>
<li><p>新建<strong>slaves</strong>文件</p>
<pre><code class="shell">vi slaves
</code></pre>
<p>添加这两条</p>
<pre><code>slave1
slave2
</code></pre></li>
<li><p>编辑<strong>master</strong>文件，全文改为<code>master</code></p>
</li>
<li><p>修改hadoop-2.8.5/etc/hadoop/<strong>core-site.xml</strong>文件(我在文件系统里使用的sublime修改的文件，也可以直接双击使用gedit打开)</p>
<pre><code class="xml">&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;fs.defaultFS&lt;/name&gt;
        &lt;value&gt;hdfs://master:9000&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
        &lt;value&gt;file:/usr/local/hadoop/tmp&lt;/value&gt;
        &lt;description&gt;Abase for other temporary directories.&lt;/description&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre>
</li>
<li><p>修改hadoop-2.8.5/etc/hadoop/<strong>hdfs-site.xml</strong>文件</p>
<pre><code class="xml">&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;
        &lt;value&gt;master:50090&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;dfs.replication&lt;/name&gt;
        &lt;value&gt;3&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;
        &lt;value&gt;file:/usr/local/hadoop/hdfs/name&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;
        &lt;value&gt;file:/usr/local/hadoop/hdfs/data&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre>
</li>
<li><p>修改hadoop-2.8.5/etc/hadoop/<strong>mapred-site.xml</strong>文件(可能需要先重命名，默认文件名为 mapred-site.xml.template)</p>
<pre><code class="xml">&lt;configuration&gt;
  &lt;property&gt;
      &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
      &lt;value&gt;yarn&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
      &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;
      &lt;value&gt;master:10020&lt;/value&gt;
  &lt;/property&gt;
  &lt;property&gt;
      &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;
      &lt;value&gt;master:19888&lt;/value&gt;
  &lt;/property&gt;
&lt;/configuration&gt;
</code></pre>
</li>
<li><p>修改hadoop-2.8.5/etc/hadoop/<strong>yarn-site.xml</strong>文件</p>
<pre><code class="xml">&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;
        &lt;value&gt;master&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
        &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre>
</li>
<li><p>将配置好的文件复制到<strong>各个slave</strong>节点上：</p>
<pre><code class="shell">cd /usr/local
sudo rm -r ./hadoop/tmp     # 删除 Hadoop 临时文件
tar -zcf ~/hadoop.master.tar.gz ./hadoop   # 先压缩再复制
cd ~
scp ./hadoop.master.tar.gz slave1:/home/parallels
scp ./hadoop.master.tar.gz slave2:/home/parallels
</code></pre>
</li>
</ol>
<h3 id="在slave1节点上："><a href="#在slave1节点上：" class="headerlink" title="在slave1节点上："></a>在slave1节点上：</h3><ol>
<li><p>解压文件，并修改<strong>owner</strong></p>
<pre><code class="shell">sudo su root # 若当前不是root就进入root账户
rm -r /usr/local/hadoop    # 删掉旧的（如果存在）
tar -zxf /home/parallels/hadoop.master.tar.gz -C /usr/local
</code></pre>
</li>
</ol>
<h3 id="回到master节点"><a href="#回到master节点" class="headerlink" title="回到master节点"></a>回到master节点</h3><ol>
<li><p>到/usr/local/hadoop/hadoop-2.8.5/<strong>bin</strong>文件夹下，在 Master 节点执行 NameNode 的格式化</p>
<pre><code class="shell">cd /usr/local/hadoop/hadoop-2.8.5/bin
./hadoop namenode -format
</code></pre>
</li>
<li><p>接着可以启动 hadoop 了，启动需要在 <strong>Master</strong> 节点的<strong>sbin</strong>文件夹中进行：</p>
<pre><code class="shell">cd /usr/local/hadoop/hadoop-2.8.5/sbin
./start-all.sh
mr-jobhistory-daemon.sh start historyserver
</code></pre>
<img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_5.png">
<p>通过命令 <code>jps</code> 可以查看各个节点所启动的进程。正确的话，在 Master 节点上可以看到 NameNode、ResourceManager、SecondrryNameNode、JobHistoryServer 进程。</p>
<img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_2.png">
</li>
<li><p>分别进入slave1节点和slave2节点，使用<code>jps</code>命令查看运行情况</p>
<img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_6.png">
<img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_8.png">
</li>
<li><p>在namenode上查看集群状态</p>
<pre><code class="shell">cd /usr/local/hadoop/hadoop-2.8.5/bin
./hadoop dfsadmin -report
</code></pre>
<p>此时可以通过在浏览器中打开<a href="http://master:50070" target="_blank" rel="noopener">http://master:50070</a>查看。</p>
<img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_3.png">
</li>
</ol>
<h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>如各位同学发现问题欢迎指正，但我评论功能还没有开233333，暂时发QQ（770709456）或者邮件（<a href="mailto:keyanjie@mail.ustc.edu.cn" target="_blank" rel="noopener">keyanjie@mail.ustc.edu.cn</a>）吧</p>
<h2 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h2><p>感谢苏璐岩、<a href="wanghj.net">王海杰</a>、汪宇同学为本文指正错误</p>

                <hr>
                <div>
                    <p>
                        
                    </p>
                </div>
                <br>
                
                    <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
                
            </div>
        </div>
        <div class="d-none d-md-block col-md-2">
            
  <div id="toc" class="py-5">
    <p class="h6"><i class="iconfont icon-toc" style="vertical-align:middle"></i> Toc:</p> 
    <div id="tocbot"></div>
  </div>

        </div>
    </div>        
</div>

<br><br><br>

<!-- Comments -->
<div class="comments" id="comments">
 
</div>
  
  </main>

<footer class="mt-5">
  <div class="text-center py-3">
    <a href="https://hexo.io" target="_blank"><b>HEXO</b></a>
    <i class="iconfont icon-love"></i>
    <a href="https://github.com/0x2e/Material-T" target="_blank"> <b>Material-T</b></a>
  </div>
</footer>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/jquery-3.3.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/mdb.min.js"></script>
  <script src="/js/main.js"></script>
  
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    
    <script src="/js/post.js"></script>
    
      <script src="/js/plugins/prettify.js"></script>
      <script>
          $(document).ready(function(){
              $('pre').addClass('prettyprint linenums');
              prettyPrint();
          })
      </script>
    
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<!--<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->
</body>
</html>
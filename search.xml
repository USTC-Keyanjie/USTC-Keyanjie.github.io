<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>åˆ†å¸ƒå¼lab2ï¼šHadoop Distributed File System(HDFS)ä¸Šçš„åŸºæœ¬æ“ä½œ</title>
      <link href="/2019/03/30/Basic-operations-on-HDFS/"/>
      <url>/2019/03/30/Basic-operations-on-HDFS/</url>
      
        <content type="html"><![CDATA[<p>åˆ†å¸ƒå¼ç¬¬äºŒæ¬¡å®éªŒã€‚</p><a id="more"></a><h2 id="é¦–å…ˆ"><a href="#é¦–å…ˆ" class="headerlink" title="é¦–å…ˆ"></a>é¦–å…ˆ</h2><p>ä½¿ç”¨masterèŠ‚ç‚¹è¿›è¡Œæ“ä½œï¼Œå¦å¤–ä¸¤ä¸ªèŠ‚ç‚¹ä¹Ÿè¦å¼€æœºã€‚</p><h2 id="å…ˆè¿›å…¥rootè´¦æˆ·"><a href="#å…ˆè¿›å…¥rootè´¦æˆ·" class="headerlink" title="å…ˆè¿›å…¥rootè´¦æˆ·"></a>å…ˆè¿›å…¥rootè´¦æˆ·</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su root</span><br></pre></td></tr></table></figure></div><h2 id="å°†binç›®å½•å’Œsbinç›®å½•é‡Œçš„å‘½ä»¤é…å…¥ç¯å¢ƒå˜é‡"><a href="#å°†binç›®å½•å’Œsbinç›®å½•é‡Œçš„å‘½ä»¤é…å…¥ç¯å¢ƒå˜é‡" class="headerlink" title="å°†binç›®å½•å’Œsbinç›®å½•é‡Œçš„å‘½ä»¤é…å…¥ç¯å¢ƒå˜é‡"></a>å°†binç›®å½•å’Œsbinç›®å½•é‡Œçš„å‘½ä»¤é…å…¥ç¯å¢ƒå˜é‡</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure></div><p>æŒ‰ä¸‹<code>i</code>ï¼Œåœ¨æœ€åæ·»åŠ ä¸€è¡Œï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:/usr/local/hadoop/hadoop-2.8.5/sbin:/usr/local/hadoop/hadoop-2.8.5/bin</span><br></pre></td></tr></table></figure></div><p>ç„¶åæŒ‰ä¸‹<code>esc</code>ï¼Œè¾“å…¥<code>:wq</code>å†™å…¥æ–‡ä»¶ã€‚</p><h2 id="å¯åŠ¨Hadoop"><a href="#å¯åŠ¨Hadoop" class="headerlink" title="å¯åŠ¨Hadoop"></a>å¯åŠ¨Hadoop</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-all.sh</span><br></pre></td></tr></table></figure></div><h2 id="HDFSå‘½ä»¤"><a href="#HDFSå‘½ä»¤" class="headerlink" title="HDFSå‘½ä»¤"></a>HDFSå‘½ä»¤</h2><h3 id="æŸ¥çœ‹HDFSä¸Šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶"><a href="#æŸ¥çœ‹HDFSä¸Šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶" class="headerlink" title="æŸ¥çœ‹HDFSä¸Šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶"></a>æŸ¥çœ‹HDFSä¸Šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -ls /</span><br></pre></td></tr></table></figure></div><h3 id="é€’å½’æŸ¥çœ‹HDFSä¸Šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶"><a href="#é€’å½’æŸ¥çœ‹HDFSä¸Šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶" class="headerlink" title="é€’å½’æŸ¥çœ‹HDFSä¸Šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶"></a>é€’å½’æŸ¥çœ‹HDFSä¸Šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</h3><p>è¿™æ¡å‘½ä»¤ä¼šé€’å½’è¿›å…¥æ¯ä¸ªæ–‡ä»¶å¤¹ï¼Œå±•ç¤ºå‡ºæ‰€æœ‰æ–‡ä»¶ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -ls -R /</span><br></pre></td></tr></table></figure></div><h3 id="åœ¨HDFSä¸Šæ–°å»ºæ–‡ä»¶å¤¹"><a href="#åœ¨HDFSä¸Šæ–°å»ºæ–‡ä»¶å¤¹" class="headerlink" title="åœ¨HDFSä¸Šæ–°å»ºæ–‡ä»¶å¤¹"></a>åœ¨HDFSä¸Šæ–°å»ºæ–‡ä»¶å¤¹</h3><h4 id="æ–¹å¼1-é€ä¸ªå»ºç«‹æ–‡ä»¶å¤¹"><a href="#æ–¹å¼1-é€ä¸ªå»ºç«‹æ–‡ä»¶å¤¹" class="headerlink" title="æ–¹å¼1 é€ä¸ªå»ºç«‹æ–‡ä»¶å¤¹"></a>æ–¹å¼1 é€ä¸ªå»ºç«‹æ–‡ä»¶å¤¹</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -mkdir /user</span><br><span class="line">hadoop fs -mkdir /user/hadoop-user/</span><br></pre></td></tr></table></figure></div><h4 id="æ–¹å¼2-é€’å½’å»ºç«‹æ–‡ä»¶å¤¹"><a href="#æ–¹å¼2-é€’å½’å»ºç«‹æ–‡ä»¶å¤¹" class="headerlink" title="æ–¹å¼2 é€’å½’å»ºç«‹æ–‡ä»¶å¤¹"></a>æ–¹å¼2 é€’å½’å»ºç«‹æ–‡ä»¶å¤¹</h4><p>è¿™ç§æ–¹å¼ä¸‹ï¼Œå¦‚æœè¦å»ºç«‹çš„æ–‡ä»¶å¤¹çˆ¶ç›®å½•ä¸å­˜åœ¨åˆ™åŒæ—¶å»ºç«‹çˆ¶ç›®å½•çš„æ–‡ä»¶å¤¹ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -mkdir -p /user/hadoop-user/</span><br></pre></td></tr></table></figure></div><h3 id="æœ¬åœ°å‡†å¤‡ä¸€ä»½æ–‡ä»¶"><a href="#æœ¬åœ°å‡†å¤‡ä¸€ä»½æ–‡ä»¶" class="headerlink" title="æœ¬åœ°å‡†å¤‡ä¸€ä»½æ–‡ä»¶"></a>æœ¬åœ°å‡†å¤‡ä¸€ä»½æ–‡ä»¶</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp/</span><br><span class="line">mkdir charles1</span><br><span class="line">mkdir charles2   # ä¸ºåç»­æ“ä½œåšå‡†å¤‡</span><br><span class="line">cd charles1</span><br><span class="line">vim ds2019.txt</span><br></pre></td></tr></table></figure></div><p>å†™å…¥ï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Distributed System 2019Spring</span><br></pre></td></tr></table></figure></div><p>ç„¶åæŒ‰ä¸‹<code>esc</code>ï¼Œè¾“å…¥<code>:wq</code>å†™å…¥æ–‡ä»¶ã€‚</p><h3 id="å‘HDFSä¸Šä¼ æ–‡ä»¶"><a href="#å‘HDFSä¸Šä¼ æ–‡ä»¶" class="headerlink" title="å‘HDFSä¸Šä¼ æ–‡ä»¶"></a>å‘HDFSä¸Šä¼ æ–‡ä»¶</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -put /tmp/charles1/ds2019.txt /user/hadoop-user/</span><br></pre></td></tr></table></figure></div><h3 id="æŸ¥çœ‹æ˜¯å¦ä¸Šä¼ æˆåŠŸ"><a href="#æŸ¥çœ‹æ˜¯å¦ä¸Šä¼ æˆåŠŸ" class="headerlink" title="æŸ¥çœ‹æ˜¯å¦ä¸Šä¼ æˆåŠŸ"></a>æŸ¥çœ‹æ˜¯å¦ä¸Šä¼ æˆåŠŸ</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -ls -R /</span><br></pre></td></tr></table></figure></div><h3 id="åœ¨Terminalæ˜¾ç¤ºæ–‡ä»¶å†…å®¹"><a href="#åœ¨Terminalæ˜¾ç¤ºæ–‡ä»¶å†…å®¹" class="headerlink" title="åœ¨Terminalæ˜¾ç¤ºæ–‡ä»¶å†…å®¹"></a>åœ¨Terminalæ˜¾ç¤ºæ–‡ä»¶å†…å®¹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -cat /user/hadoop-user/ds2019.txt</span><br></pre></td></tr></table></figure></div><h3 id="ä¸‹è½½HDFSä¸Šçš„æ–‡ä»¶"><a href="#ä¸‹è½½HDFSä¸Šçš„æ–‡ä»¶" class="headerlink" title="ä¸‹è½½HDFSä¸Šçš„æ–‡ä»¶"></a>ä¸‹è½½HDFSä¸Šçš„æ–‡ä»¶</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -get /user/hadoop-user/ds2019.txt /tmp/charles2</span><br></pre></td></tr></table></figure></div><h3 id="åˆ é™¤HDFSä¸Šçš„æ–‡ä»¶"><a href="#åˆ é™¤HDFSä¸Šçš„æ–‡ä»¶" class="headerlink" title="åˆ é™¤HDFSä¸Šçš„æ–‡ä»¶"></a>åˆ é™¤HDFSä¸Šçš„æ–‡ä»¶</h3><h4 id="æ–¹å¼1-åˆ é™¤æŸä¸ªæ–‡ä»¶"><a href="#æ–¹å¼1-åˆ é™¤æŸä¸ªæ–‡ä»¶" class="headerlink" title="æ–¹å¼1 åˆ é™¤æŸä¸ªæ–‡ä»¶"></a>æ–¹å¼1 åˆ é™¤æŸä¸ªæ–‡ä»¶</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -rm /user/hadoop-user/ds2019.txt</span><br></pre></td></tr></table></figure></div><h4 id="æ–¹å¼2-é€’å½’åˆ é™¤æ–‡ä»¶å¤¹"><a href="#æ–¹å¼2-é€’å½’åˆ é™¤æ–‡ä»¶å¤¹" class="headerlink" title="æ–¹å¼2 é€’å½’åˆ é™¤æ–‡ä»¶å¤¹"></a>æ–¹å¼2 é€’å½’åˆ é™¤æ–‡ä»¶å¤¹</h4><p>è‹¥è¢«åˆ é™¤çš„æ–‡ä»¶å¤¹ä¸‹è¿˜æœ‰æ–‡ä»¶ï¼Œåˆ™ä¸€åŒåˆ é™¤</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -rm -r /user/</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> Distributed System </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
            <tag> distributed system </tag>
            
            <tag> lab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†å¸ƒå¼lab1ï¼šUbuntu16.04ä¸ŠHadoopç¯å¢ƒå®‰è£…</title>
      <link href="/2019/03/29/Hadoop-installed-in-Ubuntu1604/"/>
      <url>/2019/03/29/Hadoop-installed-in-Ubuntu1604/</url>
      
        <content type="html"><![CDATA[<p>åˆ†å¸ƒå¼ç¬¬ä¸€æ¬¡å®éªŒï¼Œæ€ä¹ˆå‘è¿™ä¹ˆå¤šï¼ğŸ¤¯</p><a id="more"></a><h2 id="é¦–å…ˆ"><a href="#é¦–å…ˆ" class="headerlink" title="é¦–å…ˆ"></a>é¦–å…ˆ</h2><p>ä½ éœ€è¦å¼€3å°è™šæ‹Ÿæœºï¼Œä¸€å°ä½œä¸ºmasterä¸»èŠ‚ç‚¹ï¼Œä¸¤ä¸ªä½œä¸ºslaveä»èŠ‚ç‚¹ï¼Œåˆ†åˆ«å«åšslave1å’Œslave2ã€‚</p><h2 id="VMwareè™šæ‹Ÿæœºæ¡¥æ¥æ¨¡å¼è®¾ç½®"><a href="#VMwareè™šæ‹Ÿæœºæ¡¥æ¥æ¨¡å¼è®¾ç½®" class="headerlink" title="VMwareè™šæ‹Ÿæœºæ¡¥æ¥æ¨¡å¼è®¾ç½®"></a>VMwareè™šæ‹Ÿæœºæ¡¥æ¥æ¨¡å¼è®¾ç½®</h2><p>å‚è€ƒè¿™ä¸ª<a href="https://blog.csdn.net/ccyhummer/article/details/80714430" target="_blank" rel="noopener">æ–‡ç« </a>ï¼Œï¼ˆæ²¡ç”¨è¿‡VMware23333ï¼‰</p><h2 id="Parallelsè™šæ‹Ÿæœºæ¡¥æ¥æ¨¡å¼è®¾ç½®"><a href="#Parallelsè™šæ‹Ÿæœºæ¡¥æ¥æ¨¡å¼è®¾ç½®" class="headerlink" title="Parallelsè™šæ‹Ÿæœºæ¡¥æ¥æ¨¡å¼è®¾ç½®"></a>Parallelsè™šæ‹Ÿæœºæ¡¥æ¥æ¨¡å¼è®¾ç½®</h2><p>å‚è€ƒè¿™ä¸ª<a href="https://blog.csdn.net/wuxiangmujingli/article/details/52671448" target="_blank" rel="noopener">æ–‡ç« </a>ï¼ŒIPçš„èµ·å§‹åœ°å€è®¾ä¸º192.168.1.11ï¼Œç»“æŸåœ°å€è®¾ä¸º192.168.1.31</p><h2 id="hostnameçš„é…ç½®æ“ä½œ"><a href="#hostnameçš„é…ç½®æ“ä½œ" class="headerlink" title="hostnameçš„é…ç½®æ“ä½œ"></a>hostnameçš„é…ç½®æ“ä½œ</h2><ol><li><p>ä¿®æ”¹hostsæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼ˆmasterèŠ‚ç‚¹ã€slave1èŠ‚ç‚¹ã€slave2èŠ‚ç‚¹éƒ½åšï¼‰ï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo su root # è‹¥å½“å‰ä¸æ˜¯rootå°±è¿›å…¥rootè´¦æˆ·</span><br><span class="line">gedit /etc/hosts</span><br></pre></td></tr></table></figure></div><p>ä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.11master</span><br><span class="line">192.168.1.12slave1</span><br><span class="line">192.168.1.13slave2</span><br></pre></td></tr></table></figure></div></li><li><p>ä¿®æ”¹hostname</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> masterèŠ‚ç‚¹ä¸Šä¿®æ”¹ä¸ºmasterï¼Œsalve1èŠ‚ç‚¹å’Œslave2èŠ‚ç‚¹ä¸Šåˆ†åˆ«ä¿®æ”¹ä¸ºslave1ã€slave2</span><br><span class="line">hostname master/slave1/slave2</span><br></pre></td></tr></table></figure></div><p>è¿™æ ·ä¸èƒ½å½»åº•ä¿®æ”¹hostnameï¼ˆä¸»æœºåï¼‰ï¼Œé‡å¯åè¿˜ä¼šè¿˜åŸåˆ°é»˜è®¤çš„Ubuntuï¼Œè¦å½»åº•ä¿®æ”¹è¦ä¿®æ”¹/etc/hostnameï¼Œnamenodeå’Œdatanodeå„è‡ªä¿®æ”¹ä¸ºè‡ªå·±çš„hostname</p><p>ç›´æ¥ç”¨ç¼–è¾‘å™¨æ‰“å¼€<strong>/etc/hostname</strong>è¿™ä¸ªæ–‡ä»¶<strong>ï¼ŒæŠŠåŸæ¥çš„åç§°</strong>åˆ æ‰<strong>ï¼Œ</strong>ä¸è¦ç”¨#æ³¨é‡Šï¼Œç›´æ¥åˆ æ‰ï¼Œå› ä¸º#æ²¡ç”¨ï¼Œ<strong>ä¿®æ”¹å†…å®¹</strong>ï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> masterèŠ‚ç‚¹ä¸Šä¿®æ”¹ä¸ºmasterï¼Œsalve1èŠ‚ç‚¹å’Œslave2èŠ‚ç‚¹ä¸Šåˆ†åˆ«ä¿®æ”¹ä¸ºslave1ã€slave2</span><br><span class="line">master/slave1/slave2</span><br></pre></td></tr></table></figure></div><p>é€€å‡ºshellå®¢æˆ·ç«¯ï¼Œé‡æ–°è¿›å…¥ï¼Œå¹¶ä¸”æ¢æˆrootæ“ä½œ(è¿™æ˜¯æ•™ç¨‹ä¸Šçš„ä¸€æ­¥ï¼Œæ²¡çœ‹æ‡‚è¿™æ˜¯ä»€ä¹ˆæ“ä½œ)</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br><span class="line">sudo su root</span><br></pre></td></tr></table></figure></div></li><li><p>è¿™äº›å·¥ä½œéƒ½åšå¥½äº†ï¼Œäº’ç›¸pingä¸€ä¸‹çœ‹çœ‹èƒ½ä¸èƒ½pingé€šï¼Œping èŠ‚ç‚¹åç§°</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping master/slave1/slave2</span><br></pre></td></tr></table></figure></div></li></ol><h2 id="å®‰è£…jdk-æ‰€æœ‰èŠ‚ç‚¹éƒ½åš"><a href="#å®‰è£…jdk-æ‰€æœ‰èŠ‚ç‚¹éƒ½åš" class="headerlink" title="å®‰è£…jdk(æ‰€æœ‰èŠ‚ç‚¹éƒ½åš)"></a>å®‰è£…jdk(æ‰€æœ‰èŠ‚ç‚¹éƒ½åš)</h2><ol><li><p>å‰å¾€<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="noopener">oracle Javaå®˜ç½‘</a>ä¸‹è½½JDK</p></li><li><p>ç¡®ä¿å½“å‰æ˜¯ç³»ç»Ÿè´¦æˆ·</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su root</span><br></pre></td></tr></table></figure></div></li><li><p>è§£å‹ç¼©åˆ°æŒ‡å®šç›®å½•ï¼ˆä»¥jdk-8u201-linux-x64.tar.gzä¸ºä¾‹ï¼‰</p><p>åˆ›å»ºç›®å½•:</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/lib/jvm</span><br></pre></td></tr></table></figure></div><p>è§£å‹ç¼©åˆ°è¯¥ç›®å½•:</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-8u201-linux-x64.tar.gz -C /usr/lib/jvm</span><br></pre></td></tr></table></figure></div></li><li><p>ä¿®æ”¹ç¯å¢ƒå˜é‡ï¼Œå¦‚æœæç¤ºæ²¡æœ‰è£…vimå°±ä½¿ç”¨<code>apt install vim</code>è£…ä¸€ä¸ª:ã€€ã€€</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure></div><p>åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸‹é¢å†…å®¹ï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>set oracle jdk environment</span><br><span class="line">export JAVA_HOME=/usr/lib/jvm/jdk1.8.0_201  # è¿™é‡Œè¦æ³¨æ„ç›®å½•è¦æ¢æˆè‡ªå·±è§£å‹çš„jdk ç›®å½•</span><br><span class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre  </span><br><span class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib  </span><br><span class="line">export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH</span><br></pre></td></tr></table></figure></div></li><li><p>ä½¿ç¯å¢ƒå˜é‡é©¬ä¸Šç”Ÿæ•ˆï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure></div></li><li><p>ç³»ç»Ÿæ³¨å†Œæ­¤jdk</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-alternatives --install /usr/bin/java java /usr/lib/jvm/jdk1.8.0_201/bin/java 300</span><br></pre></td></tr></table></figure></div></li><li><p>æŸ¥çœ‹javaç‰ˆæœ¬ï¼Œçœ‹çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure></div></li></ol><h2 id="SSHæ— å¯†ç éªŒè¯é…ç½®"><a href="#SSHæ— å¯†ç éªŒè¯é…ç½®" class="headerlink" title="SSHæ— å¯†ç éªŒè¯é…ç½®"></a>SSHæ— å¯†ç éªŒè¯é…ç½®</h2><h3 id="åœ¨masterèŠ‚ç‚¹ä¸Šï¼š"><a href="#åœ¨masterèŠ‚ç‚¹ä¸Šï¼š" class="headerlink" title="åœ¨masterèŠ‚ç‚¹ä¸Šï¼š"></a>åœ¨masterèŠ‚ç‚¹ä¸Šï¼š</h3><ol><li><p>å…ˆå®‰è£…ssh</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ssh</span><br></pre></td></tr></table></figure></div></li><li><p>å…ˆåˆ›å»ºæœ¬åœ°å…¬é’¥ï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/.ssh</span><br><span class="line">cd ~/.ssh               </span><br><span class="line">rm ./id_rsa*            # åˆ é™¤ä¹‹å‰ç”Ÿæˆçš„å…¬åŒ™ï¼ˆå¦‚æœæœ‰ï¼‰</span><br><span class="line">ssh-keygen -t rsa       # ä¸€ç›´æŒ‰å›è½¦å°±å¯ä»¥</span><br></pre></td></tr></table></figure></div></li><li><p>è®© Master èŠ‚ç‚¹éœ€èƒ½æ— å¯†ç  SSH æœ¬æœºï¼Œåœ¨ Master èŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ./id_rsa.pub &gt;&gt; ./authorized_keys</span><br></pre></td></tr></table></figure></div></li><li><p>å®Œæˆåå¯æ‰§è¡Œ <code>ssh Master</code> éªŒè¯ä¸€ä¸‹ï¼ˆå¯èƒ½éœ€è¦è¾“å…¥ yesï¼ŒæˆåŠŸåæ‰§è¡Œ <code>exit</code> è¿”å›åŸæ¥çš„ç»ˆç«¯ï¼‰ã€‚æ¥ç€åœ¨ master èŠ‚ç‚¹å°†ä¸Šå…¬åŒ™ä¼ è¾“åˆ° slave1 èŠ‚ç‚¹å’Œslave2èŠ‚ç‚¹ï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp ./id_rsa.pub parallels@slave1:/home/parallels/  # å‘slave1èŠ‚ç‚¹ä¼ </span><br><span class="line">scp ./id_rsa.pub parallels@slave2:/home/parallels/  # å‘slave2èŠ‚ç‚¹ä¼ </span><br></pre></td></tr></table></figure></div></li></ol><h3 id="åœ¨slave1èŠ‚ç‚¹ä¸Šï¼ˆslave2åŒç†ï¼‰ï¼š"><a href="#åœ¨slave1èŠ‚ç‚¹ä¸Šï¼ˆslave2åŒç†ï¼‰ï¼š" class="headerlink" title="åœ¨slave1èŠ‚ç‚¹ä¸Šï¼ˆslave2åŒç†ï¼‰ï¼š"></a>åœ¨slave1èŠ‚ç‚¹ä¸Šï¼ˆslave2åŒç†ï¼‰ï¼š</h3><ol><li><p>å°† ssh å…¬åŒ™åŠ å…¥æˆæƒï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /root/.ssh       # å¦‚æœä¸å­˜åœ¨è¯¥æ–‡ä»¶å¤¹éœ€å…ˆåˆ›å»ºï¼Œè‹¥å·²å­˜åœ¨åˆ™å¿½ç•¥</span><br><span class="line">cat /home/parallels/id_rsa.pub &gt;&gt; /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></div></li></ol><h3 id="åœ¨masterèŠ‚ç‚¹ä¸Šæµ‹è¯•ï¼š"><a href="#åœ¨masterèŠ‚ç‚¹ä¸Šæµ‹è¯•ï¼š" class="headerlink" title="åœ¨masterèŠ‚ç‚¹ä¸Šæµ‹è¯•ï¼š"></a>åœ¨masterèŠ‚ç‚¹ä¸Šæµ‹è¯•ï¼š</h3><p>æ‰§è¡Œ<code>ssh slave1</code>ï¼Œä¼šæœ‰è¿™æ ·çš„ç»“æœï¼š</p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_1.png"><p>é‚£ä¹ˆè¯´æ˜æˆåŠŸäº†ï¼Œå†æ‰§è¡Œ<code>ssh slave2</code>çœ‹çœ‹ã€‚</p><h2 id="å…³é—­é˜²ç«å¢™"><a href="#å…³é—­é˜²ç«å¢™" class="headerlink" title="å…³é—­é˜²ç«å¢™"></a>å…³é—­é˜²ç«å¢™</h2><p><strong>æ‰€æœ‰èŠ‚ç‚¹ä¸Š</strong>ï¼Œæ‰§è¡Œ<code>ufw disable</code>å°±å¥½ã€‚</p><h2 id="å®‰è£…Hadoop"><a href="#å®‰è£…Hadoop" class="headerlink" title="å®‰è£…Hadoop"></a>å®‰è£…Hadoop</h2><h3 id="åœ¨masterèŠ‚ç‚¹ä¸Šï¼š-1"><a href="#åœ¨masterèŠ‚ç‚¹ä¸Šï¼š-1" class="headerlink" title="åœ¨masterèŠ‚ç‚¹ä¸Šï¼š"></a>åœ¨masterèŠ‚ç‚¹ä¸Šï¼š</h3><p>[æ³¨]å…¨ç¨‹åœ¨rootè´¦æˆ·ä¸‹è¿è¡Œ</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su root # è‹¥å½“å‰ä¸æ˜¯rootå°±è¿›å…¥rootè´¦æˆ·</span><br></pre></td></tr></table></figure></div><ol><li><p>åˆ°Hadoop<a href="https://hadoop.apache.org/releases.html" target="_blank" rel="noopener">å®˜ç½‘</a>ä¸‹è½½binaryçš„hadoopï¼Œæˆ‘ä¸‹è½½çš„æ˜¯<strong>hadoop-2.8.5.tar.gz</strong>æ–‡ä»¶</p></li><li><p>åœ¨/usr/localç›®å½•ä¸‹å»ºç«‹hadoopç›®å½•</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/local/hadoop</span><br></pre></td></tr></table></figure></div></li><li><p>æŠŠ<strong>hadoop-2.8.5.tar.gz</strong>æ‹·è´åˆ°/usr/local/<strong>hadoop</strong>ç›®å½•ä¸‹ï¼Œç„¶åè§£å‹ï¼Œè¿™é‡Œçš„<code>&lt;path&gt;</code>å†™è‡ªå·±çš„ä¸‹è½½ä½ç½®</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp &lt;path&gt;/hadoop-2.8.5.tar.gz /usr/local/hadoop</span><br><span class="line">cd /usr/local/hadoop</span><br><span class="line">tar â€“zxvf hadoop-2.8.5.tar.gz</span><br><span class="line">cd hadoop-2.8.5</span><br></pre></td></tr></table></figure></div></li><li><p>åœ¨/usr/local/<strong>hadoop</strong>ç›®å½•ä¸‹æ–°å»ºtmpæ–‡ä»¶å¤¹å’Œhdfsæ–‡ä»¶å¤¹</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop</span><br><span class="line">mkdir tmp</span><br><span class="line">mkdir hdfs</span><br></pre></td></tr></table></figure></div></li><li><p>ç¼–è¾‘ï¼ˆå¯ç”¨<code>vim hadoop-env.sh</code>ä¹Ÿå¯åŒå‡»æ‰“å¼€ç¼–è¾‘ï¼‰hadoop-2.8.5/etc/hadoop/<strong>hadoop-env.sh</strong>æ–‡ä»¶ï¼ŒæŠŠJAVA_HOMEè®¾ç½®æˆJavaå®‰è£…æ ¹è·¯å¾„ï¼Œå¦‚ä¸‹ï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop/hadoop-2.8.5/etc/hadoop</span><br><span class="line">export JAVA_HOME=/usr/lib/jvm/jdk1.8.0_201</span><br></pre></td></tr></table></figure></div></li><li><p>æ–°å»º<strong>slaves</strong>æ–‡ä»¶</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi slaves</span><br></pre></td></tr></table></figure></div><p>æ·»åŠ è¿™ä¸¤æ¡</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure></div></li><li><p>ç¼–è¾‘<strong>master</strong>æ–‡ä»¶ï¼Œå…¨æ–‡æ”¹ä¸º<code>master</code></p></li><li><p>ä¿®æ”¹hadoop-2.8.5/etc/hadoop/<strong>core-site.xml</strong>æ–‡ä»¶(æˆ‘åœ¨æ–‡ä»¶ç³»ç»Ÿé‡Œä½¿ç”¨çš„sublimeä¿®æ”¹çš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åŒå‡»ä½¿ç”¨geditæ‰“å¼€)</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>file:/usr/local/hadoop/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>Abase for other temporary directories.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>ä¿®æ”¹hadoop-2.8.5/etc/hadoop/<strong>hdfs-site.xml</strong>æ–‡ä»¶</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>master:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>file:/usr/local/hadoop/hdfs/name<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>file:/usr/local/hadoop/hdfs/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>ä¿®æ”¹hadoop-2.8.5/etc/hadoop/<strong>mapred-site.xml</strong>æ–‡ä»¶(å¯èƒ½éœ€è¦å…ˆé‡å‘½åï¼Œé»˜è®¤æ–‡ä»¶åä¸º mapred-site.xml.template)</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>master:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>master:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>ä¿®æ”¹hadoop-2.8.5/etc/hadoop/<strong>yarn-site.xml</strong>æ–‡ä»¶</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>master<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li><li><p>å°†é…ç½®å¥½çš„æ–‡ä»¶å¤åˆ¶åˆ°<strong>å„ä¸ªslave</strong>èŠ‚ç‚¹ä¸Šï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line">sudo rm -r ./hadoop/tmp     # åˆ é™¤ Hadoop ä¸´æ—¶æ–‡ä»¶</span><br><span class="line">tar -zcf ~/hadoop.master.tar.gz ./hadoop   # å…ˆå‹ç¼©å†å¤åˆ¶</span><br><span class="line">cd ~</span><br><span class="line">scp ./hadoop.master.tar.gz slave1:/home/parallels</span><br><span class="line">scp ./hadoop.master.tar.gz slave2:/home/parallels</span><br></pre></td></tr></table></figure></div></li></ol><h3 id="åœ¨slave1èŠ‚ç‚¹ä¸Šï¼š"><a href="#åœ¨slave1èŠ‚ç‚¹ä¸Šï¼š" class="headerlink" title="åœ¨slave1èŠ‚ç‚¹ä¸Šï¼š"></a>åœ¨slave1èŠ‚ç‚¹ä¸Šï¼š</h3><ol><li><p>è§£å‹æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹<strong>owner</strong></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo su root # è‹¥å½“å‰ä¸æ˜¯rootå°±è¿›å…¥rootè´¦æˆ·</span><br><span class="line">rm -r /usr/local/hadoop    # åˆ æ‰æ—§çš„ï¼ˆå¦‚æœå­˜åœ¨ï¼‰</span><br><span class="line">tar -zxf /home/parallels/hadoop.master.tar.gz -C /usr/local</span><br></pre></td></tr></table></figure></div></li></ol><h3 id="å›åˆ°masterèŠ‚ç‚¹"><a href="#å›åˆ°masterèŠ‚ç‚¹" class="headerlink" title="å›åˆ°masterèŠ‚ç‚¹"></a>å›åˆ°masterèŠ‚ç‚¹</h3><ol><li><p>å°†binç›®å½•å’Œsbinç›®å½•é‡Œçš„å‘½ä»¤é…å…¥ç¯å¢ƒå˜é‡</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure></div><p>æŒ‰ä¸‹<code>i</code>ï¼Œåœ¨æœ€åæ·»åŠ ä¸€è¡Œï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:/usr/local/hadoop/hadoop-2.8.5/sbin:/usr/local/hadoop/hadoop-2.8.5/bin</span><br></pre></td></tr></table></figure></div><p>ç„¶åæŒ‰ä¸‹<code>esc</code>ï¼Œè¾“å…¥<code>:wq</code>å†™å…¥æ–‡ä»¶ã€‚</p></li><li><p>åœ¨ Master èŠ‚ç‚¹æ‰§è¡Œ NameNode çš„æ ¼å¼åŒ–</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop namenode -format</span><br></pre></td></tr></table></figure></div></li><li><p>æ¥ç€å¯ä»¥å¯åŠ¨ hadoop äº†ï¼Œå¯åŠ¨éœ€è¦åœ¨ <strong>Master</strong> èŠ‚ç‚¹çš„<strong>sbin</strong>æ–‡ä»¶å¤¹ä¸­è¿›è¡Œï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">start-all.sh</span><br><span class="line">mr-jobhistory-daemon.sh start historyserver</span><br></pre></td></tr></table></figure></div><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_5.png"><p>é€šè¿‡å‘½ä»¤ <code>jps</code> å¯ä»¥æŸ¥çœ‹å„ä¸ªèŠ‚ç‚¹æ‰€å¯åŠ¨çš„è¿›ç¨‹ã€‚æ­£ç¡®çš„è¯ï¼Œåœ¨ Master èŠ‚ç‚¹ä¸Šå¯ä»¥çœ‹åˆ° NameNodeã€ResourceManagerã€SecondrryNameNodeã€JobHistoryServer è¿›ç¨‹ã€‚</p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_2.png"></li><li><p>åˆ†åˆ«è¿›å…¥slave1èŠ‚ç‚¹å’Œslave2èŠ‚ç‚¹ï¼Œä½¿ç”¨<code>jps</code>å‘½ä»¤æŸ¥çœ‹è¿è¡Œæƒ…å†µ</p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_6.png"><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_8.png"></li><li><p>åœ¨namenodeä¸ŠæŸ¥çœ‹é›†ç¾¤çŠ¶æ€</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop dfsadmin -report</span><br></pre></td></tr></table></figure></div><p>æ­¤æ—¶å¯ä»¥é€šè¿‡åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€<a href="http://master:50070" target="_blank" rel="noopener">http://master:50070</a>æŸ¥çœ‹ã€‚</p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/3_3.png"></li></ol><h2 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h2><p>å¦‚å„ä½åŒå­¦å‘ç°é—®é¢˜æ¬¢è¿è¯„è®ºæŒ‡æ­£ï¼Œè¯„è®ºåŠŸèƒ½ç»ˆäºæ‰“å¼€äº†233333ï¼</p><h2 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h2><p>æ„Ÿè°¢è‹ç’å²©ã€<a href="wanghj.net">wanghj</a>ã€æ±ªå®‡åŒå­¦ä¸ºæœ¬æ–‡æŒ‡æ­£é”™è¯¯ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Distributed System </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
            <tag> distributed system </tag>
            
            <tag> lab </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ æ•°é—®é¢˜çš„è´ªå¿ƒé€‰æ‹©ç­–ç•¥è¯æ˜</title>
      <link href="/2019/03/28/%E5%88%A0%E6%95%B0%E9%97%AE%E9%A2%98%E7%9A%84%E8%B4%AA%E5%BF%83%E9%80%89%E6%8B%A9%E7%AD%96%E7%95%A5%E8%AF%81%E6%98%8E/"/>
      <url>/2019/03/28/%E5%88%A0%E6%95%B0%E9%97%AE%E9%A2%98%E7%9A%84%E8%B4%AA%E5%BF%83%E9%80%89%E6%8B%A9%E7%AD%96%E7%95%A5%E8%AF%81%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<blockquote><p><strong>é¢˜ç›®ï¼šåœ¨ä¸€ä¸ªnä½çš„æ­£æ•´æ•°A[1â€¦n]ä¸­åˆ é™¤å…¶ä¸­ä»»æ„k(kâ‰¤n)ä¸ªæ•°å­—åï¼Œå‰©ä¸‹çš„æ•°å­—æŒ‰åŸæ¬¡åºç»„æˆä¸€ä¸ªæ–°çš„æ­£æ•´æ•°ã€‚å¯¹äºç»™å®šçš„nä½æ­£æ•´æ•°Aå’Œkï¼Œè®¾è®¡ä¸€ä¸ªè´ªå¿ƒç®—æ³•ï¼Œä½¿å¾—å‰©ä¸‹çš„æ•°å­—ç»„æˆçš„æ–°æ•°æœ€å°ã€‚</strong><br><strong>å¦‚ï¼šA=278693ï¼Œk=4æ—¶æœ€å°æ–°æ•°ä¸º23ï¼Œk=3æ—¶ä¸º263</strong></p></blockquote><a id="more"></a><p>åˆšåˆšè¯æ˜å‡ºæ¥è´ªå¿ƒé€‰æ‹©æ€§è´¨ï¼Œå…ˆå†™ä¸‹ï¼Œä¹‹åå†æ…¢æ…¢è¡¥å……å…¨éƒ¨æ€è·¯ã€‚</p><h2 id="è´ªå¿ƒé€‰æ‹©ç­–ç•¥"><a href="#è´ªå¿ƒé€‰æ‹©ç­–ç•¥" class="headerlink" title="è´ªå¿ƒé€‰æ‹©ç­–ç•¥"></a><strong>è´ªå¿ƒé€‰æ‹©ç­–ç•¥</strong></h2><p>ä»é«˜ä½å‘ä½ä½è¿›è¡Œæœç´¢ï¼š</p><ol><li>å¦‚æœA[1â€¦n]æ˜¯ä¸€æ¡é€’å¢åºåˆ—ï¼Œé‚£ä¹ˆå°±åˆ é™¤æœ€åä¸€ä¸ªæ•°ï¼›</li><li>å¦‚æœA[1â€¦n]å«æœ‰ä¸¥æ ¼é€’å‡å­åºåˆ—ï¼Œé‚£ä¹ˆå°±åˆ é™¤ç¬¬ä¸€ä¸ªä¸¥æ ¼é€’å‡å­åºåˆ—çš„é¦–å­—ç¬¦ã€‚</li></ol><h2 id="è´ªå¿ƒé€‰æ‹©æ€§è´¨è¯æ˜"><a href="#è´ªå¿ƒé€‰æ‹©æ€§è´¨è¯æ˜" class="headerlink" title="è´ªå¿ƒé€‰æ‹©æ€§è´¨è¯æ˜"></a>è´ªå¿ƒé€‰æ‹©æ€§è´¨è¯æ˜</h2><p>å‡è®¾Aä¸­æœ‰nä¸ªå…ƒç´ ï¼Œå°†Aä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œç¼–å·ä¸º$a_x(1\leq x\leq n)â€‹$ï¼š<br>$$<br>A=[a_1,a_2,â€¦,a_{n-1},a_n]<br>$$</p><ol><li>å¦‚æœA[1â€¦n]æ˜¯ä¸€æ¡é€’å¢åºåˆ—ï¼Œé‚£ä¹ˆå°±åˆ é™¤æœ€åä¸€ä¸ªæ•°ï¼›</li></ol><p>è®°åŸæœ¬Aæ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_Aâ€‹$ï¼Œåˆ™æœ‰ï¼š<br>$$<br>T_A=a_1 \times 10^{n-1}+a_2\times10^{n-2}+â€¦+a_{n-1}\times10+a_n<br>$$</p><p>è®°åˆ é™¤æœ€åä¸€ä¸ªæ•°åï¼ŒAå˜ä¸ºAâ€™ï¼ŒAâ€™æ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_{Aâ€™}$ï¼Œåˆ™æœ‰ï¼š</p><p>$$<br>T_{Aâ€™}=a_1\times10^{n-2}+a_2 \times 10^{n-3}+â€¦+a_{n-2} \times 10+a_{n-1}<br>$$</p><p>å¦‚æœä¸åˆ é™¤æœ€åä¸€ä¸ªæ•°ï¼Œè€Œæ˜¯åˆ é™¤å¦ä¸€ä¸ªæ•°$a_q(1\leq q&lt; n)$ï¼Œæ­¤æ—¶Aå˜ä¸ºAâ€™â€™ï¼ŒAâ€™â€™æ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_{Aâ€™â€™}$ï¼Œåˆ™æœ‰ï¼š </p><p>$$<br>T_{Aâ€™â€™}=a_1 \times 10^{n-2}+a_2 \times 10^{n-3}+â€¦+a_{q-1} \times 10^{n-q}+a_{q+1} \times 10^{n-q-1}+â€¦+a_{n-1} \times 10+a_n<br>$$</p><p>ç”¨ä½œå·®æ³•æ¥æ¯”è¾ƒ$T_{Aâ€™}$å’Œ$T_{Aâ€™â€™}$çš„å¤§å°ï¼š</p><p>$$<br>T_{Aâ€™}-T_{Aâ€™â€™}=(a_q-a_{q+1}) \times 10^{n-q-1}+(a_{q+1}-a_{q+2}) \times 10^{n-q-2}+â€¦+(a_{n-2}-a_{n-1}) \times 10+(a_{n-1}-a_{n})<br>$$</p><p>ç”±äºAæ˜¯ä¸€æ¡é€’å¢åºåˆ—ï¼Œæ‰€ä»¥æœ‰ï¼š</p><p>$$<br>a_{q}\leq a_{q+1},a_{q+1}\leq a_{q+2},â€¦,a_{n-2}\leq a_{n-1},a_{n-1}\leq a_{n}<br>$$</p><p>å³ï¼š</p><p>$$<br>a_{q}-a_{q+1}\leq 0,a_{q+1}-a_{q+2}\leq 0,â€¦,a_{n-2}-a_{n-1}\leq 0,a_{n-1}-a_{n}\leq 0<br>$$</p><p>æ‰€ä»¥æœ‰$T_{Aâ€™}-T_{Aâ€™â€™}\leq 0$ï¼Œé‚£ä¹ˆ$T_{Aâ€™}$æ˜¯Aåˆ å®Œä¸€ä¸ªæ•°åï¼Œæ‰€ç»„æˆçš„æœ€å°æ•°å€¼ã€‚è´ªå¿ƒé€‰æ‹©æ˜¯å®‰å…¨çš„ã€‚</p><ol start="2"><li>å¦‚æœA[1â€¦n]å«æœ‰ä¸¥æ ¼é€’å‡å­åºåˆ—ï¼Œé‚£ä¹ˆå°±åˆ é™¤ç¬¬ä¸€ä¸ªä¸¥æ ¼é€’å‡å­åºåˆ—çš„é¦–å­—ç¬¦ã€‚</li></ol><p>(1) å…ˆè€ƒè™‘ä¸€ç§æƒ…å†µï¼ŒAä¸­åªæœ‰ä¸¤æ®µå•è°ƒå­åŒºé—´ï¼Œä¸”é«˜ä½éƒ¨åˆ†æ˜¯é€’å¢å­åŒºé—´ï¼Œä½ä½éƒ¨åˆ†æ˜¯é€’å‡å­åŒºé—´ã€‚é‚£ä¹ˆAä¸­çš„æ•°å°±æ˜¯å…ˆä¸Šå‡å†ä¸‹é™ï¼Œåƒä¸€åº§å±±ä¸€æ ·ã€‚å¦‚æœåˆ é™¤ç¬¬ä¸€ä¸ªé€’å‡å­åºåˆ—çš„é¦–å­—ç¬¦æ˜¯å®‰å…¨çš„ï¼Œä¹Ÿå°±æ˜¯åˆ é™¤å±±é¡¶çš„æ•°æ˜¯å®‰å…¨çš„ã€‚</p><p>å‡è®¾åœ¨Aä¸­ï¼Œæœ‰3ä¸ªè¿åœ¨ä¸€èµ·çš„æ•°$a_i,a_j,a_k(1\leq i&lt; j&lt; k\leq n)$ï¼Œå…¶ä¸­$(a_1,a_j)$æ˜¯é€’å¢åºåˆ—ï¼Œ$(a_j,a_n)$æ˜¯é€’å‡åºåˆ—ã€‚</p><p>è®°åŸæœ¬Aæ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_A$ï¼Œåˆ™æœ‰ï¼š</p><p>$$<br>T_A=a_1 \times 10^{n-1}+a_2 \times 10^{n-2}+â€¦+a_i \times 10^{n-i}+a_j \times 10^{n-j}+a_k \times 10^{n-k}+â€¦+a_{n-1} \times 10+a_n<br>$$</p><p>åˆ é™¤$a_j$åï¼ŒAå˜ä¸ºAâ€™ï¼ŒAâ€™æ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_{Aâ€™}$ï¼Œåˆ™æœ‰ï¼š</p><p>$$<br>T_{Aâ€™}=a_1 \times 10^{n-2}+a_2 \times 10^{n-3}+â€¦+a_i \times 10^{n-i-1}+a_k \times 10^{n-k}+â€¦+a_{n-1} \times 10+a_{n}<br>$$</p><p>å¦‚æœä¸åˆ é™¤$a_j$ï¼Œè€Œæ˜¯åˆ é™¤å¦ä¸€ä¸ªæ•°$a_q$ã€‚</p><p>a) å½“$1\leq q&lt; j$æ—¶ï¼Œæ­¤æ—¶Aå˜ä¸ºAâ€™â€™ï¼ŒAâ€™â€™æ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_{Aâ€™â€™}$ï¼Œåˆ™æœ‰ï¼š<br>$$<br>T_{Aâ€™â€™}=a_1 \times 10^{n-2}+a_2 \times 10^{n-3}+â€¦+a_{q-1} \times 10^{n-q}+a_{q+1} \times 10^{n-q-1}+â€¦+a_j \times 10^{n-j}+â€¦+a_{n-1} \times 10+a_{n}<br>$$</p><p>ç”¨ä½œå·®æ³•æ¥æ¯”è¾ƒ$T_{Aâ€™}$å’Œ$T_{Aâ€™â€™}$çš„å¤§å°ï¼š</p><p>$$<br>T_{Aâ€™}-T_{Aâ€™â€™}=(a_q-a_{q+1}) \times 10^{n-q-1}+(a_{q+1}-a_{q+2}) \times 10^{n-q-2}+â€¦+(a_{i}-a_{j}) \times 10^{n-j}<br>$$</p><p>ç”±äº$(a_1,a_j)$æ˜¯ä¸€æ¡é€’å¢åºåˆ—ï¼Œæ‰€ä»¥æœ‰ï¼š</p><p>$$<br>a_{q}\leq a_{q+1},a_{q+1}\leq a_{q+2},â€¦,a_{i}\leq a_{j}<br>$$</p><p>å³ï¼š</p><p>$$<br>a_{q}-a_{q+1}\leq 0,a_{q+1}-a_{q+2}\leq 0,â€¦,a_{i}-a_{j}\leq 0<br>$$</p><p>æ‰€ä»¥æœ‰$T_{Aâ€™}-T_{Aâ€™â€™}\leq 0$ï¼Œé‚£ä¹ˆ$T_{Aâ€™}$æ˜¯Aåˆ å®Œ$a_q(1\leq q &lt; j)$åï¼Œæ‰€ç»„æˆçš„æœ€å°æ•°å€¼ã€‚è´ªå¿ƒé€‰æ‹©æ˜¯å®‰å…¨çš„ã€‚</p><p>(b) å½“$j &lt; q\leq n$æ—¶ï¼Œæ­¤æ—¶Aå˜ä¸ºAâ€™â€™â€™ï¼ŒAâ€™â€™â€™æ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_{Aâ€™â€™â€™}$ï¼Œåˆ™æœ‰ï¼š </p><p>$$<br>T_{Aâ€™â€™â€™}=a_1 \times 10^{n-2}+a_2 \times 10^{n-3}+â€¦+a_j \times 10^{n-j-1}+â€¦+a_{q-1} \times 10^{n-q}+a_{q+1} \times 10^{n-q-1}â€¦+a_{n-1} \times 10+a_{n}<br>$$</p><p>ç”¨ä½œå·®æ³•æ¥æ¯”è¾ƒ$T_{Aâ€™}$å’Œ$T_{Aâ€™â€™â€™}$çš„å¤§å°ï¼š</p><p>$$<br>T_{Aâ€™}-T_{Aâ€™â€™}=(a_k-a_j) \times 10^{n-k}+â€¦+(a_{q-1}-a_{q-2}) \times 10^{n-q+1}+(a_{q}-a_{q-1}) \times 10^{n-q}<br>$$</p><p>ç”±äº$(a_j,a_{n})$æ˜¯ä¸€æ¡é€’å‡åºåˆ—ï¼Œæ‰€ä»¥æœ‰ï¼š</p><p>$$<br>a_{k}\leq a_{j},a_{q-1}\leq a_{q-2},â€¦,a_{q}\leq a_{q-1}<br>$$</p><p>å³ï¼š</p><p>$$<br>a_{k}-a_{j}\leq 0,a_{q-1}-a_{q-2}\leq 0,a_{q}-a_{q-1}\leq 0<br>$$</p><p>æ‰€ä»¥æœ‰$T_{Aâ€™}-T_{Aâ€™â€™â€™}\leq 0$ï¼Œé‚£ä¹ˆ$T_{Aâ€™}$æ˜¯Aåˆ å®Œ$a_q(j&lt; q \leq n)$åï¼Œæ‰€ç»„æˆçš„æœ€å°æ•°å€¼ã€‚è´ªå¿ƒé€‰æ‹©æ˜¯å®‰å…¨çš„ã€‚<br>ç»¼ä¸Š(a)(b)æ‰€è¿°ï¼Œè‹¥Aä¸­åªæœ‰ä¸¤æ®µå•è°ƒå­åŒºé—´ï¼Œä¸”é«˜ä½éƒ¨åˆ†æ˜¯é€’å¢å­åŒºé—´ï¼Œä½ä½éƒ¨åˆ†æ˜¯é€’å‡å­åŒºé—´ï¼Œé‚£ä¹ˆåˆ å»æ­¤é€’å‡å­åŒºé—´çš„é¦–å­—ç¬¦åï¼Œæ‰€ç»„æˆçš„æ•°æ˜¯æœ€å°æ•°å€¼ã€‚è´ªå¿ƒé€‰æ‹©æ˜¯å®‰å…¨çš„ã€‚</p><p>(2) ç°åœ¨å·²ç»è¯æ˜äº†å¦‚æœAä¸­åªæœ‰ä¸€ä¸ªå±±ï¼Œé‚£ä¹ˆåˆ é™¤å±±é¡¶å…ƒç´ æ˜¯æœ€åˆé€‚çš„ã€‚å¦‚æœAä¸­æœ‰å¤šä¸ªå±±å³°è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</p><p>æ¢å¥è¯è¯´ï¼Œå¦‚æœAä¸­ä¸æ­¢æœ‰2æ®µå•è°ƒå­åŒºé—´ï¼Œè€Œæ˜¯ç”±å¾ˆå¤šä¸åŒçš„å•è°ƒå­åŒºé—´æ‰€ç»„æˆï¼Œé‚£åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ</p><p>è¿™ä¸ªé—®é¢˜çœ‹ä¸Šå»æœ‰ç‚¹å¤æ‚äº†ï¼Œæˆ‘ç”»ä¸ªå›¾å§ï¼š</p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/2_1.jpg"><p>å…¶å®æŠŠå›¾ç”»å‡ºæ¥åï¼Œæˆ‘å°è¯•ç€åˆ é™¤ç¬¬ä¸€ä¸ªå±±çš„å±±é¡¶å…ƒç´ ï¼Œåˆ å®Œåå‘ç°ï¼Œç°åœ¨çš„$a_6=a_5$ï¼Œè€Œ$a_7=a_7$ï¼š</p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/2_2.jpg"><p>ä½†å¦‚æœåˆ é™¤ç¬¬ä¸€ä¸ªå±±ä¹‹åçš„ä»»æ„ä¸€ä¸ªå…ƒç´ çš„è¯ï¼Œåˆ å®Œåå‘ç°$a_6=a_5$ï¼Œè€Œç°åœ¨çš„$a_7=a_6$ã€‚</p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/2_3.jpg"><p>ç”±äº$a_6&gt;a_7â€‹$ï¼Œæ‰€ä»¥ä¸ç®¡åé¢åˆ å“ªä¸ªå…ƒç´ ï¼Œéƒ½ä¼šæ¯”åˆ é™¤$a_6â€‹$æ‰€å¾—åˆ°çš„æ•°è¦å¤§ã€‚</p><p>æ•°å­¦è¯æ˜å¦‚ä¸‹ï¼š</p><p>å‡è®¾åœ¨Aä¸­ï¼Œæœ‰3ä¸ªè¿åœ¨ä¸€èµ·çš„æ•°$a_i,a_j,a_k(1\leq i&lt; j&lt; k\leq n)â€‹$ï¼Œè¿˜æœ‰å¦ä¸€ä¸ªæ•°$a_r(k \leq r &lt; n)â€‹$ï¼Œï¼Œå…¶ä¸­$(a_1,a_j)â€‹$æ˜¯é€’å¢åºåˆ—ï¼Œ$(a_j,a_r)â€‹$æ˜¯é€’å‡åºåˆ—ã€‚</p><p>è®°åŸæœ¬Aæ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_A$ï¼Œåˆ™æœ‰ï¼š</p><p>$$<br>T_A=a_1 \times 10^{n-1}+a_2 \times 10^{n-2}+â€¦+a_i \times 10^{n-i}+a_j \times 10^{n-j}+a_k \times 10^{n-k}+â€¦+a_{n-1} \times 10+a_n<br>$$</p><p>åˆ é™¤$a_jâ€‹$åï¼ŒAå˜ä¸ºAâ€™ï¼ŒAâ€™æ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_{Aâ€™}â€‹$ï¼Œåˆ™æœ‰ï¼š</p><p>$$<br>T_{Aâ€™}=a_1 \times 10^{n-2}+a_2 \times 10^{n-3}+â€¦+a_i \times 10^{n-i-1}+a_k \times 10^{n-k}+â€¦<br>$$</p><p>å¦‚æœä¸åˆ é™¤$a_j$ï¼Œè€Œæ˜¯åˆ é™¤å¦ä¸€ä¸ªæ•°$a_q(r \leq q \leq n)$ã€‚æ­¤æ—¶Aå˜ä¸ºAâ€™â€™ï¼ŒAâ€™â€™æ‰€ä»£è¡¨çš„æ•°å€¼ä¸º$T_{Aâ€™â€™}$ï¼Œåˆ™æœ‰ï¼š </p><p>$$<br>T_{Aâ€™â€™}=a_1 \times 10^{n-2}+a_2 \times 10^{n-3}+â€¦+a_i \times 10^{n-i-1}+a_j \times 10^{n-j-1}+â€¦<br>$$</p><p>å‘ç°$T_{Aâ€™}$ä¸­çš„$10^{n-k}$çš„ç³»æ•°æ˜¯$a_k$ï¼Œè€Œ$T_{Aâ€™â€™}$ä¸­çš„$10^{n-k}$çš„ç³»æ•°æ˜¯$a_j$ï¼Œç”±äº$a_k&lt; a_j$ï¼Œé‚£ä¹ˆå¿…æœ‰$T_{Aâ€™}&lt; T_{Aâ€™â€™}$ï¼Œæ‰€ä»¥åˆ é™¤ç¬¬ä¸€ä¸ªå±±å³°çš„å³°å€¼æ˜¯å®‰å…¨çš„ã€‚ä¹Ÿå°±æ˜¯å¦‚æœA[1â€¦n]å«æœ‰ä¸¥æ ¼é€’å‡å­åºåˆ—ï¼Œé‚£ä¹ˆå°±åˆ é™¤ç¬¬ä¸€ä¸ªä¸¥æ ¼é€’å‡å­åºåˆ—çš„é¦–å­—ç¬¦ã€‚è´ªå¿ƒé€‰æ‹©æ˜¯å®‰å…¨çš„ã€‚</p><p>ç»¼ä¸Šï¼Œè´ªå¿ƒé€‰æ‹©æ€§è´¨æˆç«‹ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>round(number[, ndigits])</title>
      <link href="/2019/03/27/round(number%5B,%20ndigits%5D)/"/>
      <url>/2019/03/27/round(number%5B,%20ndigits%5D)/</url>
      
        <content type="html"><![CDATA[<p><strong>roundå‡½æ•°æ˜¯Pythonä¸­å¸¸ç”¨çš„å››èˆäº”å…¥çš„å‡½æ•°ï¼Œä½†æ˜¯ä»Šå¤©è¯•ç”¨äº†ä¸€ä¸‹å‘ç°æœ‰ç‚¹å°å‘</strong>ã€‚</p><a id="more"></a><p><strong>å¯¹0.5è¿›è¡Œå››èˆäº”å…¥ï¼Œç»“æœåº”è¯¥ä¸º1ï¼Œå¯æ˜¯Pythonè§£é‡Šå™¨ç»™çš„ç»“æœæ˜¯ï¼š</strong></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span>&gt;&gt; round(0.5)</span><br><span class="line">0</span><br></pre></td></tr></table></figure></div><p><strong>ç´§æ¥ç€æˆ‘åˆè¯•äº†å‡ ä¸ªæ•°ï¼Œå‘ç°ï¼š</strong></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span>&gt;&gt; round(1.5)</span><br><span class="line">2</span><br><span class="line"><span class="meta">&gt;</span>&gt;&gt; round(2.5)</span><br><span class="line">2</span><br></pre></td></tr></table></figure></div><p><strong>round(1.5)è¿˜ç®—æ­£å¸¸ï¼Œround(2.5)åˆå¾ˆå¥‡æ€ªäº†ï¼Œç„¶åçœ‹äº†çœ‹Pythonæ–‡æ¡£ï¼Œé‡Œé¢è¿™æ ·è§£é‡Šroundå‡½æ•°ï¼š</strong></p><blockquote><p><strong>For the built-in types supporting round(), values are rounded to the closest multiple of 10 to the power minus ndigits; if two multiples are equally close, rounding is done toward the even choice (so, for example, both round(0.5) and round(-0.5) are 0, and round(1.5) is 2). Any integer value is valid for ndigits (positive, zero, or negative). The return value is an integer if ndigits is omitted or None. Otherwise the return value has the same type as number.</strong></p></blockquote><p><strong>æ„æ€æ˜¯ä¼šæŠŠè¿™ä¸ªè¾“å…¥çš„æ•°ä¿ç•™åˆ°å°æ•°ç‚¹åæŒ‡å®šçš„ndigitä½æ•°ï¼Œå¹¶ä¸”æŒ‰ç…§ä¸€å®šè§„åˆ™åœ†æ•´ã€‚è§„åˆ™å°±æ˜¯çœ‹çœ‹è¿™ä¸ªæ•°æ›´é è¿‘å·¦å³ä¸¤ç«¯ä¸­å“ªä¸€ç«¯ï¼Œç„¶åå°±å°†è¿™ä¸ªæ•°åœ†æ•´ä¸ºè¿™ä¸€ç«¯ï¼Œæ¯”å¦‚0.4å°±åœ†æ•´ä¸º0ï¼Œ0.6å°±åœ†æ•´ä¸º1ã€‚é‚£å¦‚æœæ˜¯åƒ0.5è¿™æ ·çš„åˆ°å·¦å³ä¸¤ç«¯è·ç¦»ä¸€æ ·çš„æƒ…å†µï¼Œå°±åœ†æ•´åˆ°å¶æ•°çš„ä¸€ç«¯ï¼Œæ¯”å¦‚0.5å°±åœ†æ•´åˆ°0ï¼Œ1.5å°±åœ†æ•´åˆ°2ã€‚</strong></p><p><strong>æ–‡æ¡£é‡Œè¿˜å†™äº†è¿™ä¹ˆä¸€å¥è¯ï¼š</strong></p><blockquote><p><strong>Note: The behavior of round() for floats can be surprising: for example, round(2.675, 2) gives 2.67instead of the expected 2.68. This is not a bug: itâ€™s a result of the fact that most decimal fractions canâ€™t be represented exactly as a float. See Floating Point Arithmetic: Issues and Limitations for more information.</strong></p></blockquote><p><strong>å°±æ˜¯æŒ‰ç…§ä¸Šè¿°è§„åˆ™ï¼Œround(2.675, 2)çš„ç»“æœåº”è¯¥æ˜¯2.68ï¼Œå¯æ˜¯å®é™…ç»“æœæ˜¯ï¼š</strong></p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span>&gt;&gt; round(2.675, 2)</span><br><span class="line">2.67</span><br></pre></td></tr></table></figure></div><p><strong>è¿™ä¸æ˜¯æˆ‘ä»¬å†™äº†ä¸ªbugï¼Œè¿™æ˜¯å› ä¸ºæœºå™¨åœ¨å­˜å‚¨æµ®ç‚¹æ•°2.675çš„æ—¶å€™ï¼Œä¸ä¼šå­˜å‚¨åˆ°è¿™ä¹ˆç²¾ç¡®ï¼Œå­˜å‚¨çš„æ•°æ¯”2.675å°ä¸€ç‚¹ç‚¹ï¼Œåº”è¯¥å·®ä¸å¤šæ˜¯2.674999999è¿™æ ·ï¼Œæ‰€ä»¥æ‰ä¼šè¢«åœ†æ•´åˆ°2.67ï¼Œè¿™ä¸ªé—®é¢˜æ²¡æ³•è§£å†³ã€‚</strong></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CTC Losså­¦ä¹ ç¬”è®°</title>
      <link href="/2019/03/27/CTC%20Loss%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2019/03/27/CTC%20Loss%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>è°¨ä»¥æ­¤æ–‡çºªå¿µä¸€ä¸‹æˆ‘é‚£æ¬¡æ™šä¸Š11ç‚¹åŠæŸ¥å®Œçš„å®éªŒã€‚</p><a id="more"></a><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>è¯­éŸ³è¯†åˆ«æ—¶ï¼Œäººè¯´ä¸€å¥â€œHelloâ€ï¼Œå°½ç®¡å‘éŸ³å¾ˆæ ‡å‡†ï¼Œä½†æ˜¯ç”±äºæœ‰åœé¡¿ã€æ¢æ°”æˆ–æ˜¯å…¶ä»–åŸå› ï¼ŒéŸ³é¢‘ä¿¡æ¯ä¸­çš„â€œHâ€éŸ³å¾ˆå®¹æ˜“å¯¹ä¸ä¸Šæ–‡æœ¬ä¿¡æ¯ä¸­çš„â€œHâ€ã€‚è¿™å°±éœ€è¦é¢„å¤„ç†å¯¹é½é—®é¢˜ï¼Œä½†æ˜¯ç”¨äººå·¥çš„æ–¹æ³•æ‰‹åŠ¨å¯¹é½æ¯”è¾ƒéŸ³é¢‘ä¿¡æ¯å’Œæ–‡æœ¬ä¿¡æ¯ï¼Œéœ€è¦è€—è´¹å¤§é‡çš„äººåŠ›è´¢åŠ›ã€‚CTCå°±æ˜¯å¤„ç†è¿™ä¸€ç±»å¯¹é½é—®é¢˜è€Œç”Ÿçš„æŠ€æœ¯ã€‚</p><h2 id="åŸºæœ¬è¿‡ç¨‹"><a href="#åŸºæœ¬è¿‡ç¨‹" class="headerlink" title="åŸºæœ¬è¿‡ç¨‹"></a>åŸºæœ¬è¿‡ç¨‹</h2><p>åœ¨è¯­éŸ³è¯†åˆ«ä¸­ï¼ŒCTCä¼šé€å¸§è¾¨åˆ«å‘çš„ä»€ä¹ˆéŸ³ã€‚å¦‚æœé€šè¿‡å‘éŸ³è¾¨åˆ«å‡ºäº†ä¸€ä¸ªå­—æ¯ï¼Œé‚£ä¹ˆè¿™ä¸€å¸§å°±æ ‡è®°ä¸ºè¿™ä¸ªå­—æ¯ï¼›å¦‚æœæ²¡å£°éŸ³å°±æ ‡è®°ä¸ºblankï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸¤ä¸ªå•è¯ä¸­é—´çš„ç©ºæ ¼ï¼›å¦‚æœåˆ†è¾¨ä¸å‡ºæ¥æ˜¯å•¥ï¼Œå°±æ ‡è®°ä¸ºÏµ (ctc blank)ã€‚æ‰€ä»¥å°†â€œHelloâ€çš„éŸ³é¢‘ä¿¡æ¯è¿›è¡Œè¾¨åˆ«åï¼Œä¼šå¾—åˆ°çš„ç»“æœå¯èƒ½ä¼šæ˜¯ï¼šâ€œÏµÏµHellÏµÏµlloÏµâ€ï¼Œä¹Ÿå¯èƒ½æ˜¯â€œHeeÏµÏµllÏµÏµlooÏµÏµâ€ï¼Œè¿˜æœ‰å…¶ä»–å¾ˆå¤šç§å¯èƒ½ã€‚</p><p>ctcçš„å¤„ç†è¿‡ç¨‹åˆ†ä¸º2æ­¥ï¼š</p><ol><li>å°†è¯†åˆ«ç»“æœä¸­ç›¸é‚»çš„é‡å¤å­—ç¬¦åˆ æ‰ï¼Œé‚£ä¹ˆâ€œÏµÏµHellÏµÏµlloÏµâ€å°±å˜æˆäº†â€œÏµHelÏµloÏµâ€ï¼Œâ€œHeeÏµÏµllÏµÏµlooÏµÏµâ€å°±å˜æˆäº†â€œHeÏµlÏµloÏµâ€ï¼›</li><li>åˆ å»Ïµï¼Œâ€œÏµHelÏµloÏµâ€å’Œâ€œHeÏµlÏµloÏµâ€å°±éƒ½å˜æˆäº†â€œHelloâ€ã€‚</li></ol><p>æˆ‘ä»¬çš„ç›®çš„æ˜¯æ±‚å‡ºP(lable|x)ï¼Œå…¶ä¸­xæ˜¯è¾“å…¥çš„æ•°æ®ï¼Œlableæ˜¯æ ‡ç­¾æ•°æ®ï¼Œå³æ­£ç¡®çš„è¾“å‡ºã€‚P(lable|x)è¡¨ç¤ºçš„æ˜¯ï¼Œå¦‚æœåœ¨è¾“å…¥æ•°æ®ä¸ºxçš„æ¡ä»¶ä¸‹ï¼Œèƒ½å¤Ÿæ­£ç¡®è¾“å‡ºæ ‡ç­¾æ•°æ®çš„æ¦‚ç‡æœ‰å¤šå¤§ï¼Œè¿™ä¸ªæ¦‚ç‡è‚¯å®šæ˜¯è¶Šå¤§è¶Šå¥½ï¼Œå¦‚æœP(lable|x)=1ï¼Œé‚£ä¹ˆå°±è¯´æ˜ç™¾åˆ†ä¹‹ç™¾å¯ä»¥æ­£ç¡®è¾“å‡ºã€‚</p><p>Lossçš„å®šä¹‰å¦‚ä¸‹ï¼Œå¦‚æœP(lable|x)è¶Šæ¥è¿‘1ï¼ŒLosså°±æ¥è¿‘äº0ï¼›å¦‚æœP(lable|x)è¶Šæ¥è¿‘0ï¼ŒLosså°±ä¼šè¶Šå¤§ï¼š</p><p>$$<br>Loss=-\ln P(lable|x)<br>$$</p><p>P(lable|x)å¦‚ä½•è®¡ç®—å‘¢ï¼Ÿä»ä¸Šé¢ctcçš„å¤„ç†è¿‡ç¨‹å¯ä»¥çœ‹å‡ºæ¥ï¼Œæœ‰å¾ˆå¤šç§åºåˆ—æœ€ç»ˆéƒ½å¯ä»¥å¤„ç†ä¸ºæ ‡ç­¾æ•°æ®ï¼Œâ€œÏµÏµHellÏµÏµlloÏµâ€å°±æ˜¯ä¸€æ¡å¯ä»¥è¢«å¤„ç†ä¸ºâ€œHelloâ€çš„åºåˆ—ï¼Œè®°å…¶ä¸ºseqï¼Œé‚£ä¹ˆäº§ç”Ÿseqçš„æ¦‚ç‡æœ‰å¤šå°‘å‘¢ï¼Ÿè¿™é‡Œ$y_c^t$è¡¨ç¤ºåœ¨ç¬¬tæ—¶é—´æ­¥ç”Ÿæˆå­—ç¬¦cçš„æ¦‚ç‡æœ‰å¤šå°‘ï¼Œé‚£ä¹ˆè¦ç”Ÿæˆseqè¿™ä¹ˆé•¿çš„åºåˆ—ï¼Œå°±è¦æŠŠç”Ÿæˆæ¯ä¸ªå­—ç¬¦çš„æ¦‚ç‡ä¹˜èµ·æ¥ã€‚</p><p>$$<br>P(seq|x)=y_\epsilon^1 \times y_\epsilon^2 \times y_H^3 \times y_e^4 \times y_l^5 \times y_l^6 \times y_\epsilon^7 \times y_\epsilon^8 \times y_l^9 \times y_l^{10} \times y_o^{11} \times y_\epsilon^{12}<br>$$</p><p>å¦‚æœå†ç”¨Ï€æ¥è¡¨ç¤ºä¸€ä¸ªåºåˆ—çš„é›†åˆï¼Œè¿™ä¸ªé›†åˆä¸­æ‰€æœ‰çš„åºåˆ—å’Œseqä¸€æ ·ï¼Œç»è¿‡ctcå¤„ç†è¿‡åï¼Œéƒ½å¯ä»¥å˜ä¸ºæ ‡ç­¾æ•°æ®ã€‚é‚£ä¹ˆå°†è¿™ä¸ªé›†åˆä¸­æ‰€æœ‰åºåˆ—çš„æ¦‚ç‡åŠ èµ·æ¥ï¼Œå°±æ˜¯P(lable|x)ã€‚</p><p>$$<br>P(lable|x)=\sum_{\pi}P(\pi|x)<br>$$</p><p>å¯æ˜¯ï¼ŒÏ€é›†åˆä¸­æœ‰å¤šå°‘åºåˆ—å‘¢ï¼ŒèŒ«èŒ«å¤šçš„åºåˆ—éƒ½å¯ä»¥è½¬ä¸ºlableã€‚å¦‚æœlableæ˜¯â€œcatâ€çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥è½¬ä¸ºâ€œcatâ€çš„åºåˆ—æ•°ï¼Œå¯ä»¥é€šè¿‡ä¸‹å›¾å¯ä»¥çœ‹å‡ºæ¥ï¼Œç™½è‰²èŠ‚ç‚¹è¡¨ç¤ºè¯†åˆ«ä¸ºå­—æ¯ï¼Œé»‘è‰²èŠ‚ç‚¹è¡¨ç¤ºè¯†åˆ«ä¸å‡ºæ¥æ˜¯ä¸ªå•¥ï¼Œæ ‡è®°ä¸ºâ€œÏµâ€ï¼ˆå›¾ç‰‡æ¥è‡ªç½‘ç»œï¼‰ï¼š</p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/ctc_loss_1.png"><p>æ¯ä¸€æ¡è·¯å¾„éƒ½æ˜¯ä¸€ç§è¯­éŸ³è¯†åˆ«çš„ç»“æœï¼Œè€Œä¸”æ­¤ç»“æœå¯ä»¥ç»ç”±ctcå¤„ç†åè½¬æ¢ä¸ºæ ‡ç­¾æ•°æ®ã€‚è¿™æ‰3ä¸ªå­—æ¯ï¼Œå°±è¿™ä¹ˆæ¡è·¯å¾„ï¼Œå¦‚æœæˆç™¾ä¸Šåƒçš„å•è¯ï¼Œä¸€ä¸€è®¡ç®—æ¯ç§å¯èƒ½çš„è¯ï¼Œè¿™ä¸ªè®¡ç®—é‡å¾ˆå¤§ã€‚</p><h2 id="ä½¿ç”¨åŠ¨æ€è§„åˆ’ä¼˜åŒ–"><a href="#ä½¿ç”¨åŠ¨æ€è§„åˆ’ä¼˜åŒ–" class="headerlink" title="ä½¿ç”¨åŠ¨æ€è§„åˆ’ä¼˜åŒ–"></a>ä½¿ç”¨åŠ¨æ€è§„åˆ’ä¼˜åŒ–</h2><p>åŠ¨æ€è§„åˆ’çš„æ€æƒ³æ˜¯è‡ªé¡¶å‘ä¸‹å†™ä¸€ä¸ªé€’å½’å¼ï¼Œç„¶åè‡ªåº•å‘ä¸Šç®—å‡ºæ¥ã€‚</p><p>å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œåœ¨tä¸ªæ—¶é—´æ­¥èµ°åˆ°å­—ç¬¦â€œuâ€çš„è·¯çº¿æœ‰å¾ˆå¤šæ¡ï¼Œå¦‚æœseqæ˜¯å…¶ä¸­ä¸€æ¡è·¯çº¿ï¼Œé‚£ä¹ˆå…¶æ¦‚ç‡ä¸ºï¼š</p>$$P(seq|x)=\prod_{i=1}^{t} y^i_{{seq}_i}$$<p>è¿™é‡Œå®šä¹‰ä¸€ä¸ªå‡½æ•°Î±(t,u)ï¼Œè¡¨ç¤ºåœ¨tä¸ªæ—¶é—´æ­¥èµ°åˆ°å­—ç¬¦â€œuâ€çš„æ¦‚ç‡ã€‚ç”¨Ï€è¡¨ç¤ºæ‰€æœ‰å¯ä»¥åœ¨tä¸ªæ—¶é—´æ­¥èµ°åˆ°å­—ç¬¦â€œuâ€çš„è·¯çº¿é›†åˆï¼Œé‚£ä¹ˆæœ‰ï¼š</p>$$\alpha(t,u)=\sum_{\pi}\prod_{i=1}^{t} y^i_{\pi_i}$$<p>å†çœ‹çœ‹åˆšåˆšå¼€å§‹é‚£ä¸ªä¾‹å­â€œHelloâ€ï¼Œå¦‚æœå½“å‰åœ¨ç¬¬tä¸ªæ—¶é—´æ­¥ï¼Œåˆ¤åˆ«æˆäº†ä¸€ä¸ªå­—ç¬¦â€œlâ€ï¼Œé‚£ä¹ˆåœ¨ç¬¬t-1ä¸ªæ—¶é—´æ­¥ä¸Šï¼Œå¯ä»¥æ˜¯å“ªäº›å­—ç¬¦å‘¢ï¼Ÿ</p><p>è¿™è¦åˆ†2ç§æƒ…å†µè®¨è®ºï¼š</p><ol><li>å¦‚æœâ€œHelloâ€çš„ç¬¬ä¸€ä¸ªâ€œlâ€ï¼Œä¹Ÿå°±æ˜¯â€Helloâ€æ ‡çº¢çš„é‚£ä¸ªâ€œlâ€ï¼Œé‚£ä¹ˆåœ¨ç¬¬t-1ä¸ªæ—¶é—´æ­¥ä¸Šï¼Œå¯ä»¥æ˜¯â€œeâ€ã€â€œÏµâ€ã€â€œlâ€ä¸‰ç§æƒ…å†µï¼›</li></ol><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/ctc_loss_2.png"><p>æ‰€ä»¥è¦æ±‚ç¬¬tä¸ªæ—¶é—´æ­¥èµ°åˆ°â€œlâ€çš„æ¦‚ç‡ï¼Œå°±è¦å…ˆæ±‚å‡ºåœ¨t-1ä¸ªæ—¶é—´æ­¥èµ°åˆ°â€œeâ€ã€â€œÏµâ€ã€â€œlâ€çš„æ¦‚ç‡ï¼Œæ±‚å’Œä¹‹åï¼Œå†ä¹˜ä»¥$y_c^t$ï¼Œå³ï¼š</p><p>$$<br>\alpha(t,u)=y_u^t[\alpha(t-1,u)+\alpha(t-1,u-1)+\alpha(t-1,u-2)]<br>$$</p><p>è¿™é‡Œu-1å’Œu-2è¡¨ç¤ºå­—ç¬¦uçš„ä¸Šä¸€ä¸ªå­—ç¬¦å’Œä¸Šä¸¤ä¸ªå­—ç¬¦ã€‚</p><ol><li>å¦‚æœæ˜¯â€œHelloâ€çš„ç¬¬äºŒä¸ªâ€œlâ€ï¼Œä¹Ÿå°±æ˜¯â€œHelloâ€æ ‡çº¢çš„é‚£ä¸ªâ€œlâ€ï¼Œé‚£ä¹ˆåœ¨ç¬¬t-1ä¸ªæ—¶é—´æ­¥ä¸Šï¼Œåªå¯ä»¥æ˜¯â€œÏµâ€ã€â€œlâ€ä¸¤ç§æƒ…å†µã€‚è¦æ˜¯ç®—ä¸Šä¸Šé¢çš„â€œlâ€ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªâ€œlâ€ä¼šåˆå¹¶æˆ1ä¸ªï¼›å¦‚æœæ˜¯åœ¨tä¸ªæ—¶é—´æ­¥ä¸Šèµ°åˆ°äº†â€œÏµâ€è¿™ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆåœ¨t-1ä¸ªæ—¶é—´æ­¥ä¸Šï¼Œä¹Ÿåªèƒ½æ˜¯â€œlâ€ã€â€œÏµâ€ä¸¤ç§æƒ…å†µã€‚è¦æ˜¯ä¹Ÿç®—ä¸Šä¸Šé¢ä¸€ä¸ªâ€œÏµâ€ï¼Œé‚£ä¹ˆä¼šè·¨è¿‡ä¸­é—´è¿™ä¸ªâ€œlâ€ï¼Œè¿™ä¸ªå­—ç¬¦å°±ä¸è¾“å‡ºäº†ã€‚</li></ol><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/ctc_loss_3.png"><p>æ‰€ä»¥ç¬¬tä¸ªæ—¶é—´æ­¥èµ°åˆ°â€œlâ€æˆ–â€Ïµâ€ï¼Œåªèƒ½æ¨ªç€èµ°è¿‡æ¥ï¼Œæˆ–ä»ä¸Šä¸€ä¸ªå­—ç¬¦è¿‡æ¥ï¼Œæ¦‚ç‡å³ï¼š</p><p>$$<br>\alpha(t,u)=y_u^t[\alpha(t-1,u)+\alpha(t-1,u-1)]<br>$$</p><p>è¿™æ ·é€’å½’å…¬å¼å°±å®šä¹‰å¥½äº†ï¼Œå†ç®—ä¸€ä¸‹é€’å½’å¼å­çš„åº•ï¼š</p><p>$$<br>\alpha(1,1)=y_\epsilon^1<br>$$</p><p>$$<br>\alpha(1,2)=y_h^1<br>$$</p><p>$$<br>\alpha(1,u)=0 \quad u&gt;2<br>$$</p><p>ä»è¿™ä¸ªåº•å¼€å§‹ï¼Œä½¿ç”¨é€’æ¨å…¬å¼è‡ªåº•å‘ä¸Šçš„è®¡ç®—ï¼Œç›´è‡³ç®—å‡º$\alpha(T,lable)+\alpha(T,lable-1)$ï¼ŒTè¡¨ç¤ºæ€»æ—¶é—´æ­¥ï¼Œæ‰€æœ‰å¯ä»¥ç»è¿‡ctcè½¬åŒ–ä¸ºâ€œHelloâ€çš„åºåˆ—ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯â€œÏµâ€ä¹Ÿå¯ä»¥æ˜¯â€œoâ€ã€‚labelè¡¨ç¤ºæ‰€æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯â€œÏµâ€ï¼Œlabel-1è¡¨ç¤ºæœ€åä¸€ä¸ªå­—ç¬¦æ˜¯â€œoâ€ï¼Œè¿™æ ·èµ°å‡ºçš„è·¯çº¿éƒ½å¯ä»¥ç»è¿‡ctcè½¬åŒ–ä¸ºâ€œHelloâ€ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç§‘å¤§è½¯é™¢ - äººå·¥æ™ºèƒ½æœŸä¸­è€ƒè¯•å¤ä¹ </title>
      <link href="/2019/03/27/%E7%A7%91%E5%A4%A7%E8%BD%AF%E9%99%A2%20-%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%9C%9F%E4%B8%AD%E8%80%83%E8%AF%95%E5%A4%8D%E4%B9%A0/"/>
      <url>/2019/03/27/%E7%A7%91%E5%A4%A7%E8%BD%AF%E9%99%A2%20-%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%9C%9F%E4%B8%AD%E8%80%83%E8%AF%95%E5%A4%8D%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è½¯ä»¶å­¦é™¢ äººå·¥æ™ºèƒ½2018å¹´ç§‹è¯¾ç¨‹æœŸä¸­è€ƒè¯•å¤ä¹ ğŸ°</p><a id="more"></a><h2 id="1ã€æœºå™¨å­¦ä¹ çš„å®šä¹‰"><a href="#1ã€æœºå™¨å­¦ä¹ çš„å®šä¹‰" class="headerlink" title="1ã€æœºå™¨å­¦ä¹ çš„å®šä¹‰"></a><strong>1ã€æœºå™¨å­¦ä¹ çš„å®šä¹‰</strong></h2><p><strong>å¯¹äºæŸç±»ä»»åŠ¡Tå’Œæ€§èƒ½åº¦é‡Pï¼Œä¸€ä¸ªè®¡ç®—æœºç¨‹åºè¢«è®¤ä¸ºå¯ä»¥ä»ç»éªŒEä¸­å­¦ä¹ æ˜¯æŒ‡ï¼Œç»è¿‡ç»éªŒEæ”¹è¿›åï¼Œå®ƒåœ¨ä»»åŠ¡Tä¸Šç”±æ€§èƒ½åº¦é‡Pè¡¡é‡çš„æ€§èƒ½æœ‰æ‰€æå‡ã€‚</strong></p><p><strong>ä»»åŠ¡Tï¼šTesting Set - æµ‹è¯•é›†</strong></p><p><strong>æ€§èƒ½åº¦é‡Pï¼šLoss Function - æŸå¤±å‡½æ•°</strong></p><p><strong>ç»éªŒEï¼šTraining Set - è®­ç»ƒé›†</strong></p><h2 id="2ã€Loss-Function-Cost-Function-æŸå¤±å‡½æ•°"><a href="#2ã€Loss-Function-Cost-Function-æŸå¤±å‡½æ•°" class="headerlink" title="2ã€Loss Function/Cost Function - æŸå¤±å‡½æ•°"></a><strong>2ã€Loss Function/Cost Function - æŸå¤±å‡½æ•°</strong></h2><p><strong>å‡è®¾å‡½æ•°ï¼š</strong><br>$$<br>h_{w,b}(x) = wx+b<br>$$<br><strong>åœ¨å›å½’ä»»åŠ¡ä¸­ï¼Œå¤šä½¿ç”¨å‡æ–¹è¯¯å·®ä½œä¸ºæŸå¤±å‡½æ•°ï¼š</strong><br>$$<br>L(w,b) = \frac{1}{2m}\sum_{i=1}^{m}(h_{w,b}(x^{(i)}) - \hat{y}^{(i)})^2<br>$$<br><strong>åœ¨åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œå¤šä½¿ç”¨äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°ï¼š</strong><br>$$<br>L(w,b) = \frac{1}{m}\sum_{i=1}^{m}[-\hat{y}^{(i)}\log(h_{w,b}(x^{(i)})) - (1-\hat{y}^{(i)})\log(1-h_{w,b}(x^{(i)}))]<br>$$</p><h2 id="3ã€Sigmoid-Functionå’ŒSoftmax-Function"><a href="#3ã€Sigmoid-Functionå’ŒSoftmax-Function" class="headerlink" title="3ã€Sigmoid Functionå’ŒSoftmax Function"></a><strong>3ã€Sigmoid Functionå’ŒSoftmax Function</strong></h2><p><strong>Sigmoid Functionä¸å…·ä½“è¡¨ç¤ºå“ªä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯è¡¨ç¤ºä¸€ç±»Så‹å‡½æ•°ï¼Œå¸¸ç”¨çš„æœ‰é€»è¾‘å‡½æ•°Ïƒ(z)ï¼š</strong><br>$$<br>\sigma(z) = \frac{1}{1+e^{-z}}<br>$$<br><strong>Softmax Functionï¼Œæˆ–ç§°å½’ä¸€åŒ–æŒ‡æ•°å‡½æ•°ï¼Œæ˜¯é€»è¾‘å‡½æ•°çš„ä¸€ç§æ¨å¹¿ã€‚å®ƒèƒ½å°†ä¸€ä¸ªå«ä»»æ„å®æ•°çš„Kç»´å‘é‡z â€œå‹ç¼©â€åˆ°å¦ä¸€ä¸ªKç»´å®å‘é‡ Ïƒ(z)  ä¸­ï¼Œä½¿å¾—æ¯ä¸€ä¸ªå…ƒç´ çš„èŒƒå›´éƒ½åœ¨(0,1) ä¹‹é—´ï¼Œå¹¶ä¸”æ‰€æœ‰å…ƒç´ çš„å’Œä¸º1ã€‚è¯¥å‡½æ•°çš„å½¢å¼é€šå¸¸æŒ‰ä¸‹é¢çš„å¼å­ç»™å‡ºï¼š</strong><br>$$<br>\sigma(z)_{j} = \frac{e^{z_{j}}}{\sum_{k=1}^{K}e^{z_{k}}} \quad j = 1,â€¦,K<br>$$</p><h2 id="4ã€åœ¨Logistic-Regressionä¸­ï¼Œä¸ºä½•ä½¿ç”¨Cross-Entropyä½œä¸ºæŸå¤±å‡½æ•°è€Œä¸ä½¿ç”¨MSE"><a href="#4ã€åœ¨Logistic-Regressionä¸­ï¼Œä¸ºä½•ä½¿ç”¨Cross-Entropyä½œä¸ºæŸå¤±å‡½æ•°è€Œä¸ä½¿ç”¨MSE" class="headerlink" title="4ã€åœ¨Logistic Regressionä¸­ï¼Œä¸ºä½•ä½¿ç”¨Cross Entropyä½œä¸ºæŸå¤±å‡½æ•°è€Œä¸ä½¿ç”¨MSE"></a><strong>4ã€åœ¨Logistic Regressionä¸­ï¼Œä¸ºä½•ä½¿ç”¨Cross Entropyä½œä¸ºæŸå¤±å‡½æ•°è€Œä¸ä½¿ç”¨MSE</strong></h2><p><strong>Logistic Regressionçš„å‡è®¾å‡½æ•°å¦‚ä¸‹ï¼š</strong><br>$$<br>\sigma(z) = \frac{1}{1+e^{-z}} \quad z(x) = wx+b<br>$$</p><p><strong>Ïƒ(z)åˆ†åˆ«å¯¹wå’Œbæ±‚å¯¼ï¼Œç»“æœä¸ºï¼š</strong><br>$$<br>\frac{\partial \sigma(z)}{\partial w} = \frac{\mathrm{d} \sigma(z)}{\mathrm{d} z} \frac{\partial z}{\partial w}= \sigma(z)(1-\sigma(z))*x<br>$$</p><p>$$<br>\frac{\partial \sigma(z)}{\partial b} = \frac{\mathrm{d} \sigma(z)}{\mathrm{d} z} \frac{\partial z}{\partial b}= \sigma(z)(1-\sigma(z))<br>$$</p><p><strong>å¦‚æœä½¿ç”¨MSEä½œä¸ºæŸå¤±å‡½æ•°çš„è¯ï¼Œé‚£å†™å‡ºæ¥æ˜¯è¿™æ ·çš„ï¼š</strong><br>$$<br>L(w,b) = \frac{1}{2m}\sum_{i=1}^{m}(\sigma_{w,b}(x^{(i)}) - \hat{y}^{(i)})^2<br>$$<br><strong>å½“æˆ‘ä»¬ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥è¿›è¡Œå‡¸ä¼˜åŒ–çš„æ—¶å€™ï¼Œåˆ†åˆ«éœ€è¦è®¡ç®—L(w,b)å¯¹wå’Œbçš„åå¯¼æ•°ï¼š</strong></p><p>$$<br>\frac{\partial L(w,b)}{\partial w} = \frac{1}{m}\sum_{i=1}^{m}(\sigma_{w,b}(x^{(i)}) - \hat{y}^{(i)})\sigma_{w,b}(x^{(i)})(1-\sigma_{w,b}(x^{(i)}))x^{(i)}<br>$$</p><p>$$<br>\frac{\partial L(w,b)}{\partial b} = \frac{1}{m}\sum_{i=1}^{m}(\sigma_{w,b}(x^{(i)}) - \hat{y}^{(i)})\sigma_{w,b}(x^{(i)})(1-\sigma_{w,b}(x^{(i)}))<br>$$</p><p><strong>æ‰€ä»¥åœ¨Ïƒ(x)æ¥è¿‘äº1æˆ–è€…0çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯é¢„æµ‹çš„ç»“æœå’ŒçœŸå®ç»“æœå¾ˆç›¸è¿‘æˆ–è€…å¾ˆä¸ç›¸è¿‘çš„æ—¶å€™ï¼ŒÏƒ(x)å’Œ1-Ïƒ(x)ä¸­æ€»æœ‰ä¸€ä¸ªä¼šç‰¹åˆ«å°ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ¢¯åº¦å¾ˆå°ï¼Œä»è€Œä½¿å¾—ä¼˜åŒ–é€Ÿåº¦å¤§å¤§å‡ç¼“ã€‚</strong></p><p><strong>è€Œå½“ä½¿ç”¨Cross Entropyä½œä¸ºæŸå¤±å‡½æ•°æ—¶ï¼ŒæŸå¤±å‡½æ•°ä¸ºï¼š</strong><br>$$<br>L(w,b) = \frac{1}{m}\sum_{i=1}^{m}(-\hat{y}^{(i)}\log(\sigma_{w,b}(x^{(i)})) - (1-\hat{y}^{(i)})\log(1-\sigma_{w,b}(x^{(i)})))<br>$$</p><p><strong>L(w,b)åˆ†åˆ«å¯¹wå’Œbæ±‚åå¯¼ï¼Œç»“æœå¦‚ä¸‹ï¼š</strong><br>$$<br>\frac{\partial L(w,b) }{\partial w}= \frac{1}{m}\sum_{i=1}^{m}(\sigma_{w,b}(x^{(i)})-\hat{y}^{(i)})x^{(i)}<br>$$</p><p>$$<br>\frac{\partial L(w,b) }{\partial b}= \frac{1}{m}\sum_{i=1}^{m}(\sigma_{w,b}(x^{(i)})-\hat{y}^{(i)})<br>$$</p><p><strong>è¿™æ ·æ¢¯åº¦å§‹ç»ˆå’Œé¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹å·®æŒ‚é’©ï¼Œé¢„æµ‹å€¼ä¸çœŸå®å€¼åç¦»å¾ˆå¤§æ—¶ï¼Œæ¢¯åº¦ä¹Ÿä¼šå¾ˆå¤§ï¼Œåç¦»å¾ˆå°æ—¶ï¼Œæ¢¯åº¦ä¼šå¾ˆå°ã€‚æ‰€ä»¥æˆ‘ä»¬æ›´å€¾å‘äºä½¿ç”¨Cross Entropyè€Œä¸ä½¿ç”¨MSEã€‚å‡½æ•°å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</strong><br><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1_1.png"></p><h2 id="5ã€ä¸€å †ä¼˜åŒ–æ–¹æ³•"><a href="#5ã€ä¸€å †ä¼˜åŒ–æ–¹æ³•" class="headerlink" title="5ã€ä¸€å †ä¼˜åŒ–æ–¹æ³•"></a><strong>5ã€ä¸€å †ä¼˜åŒ–æ–¹æ³•</strong></h2><p><strong>è¿™å †ä¼˜åŒ–æ–¹æ³•åªæœ‰ä¸€ä¸ªç›®æ ‡ï¼šå¯»æ±‚åˆé€‚çš„wå’Œbï¼ˆä¸¤ä¸ªå‚æ•°æƒ…å†µï¼‰ï¼Œä½¿å¾—L(w,b)æŸå¤±å‡½æ•°çš„å€¼æœ€å°ã€‚</strong></p><h3 id="1-Gradient-Descent-æ¢¯åº¦ä¸‹é™"><a href="#1-Gradient-Descent-æ¢¯åº¦ä¸‹é™" class="headerlink" title="(1) Gradient Descent - æ¢¯åº¦ä¸‹é™"></a><strong>(1) Gradient Descent - æ¢¯åº¦ä¸‹é™</strong></h3><p><strong>å¦‚æœéœ€è¦æ‰¾åˆ°ä¸€ä¸ªå‡½æ•°çš„å±€éƒ¨æå°å€¼ï¼Œå¿…é¡»æœç€å‡½æ•°ä¸Šå½“å‰ç‚¹æ‰€å¯¹åº”æ¢¯åº¦ï¼ˆæˆ–è€…æ˜¯è¿‘ä¼¼æ¢¯åº¦ï¼‰çš„åæ–¹å‘ï¼Œå‰è¿›è§„å®šæ­¥é•¿çš„è·ç¦»è¿›è¡Œè¿­ä»£æœç´¢ã€‚</strong></p><p>$$<br>wâ€™ \leftarrow w - \eta \frac{\partial L(w,b)}{\partial w}<br>$$</p><p>$$<br>bâ€™ \leftarrow b - \eta \frac{\partial L(w,b)}{\partial b}<br>$$</p><p><strong>tips: è¿™é‡Œä¸å¯ä»¥å°†æ›´æ–°å¥½çš„wâ€™ä»£å…¥åˆ°L(w,b)ä¸­ç„¶åè®¡ç®—bâ€™ï¼Œå‚æ•°wå’Œbéƒ½å¿…é¡»ç­‰è®¡ç®—å¥½åä¸€èµ·æ›´æ–°ã€‚</strong></p><p><strong>Î·ä»£è¡¨å­¦ä¹ ç‡ï¼Œéƒ¨åˆ†å†³å®šäº†æ¯ä¸€æ¬¡æ›´æ–°çš„æ­¥é•¿å¤§å°ï¼Œå¦‚æœå­¦ä¹ ç‡å¤ªä½ä¼šå¯¼è‡´æ›´æ–°ååˆ†ç¼“æ…¢ï¼Œå­¦ä¹ ç‡å¤ªé«˜åˆä¼šå¯¼è‡´æ­¥é•¿å¤ªå¤§å…¨åœºä¹±è·‘ã€‚</strong></p><h4 id="ä¸ºä»€ä¹ˆè¦ä»¥æ¢¯åº¦çš„åæ–¹å‘ä¸ºæ›´æ–°æ–¹å‘ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ä»¥æ¢¯åº¦çš„åæ–¹å‘ä¸ºæ›´æ–°æ–¹å‘ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä»¥æ¢¯åº¦çš„åæ–¹å‘ä¸ºæ›´æ–°æ–¹å‘ï¼Ÿ"></a><strong>ä¸ºä»€ä¹ˆè¦ä»¥æ¢¯åº¦çš„åæ–¹å‘ä¸ºæ›´æ–°æ–¹å‘ï¼Ÿ</strong></h4><p><strong>å› ä¸ºæ¢¯åº¦æ–¹å‘æ˜¯å‡½æ•°æ–¹å‘å¯¼æ•°æœ€å¤§çš„æ–¹å‘ï¼Œæ‰€ä»¥æ²¿ç€æ¢¯åº¦æ–¹å‘çš„åæ–¹å‘æ›´æ–°çš„è¯ï¼Œå‡½æ•°ä¸‹é™çš„å˜åŒ–ç‡æœ€å¤§ã€‚ï¼ˆæ„Ÿè°¢zzjåœ¨è¯„è®ºä¸­æŒ‡æ­£ï¼‰</strong></p><h3 id="2-Stochastic-Gradient-Descent-éšæœºæ¢¯åº¦ä¸‹é™"><a href="#2-Stochastic-Gradient-Descent-éšæœºæ¢¯åº¦ä¸‹é™" class="headerlink" title="(2) Stochastic Gradient Descent - éšæœºæ¢¯åº¦ä¸‹é™"></a><strong>(2) Stochastic Gradient Descent - éšæœºæ¢¯åº¦ä¸‹é™</strong></h3><p><strong>éšæœºæ¢¯åº¦ä¸‹é™çš„æŸå¤±å‡½æ•°è¦è¿™æ ·å®šä¹‰ï¼š</strong></p><p>$$<br>L^{(i)}(w,b) = \frac{1}{2}(h_{w,b}(x^{(i)}) - \hat{y}^{(i)})^2<br>$$</p><p><strong>å¯¹æ¯”æ¢¯åº¦ä¸‹é™çš„æŸå¤±å‡½æ•°ï¼Œå‘ç°è¿™é‡Œå°‘äº†æ±‚å’Œä»¥åŠæ±‚å¹³å‡å€¼çš„è¿‡ç¨‹ï¼Œå› ä¸ºè¿™é‡Œåªæœ‰ä¸€ä¸ªæ ·æœ¬ä½œä¸ºå‚è€ƒï¼Œè¿™ä¸ªæŸå¤±å‡½æ•°ä¹Ÿæ˜¯å…³äºè¿™ä¸€ä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°ã€‚</strong></p><p><strong>å¯ä»¥è¿™æ ·æ¥ç†è§£ï¼šè®­ç»ƒé›†é‡Œæœ‰20ä¸ªæ ·æœ¬ï¼Œç°åœ¨æˆ‘å°±å½“ä½œæˆ‘åªæ‹¥æœ‰è¿™20ä¸ªæ ·æœ¬çš„å…¶ä¸­ä¸€ä¸ªæ ·æœ¬ï¼Œç„¶åä½¿ç”¨è¿™ä¸€ä¸ªæ ·æœ¬æ›´æ–°å‚æ•°ï¼Œç„¶åå†æŒ‘å¦ä¸€ä¸ªæ ·æœ¬ï¼Œæ›´æ–°å‚æ•°ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰€æœ‰æ ·æœ¬éƒ½è¢«ç”¨å®Œåï¼Œè¿™ä¸€è½®éšæœºæ¢¯åº¦ä¸‹é™å°±ç»“æŸäº†ã€‚</strong></p><p><strong>å’Œæ¢¯åº¦ä¸‹é™æ¯”è¾ƒä¸€ä¸‹ï¼Œéšæœºæ¢¯åº¦ä¸‹é™çš„å¥½å¤„æ˜¯ï¼šæ¢¯åº¦ä¸‹é™æ¯æ¬¡æ›´æ–°éƒ½ç”¨åˆ°äº†æ‰€æœ‰çš„æ ·æœ¬ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨æ‰€æœ‰æ ·æœ¬çš„ä¿¡æ¯è¿›è¡Œä¸€æ¬¡å‚æ•°æ›´æ–°ã€‚è€Œéšæœºæ¢¯åº¦ä¸‹é™æ¯æ¬¡æ›´æ–°åªç”¨åˆ°äº†ä¸€ä¸ªæ ·æœ¬ï¼Œå¦‚æœè¿™ä¸ªè®­ç»ƒé›†æœ‰mä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆæ¢¯åº¦ä¸‹é™æ›´æ–°ä¸€æ¬¡å‚æ•°ï¼Œéšæœºæ¢¯åº¦ä¸‹é™å·²ç»æ›´æ–°äº†mæ¬¡å‚æ•°äº†ã€‚æ‰€ä»¥éšæœºæ¢¯åº¦ä¸‹é™çš„æ›´æ–°é¢‘ç‡æ˜¯æ¢¯åº¦ä¸‹é™çš„må€ï¼Œæ›´æ–°é€Ÿåº¦æ›´å¿«ï¼›</strong></p><p><strong>è€Œéšæœºæ¢¯åº¦ä¸‹é™æ‰€å¸¦æ¥çš„åå¤„æ˜¯ï¼šéšæœºæ¢¯åº¦ä¸‹é™çš„æ›´æ–°åªå‚è€ƒäº†ä¸€ä¸ªæ ·æœ¬ï¼Œè¿™ç§å‚è€ƒæœ‰ç‚¹ç®¡ä¸­çª¥è±¹äº†ï¼Œæ˜¯ä¸å¯èƒ½é¡¾å…¨å¤§å±€çš„ï¼Œæ‰€ä»¥æ›´æ–°æ—¶å€™çš„æŠ–åŠ¨ç°è±¡å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯å‚æ•°çš„å‰è¿›æ–¹å‘ä¹±ä¸ƒå…«ç³Ÿçš„ï¼Œä½†æ˜¯æ€»ä½“æ¥è¯´è¿˜æ˜¯å‘ç€æœ€ä½ç‚¹å‰è¿›ã€‚</strong></p><h3 id="3-Mini-batch-Gradient-Descent-Mini-batchæ¢¯åº¦ä¸‹é™"><a href="#3-Mini-batch-Gradient-Descent-Mini-batchæ¢¯åº¦ä¸‹é™" class="headerlink" title="(3) Mini-batch Gradient Descent - Mini-batchæ¢¯åº¦ä¸‹é™"></a><strong>(3) Mini-batch Gradient Descent - Mini-batchæ¢¯åº¦ä¸‹é™</strong></h3><p><strong>Mini-batchæ¢¯åº¦ä¸‹é™æ˜¯æ¢¯åº¦ä¸‹é™å’Œéšæœºæ¢¯åº¦ä¸‹é™çš„ä¸­å’Œç‰ˆæœ¬ï¼Œéšæœºæ¢¯åº¦ä¸‹é™æ¯æ¬¡æ›´æ–°åªè€ƒè™‘ä¸€ä¸ªæ ·æœ¬ï¼Œæ¢¯åº¦ä¸‹é™æ¯æ¬¡æ›´æ–°è€ƒè™‘æ‰€æœ‰æ ·æœ¬ï¼Œè€ŒMini-batchæ¢¯åº¦ä¸‹é™æ¯æ¬¡æ›´æ–°æ‰€è€ƒè™‘çš„æ ·æœ¬æ˜¯å¯ä»¥è¢«æŒ‡å®šçš„ï¼Œå¦‚æœæ€»å…±æœ‰mä¸ªæ ·æœ¬ï¼Œé‚£å°±å¯ä»¥åœ¨1~mä¸­ä»»æ„æŒ‡å®šã€‚</strong></p><p><strong>å¦‚æœæ¯æ¬¡æ›´æ–°æ—¶æ‰€å‚è€ƒçš„æ ·æœ¬æ•°åˆé€‚ï¼Œé‚£ä¹ˆæ—¢å…¼é¡¾äº†éšæœºæ¢¯åº¦ä¸‹é™æ›´æ–°é€Ÿåº¦å¿«çš„ç‰¹æ€§ï¼Œåˆå…¼é¡¾äº†æ¢¯åº¦ä¸‹é™æ›´æ–°çš„ç¨³å®šæ€§ã€‚</strong></p><p><strong>å¯ä»¥è¯´æ¢¯åº¦ä¸‹é™å’Œéšæœºæ¢¯åº¦ä¸‹é™éƒ½æ˜¯Mini-batchæ¢¯åº¦ä¸‹é™çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œä½¿ç”¨æ¢¯åº¦ä¸‹é™æ—¶ï¼ŒæŒ‡å®šæ¯æ¬¡æ›´æ–°å‚è€ƒå…¨éƒ¨æ ·æœ¬ï¼Œè€Œä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ—¶ï¼Œæ¯æ¬¡æ›´æ–°åªå‚è€ƒ1ä¸ªæ ·æœ¬ã€‚</strong></p><p><strong>æ³¨æ„ï¼šè™½ç„¶éšæœºæ¢¯åº¦ä¸‹é™å’ŒMini-batchæ¢¯åº¦ä¸‹é™éƒ½æ˜¯åŸºäºä¸€éƒ¨åˆ†æ•°æ®è¿›è¡Œå‚æ•°æ›´æ–°ï¼Œä½†æ˜¯æ›´æ–°å®ŒåæŸ¥çœ‹æŸå¤±å‡½æ•°æ˜¯åŸºäºå…¨éƒ¨è®­ç»ƒæ•°æ®æ‰€å¾—å‡ºçš„è®­ç»ƒè¯¯å·®ã€‚</strong></p><h3 id="4-Adagradç®—æ³•"><a href="#4-Adagradç®—æ³•" class="headerlink" title="(4) Adagradç®—æ³•"></a><strong>(4) Adagradç®—æ³•</strong></h3><p><strong>åƒAdagradè¿™ä¸€ç±»è‡ªé€‚åº”ç®—æ³•éƒ½æ˜¯ä½¿ç”¨äº†è‡ªé€‚åº”çš„å­¦ä¹ ç‡ï¼Œä»–ä»¬éƒ½æœ‰ä¸€ä¸ªåŸºæœ¬æ€è·¯ï¼šåœ¨æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨åŒä¸€ä¸ªå­¦ä¹ ç‡æ˜¯ä¸åˆé€‚çš„ï¼Œå› ä¸ºåœ¨è®­ç»ƒå¼€å§‹æ—¶ï¼ŒæŸå¤±å€¼è‚¯å®šæ˜¯æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥éœ€è¦è¾ƒå¤§çš„å­¦ä¹ ç‡ï¼Œè€Œè®­ç»ƒå¿«è¦ç»“æŸæ—¶ï¼Œè¶Šæ¥è¶Šæ¥è¿‘æœ€ä½ç‚¹äº†ï¼Œæ­¤æ—¶éœ€è¦è¾ƒå°å­¦ä¹ ç‡ã€‚æ‰€ä»¥è¿™ç±»ç®—æ³•ä¼šä¾æ®æŸäº›å› ç´ ï¼Œåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œé€æ¸å‡å°å­¦ä¹ ç‡ã€‚</strong></p><p><strong>æ¯”å¦‚å¯ä»¥æŒ‰ä¸‹é¢è¿™ä¸ªå…¬å¼æ¥è®¾è®¡è‡ªé€‚åº”çš„å­¦ä¹ ç‡ï¼Œå…¶ä¸­tä»£è¡¨äº†è¿­ä»£æ¬¡æ•°ï¼š</strong></p><p>$$<br>\eta^t=\frac{\eta}{\sqrt{t+1}}<br>$$</p><p><strong>è¿™æ ·å­¦ä¹ ç‡å°±ä¼šæ ¹æ®è¿­ä»£æ¬¡æ•°æ¥æ”¾ç¼“å­¦ä¹ ç‡ï¼Œä»è€Œè¾¾åˆ°å­¦ä¹ ç‡è¶Šæ¥è¶Šå°çš„ç›®çš„ã€‚ä½†æ˜¯è¿™æ ·è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºè¿˜è¦è€ƒè™‘åˆ°å…·ä½“çš„å‡½æ•°æƒ…å†µã€‚Adagradç®—æ³•ä¸ä»…è¦æ±‚å­¦ä¹ ç‡è·Ÿç€è¿­ä»£æ¬¡æ•°å˜åŒ–ï¼Œå°±æ˜¯æŒ‰ä¸Šé¢çš„å…¬å¼ç®—å‡º$\eta^t$ï¼Œè¿˜è¦å†é™¤ä»¥ä¹‹å‰æ‰€æœ‰æ¢¯åº¦çš„å¹³æ–¹å¹³å‡æ•°ï¼Œ$g^t$ä»£è¡¨äº†ç¬¬tæ¬¡è¿­ä»£æ—¶çš„æ¢¯åº¦ã€‚</strong></p><p>$$<br>w^1 \leftarrow w^0 - \frac{\eta^0}{\sigma^0}g^0 \qquad \sigma^0 = \sqrt{(g^0)^2}<br>$$</p><p>$$<br>w^2 \leftarrow w^1 - \frac{\eta^1}{\sigma^1}g^1 \qquad \sigma^1 = \sqrt{\frac{1}{2}[(g^0)^2+(g^1)^2]}<br>$$</p><p>$$<br>w^3 \leftarrow w^2 - \frac{\eta^2}{\sigma^2}g^2 \qquad \sigma^2 = \sqrt{\frac{1}{3}[(g^0)^2+(g^1)^2 + (g^2)^2]}<br>$$</p><p>$$<br>â€¦â€¦<br>$$</p><p>$$<br>w^{t+1} \leftarrow w^t - \frac{\eta^t}{\sigma^t}g^t \qquad \sigma^t = \sqrt{\frac{1}{t+1}\sum_{i=0}^{t}(g^i)^2}<br>$$</p><p><strong>å…¶ä¸­æœ‰$\eta^t=\frac{\eta}{\sqrt{t+1}}â€‹$ä»£å…¥åˆ°æœ€åä¸€ä¸ªå¼å­å°±å¯ä»¥å¾—åˆ°ï¼š</strong><br>$$<br>w^{t+1} \leftarrow w^t - \frac{\frac{\eta}{\sqrt{t+1}}}{\sqrt{\frac{1}{t+1}\sum_{i=0}^{t}(g^i)^2}}g^t<br>$$</p><p><strong>åŒæ—¶çº¦å»$\frac{1}{\sqrt{t+1}}$åå°±å¯ä»¥å¾—åˆ°ï¼š</strong></p><p>$$<br>w^{t+1} \leftarrow w^t - \frac{\eta}{\sqrt{\sum_{i=0}^{t}(g^i)^2}}g^t<br>$$</p><p><strong>è¿™å°±æ˜¯Adagradç®—æ³•çš„å…¬å¼äº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªå¼å­ä¸­ï¼Œå­¦ä¹ ç‡æ˜¯ä¼šä¸€ç›´é™¤ä»¥å‰é¢æ‰€æœ‰æ¢¯åº¦çš„å¹³æ–¹å’Œå†å¼€æ ¹å·çš„ï¼Œè¿™ä¸€å®šæ˜¯ä¸€ä¸ªå¤§äº0çš„æ•°ï¼Œæ‰€ä»¥å­¦ä¹ ç‡ä¼šè¶Šæ¥è¶Šå°ã€‚ä½†æ˜¯é˜²æ­¢ä¸€å¼€å§‹çš„æ—¶å€™æ¢¯åº¦å°±æ˜¯0ï¼Œå¦‚æœè®©åˆ†æ¯å˜ä¸º0ä¼šå¯¼è‡´é”™è¯¯çš„ï¼Œæ‰€ä»¥åé¢è¿˜è¦è·Ÿä¸€ä¸ªå¾ˆå°çš„æ­£æ•°$\epsilonâ€‹$ï¼Œæœ€ç»ˆçš„å¼å­æ˜¯è¿™æ ·çš„ï¼š</strong><br>$$<br>w^{t+1} \leftarrow w^t - \frac{\eta}{\sqrt{\sum_{i=0}^{t}(g^i)^2+\epsilon}}g^t<br>$$</p><p><strong>Adagradç®—æ³•ä¹Ÿæœ‰å¾ˆå¤šä¸è¶³ï¼š</strong></p><p><strong>a) å¦‚æœåˆå§‹çš„å­¦ä¹ ç‡è®¾ç½®è¿‡å¤§çš„è¯ï¼Œè¿™ä¸ªå­¦ä¹ ç‡è¦é™¤ä»¥ä¸€ä¸ªè¾ƒå¤§æ¢¯åº¦ï¼Œé‚£ä¹ˆæ­¤ç®—æ³•ä¼šå¯¹æ¢¯åº¦çš„è°ƒèŠ‚å¤ªå¤§ï¼›</strong><br><strong>b) åœ¨è®­ç»ƒçš„ä¸­åæœŸï¼Œåˆ†æ¯ä¸Šæ¢¯åº¦å¹³æ–¹çš„ç´¯åŠ å°†ä¼šè¶Šæ¥è¶Šå¤§ï¼Œä½¿$gradient\to0$ï¼Œä½¿å¾—è®­ç»ƒæå‰ç»“æŸã€‚</strong></p><h3 id="5-RMSpropç®—æ³•"><a href="#5-RMSpropç®—æ³•" class="headerlink" title="(5) *RMSpropç®—æ³•"></a><strong>(5) *RMSpropç®—æ³•</strong></h3><p><strong>æˆ‘æ„Ÿè§‰æœ€å¤šè€ƒåˆ°Adagradç®—æ³•å°±è¡Œäº†ï¼ŒRMSpropåº”è¯¥è€ƒä¸åˆ°ã€‚</strong></p><p><strong>åœ¨å‡¸ä¼˜åŒ–é—®é¢˜ä¸Šï¼ŒAdagradç®—æ³•å…·æœ‰å¾ˆå¥½çš„æ•ˆæœï¼Œä½†æ˜¯åœ¨ç¥ç»ç½‘ç»œæƒ…å†µä¸‹ï¼Œå¾ˆå¤šé—®é¢˜éƒ½æ˜¯éå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå³æŸå¤±å‡½æ•°æœ‰å¾ˆå¤šå±€éƒ¨æœ€å°å€¼ï¼Œæœ‰äº†Adagradç®—æ³•çš„æ”¹è¿›ç‰ˆRMSpropç®—æ³•ï¼ŒRMSpropç®—æ³•å°±åƒæ˜¯çœŸå®ç‰©ç†ä¸–ç•Œä¸­ä¸€ä¸ªå°çƒåœ¨å±±å¡ä¸Šå‘ä¸‹æ»‘ï¼Œå¦‚æœæ»‘è½åˆ°ä¸€ä¸ªå±±è°·ä¸­ï¼Œå°çƒæ˜¯ä¸ä¼šç«‹åˆ»åœåœ¨è¿™é‡Œçš„ï¼Œç”±äºå…·æœ‰æƒ¯æ€§çš„åŸå› ï¼Œå°çƒä¼šç»§ç»­å‘å‰å†²ï¼Œå¦‚æœæƒ¯æ€§è¶³å¤Ÿçš„è¯ï¼Œå¯èƒ½ä¼šå†æ¬¡å†²å‡ºå±±å¤´ï¼Œæ›´æœ‰å¯èƒ½ä¼šè½åˆ°å¦ä¸€ä¸ªæ›´ä½çš„å±±è°·ä¸­ã€‚è€Œä¼ ç»Ÿçš„æ¢¯åº¦ä¸‹é™æ³•åªä¼šè½åœ¨ä¸€ä¸ªå±±è°·ä¸­ï¼Œæ²¡æœ‰æœºä¼šå†²å‡ºæ¥ã€‚</strong><br>$$<br>w^1 \leftarrow w^0 - \frac{\eta}{\sigma^0}g^0 \qquad \sigma^0 = g^0<br>$$</p><p>$$<br>w^2 \leftarrow w^1 - \frac{\eta}{\sigma^1}g^1 \qquad \sigma^1 = \sqrt{\alpha(\sigma^0)^2 + (1-\alpha)(g^1)^2}<br>$$</p><p>$$<br>w^3 \leftarrow w^2 - \frac{\eta}{\sigma^2}g^2 \qquad \sigma^2 = \sqrt{\alpha(\sigma^1)^2 + (1-\alpha)(g^2)^2}<br>$$</p><p>$$<br>â€¦â€¦<br>$$</p><p>$$<br>w^{t+1} \leftarrow w^t - \frac{\eta}{\sigma^t}g^t \qquad \sigma^t = \sqrt{\alpha(\sigma^{t-1})^2 + (1-\alpha)(g^t)^2}<br>$$</p><p><strong>Adagradå’ŒRMSpropç®—æ³•è¿™ä¸¤ä¸ªç®—æ³•å¾ˆç›¸è¿‘ï¼Œä¸åŒä¹‹å¤„åœ¨äºRMSpropç®—æ³•å¢åŠ äº†ä¸€ä¸ªè¡°å‡ç³»æ•°Î±æ¥æ§åˆ¶å†å²ä¿¡æ¯çš„è·å–å¤šå°‘ã€‚</strong></p><h2 id="6ã€Cross-Validation-äº¤å‰éªŒè¯"><a href="#6ã€Cross-Validation-äº¤å‰éªŒè¯" class="headerlink" title="6ã€Cross Validation - äº¤å‰éªŒè¯"></a><strong>6ã€Cross Validation - äº¤å‰éªŒè¯</strong></h2><p><strong>å°†æ•°æ®é›†Dåˆ’åˆ†æˆkä¸ªå¤§å°ç›¸ä¼¼çš„äº’æ–¥å­é›†ï¼Œæ¯æ¬¡ç”¨k-1ä¸ªå­é›†ä½œä¸ºè®­ç»ƒé›†ï¼Œä½™ä¸‹çš„å­é›†åšæµ‹è¯•é›†ï¼Œæœ€ç»ˆè¿”å›kä¸ªè®­ç»ƒç»“æœçš„å¹³å‡å€¼ã€‚äº¤å‰éªŒè¯æ³•è¯„ä¼°ç»“æœçš„ç¨³å®šæ€§å’Œä¿çœŸæ€§å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºkçš„å–å€¼ã€‚</strong></p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1_2.png"><h3 id="ä¸ºä»€ä¹ˆè¦ç”¨äº¤å‰éªŒè¯-Cross-Validationï¼‰"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨äº¤å‰éªŒè¯-Cross-Validationï¼‰" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨äº¤å‰éªŒè¯(Cross-Validationï¼‰"></a><strong>ä¸ºä»€ä¹ˆè¦ç”¨äº¤å‰éªŒè¯(Cross-Validationï¼‰</strong></h3><p><strong>a) äº¤å‰éªŒè¯ç”¨äºè¯„ä¼°æ¨¡å‹çš„é¢„æµ‹æ€§èƒ½ï¼Œå°¤å…¶æ˜¯è®­ç»ƒå¥½çš„æ¨¡å‹åœ¨æ–°æ•°æ®ä¸Šçš„è¡¨ç°ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°è¿‡æ‹Ÿåˆï¼›</strong><br><strong>b) è¿˜å¯ä»¥ä»æœ‰é™çš„æ•°æ®ä¸­è·å–å°½å¯èƒ½å¤šçš„æœ‰æ•ˆä¿¡æ¯ã€‚</strong></p><p><strong>æ³¨æ„ï¼šäº¤å‰éªŒè¯ä½¿ç”¨çš„ä»…ä»…æ˜¯è®­ç»ƒé›†ï¼</strong></p><h2 id="7ã€åå·®ã€æ–¹å·®ã€å™ªå£°ä»¥åŠæ³›åŒ–è¯¯å·®"><a href="#7ã€åå·®ã€æ–¹å·®ã€å™ªå£°ä»¥åŠæ³›åŒ–è¯¯å·®" class="headerlink" title="7ã€åå·®ã€æ–¹å·®ã€å™ªå£°ä»¥åŠæ³›åŒ–è¯¯å·®"></a><strong>7ã€åå·®ã€æ–¹å·®ã€å™ªå£°ä»¥åŠæ³›åŒ–è¯¯å·®</strong></h2><h3 id="1-åå·®"><a href="#1-åå·®" class="headerlink" title="(1) åå·®"></a><strong>(1) åå·®</strong></h3><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1_3.png"><p><strong>åå·®biasï¼š æœŸæœ›é¢„æµ‹ä¸çœŸå®æ ‡è®°çš„è¯¯å·®ï¼Œåå·®è¶Šå¤§åç¦»ç†è®ºå€¼è¶Šå¤§ã€‚</strong></p><p><strong>ä¸Šé¢çš„ppté‡Œï¼Œå·¦è¾¹çš„å›¾æ¨¡å‹é˜¶æ•°å°ï¼Œæ‰€ä»¥ä¸å¯èƒ½å¾ˆå¥½çš„æ‹ŸåˆçœŸå®æƒ…å†µï¼Œæ‰€ä½œå‡ºçš„é¢„æµ‹ä¸çœŸå®æƒ…å†µåç¦»ç¨‹åº¦å¤§ï¼Œæ‰€ä»¥åå·®å°±å¤§ï¼›è€Œå³è¾¹çš„å›¾é‡Œæ¨¡å‹å¾ˆå¤æ‚ï¼Œè¶³å¤Ÿæ¨¡æ‹Ÿå‡ºçœŸå®æƒ…å†µï¼Œæ‰€ä»¥ä¸çœŸå®æƒ…å†µåç¦»ç¨‹åº¦å°ï¼Œåå·®å°±å°ã€‚</strong></p><p><strong>åœ¨ä¸€ä¸ªè®­ç»ƒé›†$D$ä¸Šæ¨¡å‹$f$å¯¹æµ‹è¯•æ ·æœ¬$x$é¢„æµ‹è¾“å‡ºä¸º$f(x;D)$, é‚£ä¹ˆå­¦ä¹ ç®—æ³•$f$å¯¹æµ‹è¯•æ ·æœ¬$x$çš„æœŸæœ›é¢„æµ‹ä¸ºï¼š</strong></p><p>$$<br>\bar{f}(x)=E_D[f(x;D)]<br>$$<br><strong>è¿™é‡Œç”¨åå·®çš„å¹³æ–¹æ¥è¡¨ç¤ºåå·®çš„è®¡ç®—å…¬å¼ï¼š</strong></p><p>$$<br>Bias^2(x)=(\bar{f}(x)-\hat{y})^2<br>$$</p><h3 id="2-æ–¹å·®"><a href="#2-æ–¹å·®" class="headerlink" title="(2) æ–¹å·®"></a><strong>(2) æ–¹å·®</strong></h3><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1_4.png"><p><strong>æ–¹å·®varianceï¼šé¢„æµ‹æ¨¡å‹çš„ç¦»æ•£ç¨‹åº¦ï¼Œæ–¹å·®è¶Šå¤§ç¦»æ•£ç¨‹åº¦è¶Šå¤§ã€‚</strong></p><p><strong>å°±åƒä¸Šé¢pptçš„å·¦å›¾ï¼Œå› ä¸ºæ¨¡å‹é˜¶æ•°å°ï¼Œæ‰€ä»¥æ¨¡å‹éƒ½å¾ˆé›†ä¸­ï¼›è€Œå³è¾¹çš„æ¨¡å‹é˜¶æ•°å¤§ï¼Œæœ‰æ—¶èƒ½æ‹Ÿåˆçš„å¾ˆå¥½ï¼Œæœ‰æ—¶æ‹Ÿåˆçš„ä¸å¥½ï¼Œä¸ç¨³å®šå› ç´ å¤ªå¤§äº†ã€‚</strong></p><p><strong>ä½¿ç”¨æ ·æœ¬æ•°ç›¸åŒçš„ä¸åŒè®­ç»ƒé›†äº§ç”Ÿçš„æ–¹å·®ä¸º:</strong></p><p>$$<br>var(x)=E_D[(f(x;D)-\bar{f}(x))^2]<br>$$</p><h3 id="3-å™ªå£°"><a href="#3-å™ªå£°" class="headerlink" title="(3) *å™ªå£°"></a><strong>(3) *å™ªå£°</strong></h3><p><strong>ä¸å¯èƒ½è€ƒ</strong></p><p><strong>å™ªå£°ä¸ºçœŸå®æ ‡è®°ä¸æ•°æ®é›†ä¸­çš„å®é™…æ ‡è®°é—´çš„åå·®$y_D$è¡¨ç¤ºåœ¨æ•°æ®é›†ä¸­çš„æ ‡è®°ï¼Œ$\hat{y}$è¡¨ç¤ºçœŸå®æ ‡è®°ï¼Œè¿™ä¸¤ä¸ªå¯èƒ½ä¸ç­‰ï¼‰ï¼š</strong></p><p>$$<br>\epsilon=E_D[(y_D-\hat{y})^2]<br>$$</p><h3 id="4-æ³›åŒ–è¯¯å·®"><a href="#4-æ³›åŒ–è¯¯å·®" class="headerlink" title="(4) *æ³›åŒ–è¯¯å·®"></a><strong>(4) *æ³›åŒ–è¯¯å·®</strong></h3><p><strong>ä¹Ÿä¸å¯èƒ½è€ƒ</strong></p><p><strong>å­¦ä¹ ç®—æ³•çš„é¢„æµ‹è¯¯å·®, æˆ–è€…è¯´æ³›åŒ–è¯¯å·®(generalization error)å¯ä»¥åˆ†è§£ä¸ºä¸‰ä¸ªéƒ¨åˆ†: åå·®(bias), æ–¹å·®(variance) å’Œå™ªå£°(noise). åœ¨ä¼°è®¡å­¦ä¹ ç®—æ³•æ€§èƒ½çš„è¿‡ç¨‹ä¸­, æˆ‘ä»¬ä¸»è¦å…³æ³¨åå·®ä¸æ–¹å·®ã€‚å› ä¸ºå™ªå£°å±äºä¸å¯çº¦å‡çš„è¯¯å·® (irreducible error)ã€‚</strong></p><p><strong>ä¸‹é¢æ¥ç”¨å…¬å¼æ¨å¯¼æ³›åŒ–è¯¯å·®ä¸åå·®ä¸æ–¹å·®, å™ªå£°ä¹‹é—´çš„å…³ç³»ã€‚</strong></p><p><strong>ä»¥å›å½’ä»»åŠ¡ä¸ºä¾‹, å­¦ä¹ ç®—æ³•çš„å¹³æ–¹é¢„æµ‹è¯¯å·®æœŸæœ›ä¸ºï¼š</strong></p><p>$$<br>Err(x)=E_D[(y_D-f(x;D))^2]<br>$$</p><p><strong>å¯¹ç®—æ³•çš„æœŸæœ›æ³›åŒ–è¯¯å·®è¿›è¡Œåˆ†è§£ï¼Œå°±ä¼šå‘ç° æ³›åŒ–è¯¯å·®=åå·®çš„å¹³æ–¹+æ–¹å·®+å™ªå£°:</strong></p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1_5.png"><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1_6.png"> <h2 id="8ã€æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ"><a href="#8ã€æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ" class="headerlink" title="8ã€æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ"></a><strong>8ã€æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ</strong></h2><p><strong>æ¬ æ‹Ÿåˆï¼šæ¨¡å‹æ‹Ÿåˆä¸å¤Ÿï¼Œåœ¨è®­ç»ƒé›†ä¸Šæ‹Ÿåˆæƒ…å†µå¾ˆå·®ã€‚å¾€å¾€ä¼šå‡ºç°åå·®å¤§ã€æ–¹å·®å°çš„æƒ…å†µï¼›</strong></p><p><strong>è¿‡æ‹Ÿåˆï¼šæ¨¡å‹è¿‡åº¦æ‹Ÿåˆï¼Œåœ¨è®­ç»ƒé›†ä¸Šæ‹Ÿåˆæƒ…å†µå¾ˆå¥½ï¼Œä½†æ˜¯åœ¨æµ‹è¯•é›†ä¸Šæ‹Ÿåˆæƒ…å†µå¾ˆå·®ã€‚å¾€å¾€ä¼šå‡ºç°åå·®å°ã€æ–¹å·®å¤§çš„æƒ…å†µã€‚</strong></p><p><strong>å‡ºç°æ¬ æ‹Ÿåˆæ—¶ï¼Œè§£å†³åŠæ³•æœ‰ï¼š</strong></p><p><strong>a) å¢åŠ æ–°ç‰¹å¾ï¼Œå¯ä»¥è€ƒè™‘åŠ å…¥ç‰¹å¾ç»„åˆã€é«˜æ¬¡ç‰¹å¾ï¼Œæ¥å¢å¤§å‡è®¾ç©ºé—´;</strong><br><strong>b) å°è¯•éçº¿æ€§æ¨¡å‹ï¼Œæ¯”å¦‚æ ¸SVM ã€å†³ç­–æ ‘ã€DNNç­‰æ¨¡å‹;</strong><br><strong>c) å¦‚æœæœ‰æ­£åˆ™é¡¹å¯ä»¥å‡å°æ­£åˆ™é¡¹å‚æ•°Î»ï¼›</strong><br><strong>d) Boostingï¼ŒBoosting å¾€å¾€ä¼šæœ‰è¾ƒå°çš„ Biasï¼Œæ¯”å¦‚ Gradient Boosting ç­‰ã€‚</strong></p><p><strong>å‡ºç°è¿‡æ‹Ÿåˆæ—¶ï¼Œè§£å†³åŠæ³•æœ‰ï¼š</strong></p><p><strong>a) äº¤å‰æ£€éªŒï¼Œé€šè¿‡äº¤å‰æ£€éªŒå¾—åˆ°è¾ƒä¼˜çš„æ¨¡å‹å‚æ•°;</strong><br><strong>b) ç‰¹å¾é€‰æ‹©ï¼Œå‡å°‘ç‰¹å¾æ•°æˆ–ä½¿ç”¨è¾ƒå°‘çš„ç‰¹å¾ç»„åˆï¼Œå¯¹äºæŒ‰åŒºé—´ç¦»æ•£åŒ–çš„ç‰¹å¾ï¼Œå¢å¤§åˆ’åˆ†çš„åŒºé—´;</strong><br><strong>c) æ­£åˆ™åŒ–ï¼Œå¸¸ç”¨çš„æœ‰ L1ã€L2 æ­£åˆ™ã€‚è€Œä¸” L1æ­£åˆ™è¿˜å¯ä»¥è‡ªåŠ¨è¿›è¡Œç‰¹å¾é€‰æ‹©;</strong><br><strong>d) å¦‚æœæœ‰æ­£åˆ™é¡¹åˆ™å¯ä»¥è€ƒè™‘å¢å¤§æ­£åˆ™é¡¹å‚æ•° Î»;</strong><br><strong>e) å¢åŠ è®­ç»ƒæ•°æ®å¯ä»¥æœ‰é™çš„é¿å…è¿‡æ‹Ÿåˆ;</strong><br><strong>f) Baggingï¼Œå°†å¤šä¸ªå¼±å­¦ä¹ å™¨Bagging ä¸€ä¸‹æ•ˆæœä¼šå¥½å¾ˆå¤šï¼Œæ¯”å¦‚éšæœºæ£®æ—ç­‰ã€‚</strong></p><h2 id="9ã€L1èŒƒæ•°å’ŒL2èŒƒæ•°"><a href="#9ã€L1èŒƒæ•°å’ŒL2èŒƒæ•°" class="headerlink" title="9ã€L1èŒƒæ•°å’ŒL2èŒƒæ•°"></a><strong>9ã€L1èŒƒæ•°å’ŒL2èŒƒæ•°</strong></h2><p><strong>æœ¬æ¥ä»¥ä¸ºä¼šå¾ˆå¿«å†™å®Œè¿™ä¸ªéƒ¨åˆ†çš„ï¼Œæ²¡æƒ³åˆ°è¿™é‡Œçš„çŸ¥è¯†ç‚¹çœ‹äº†ä¸€æ™šä¸Šï¼Œæ›´æ²¡æƒ³åˆ°è¿™é‡Œçš„çŸ¥è¯†å®Œå®Œæ•´æ•´æ‹¿å‡ºæ¥ï¼Œå®Œå…¨å¯ä»¥å†™ä¸€ç¯‡é•¿é•¿çš„åšæ–‡ã€‚å¦‚æœæƒ³å¥½å¥½å­¦ä¹ è¿™é‡Œçš„çŸ¥è¯†çš„è¯ï¼Œæˆ‘æ¨è<a href="https://blog.csdn.net/jinping_shi/article/details/52433975" target="_blank" rel="noopener">è¿™ä¸ªåšå®¢</a>ï¼Œæˆ–è€…æ˜¯å‘¨è€å¸ˆçš„è¥¿ç“œä¹¦ç¬¬252é¡µã€‚è¿™é‡Œæˆ‘å°±ä»‹ç»ä¸€ç‚¹æœ€åŸºæœ¬çš„çŸ¥è¯†äº†ã€‚</strong></p><p><strong>L1èŒƒæ•°ï¼šå‘é‡å…ƒç´ ç»å¯¹å€¼ä¹‹å’Œï¼Œå³ï¼š</strong></p><p>$$<br>\left | \theta \right |_1=\sum_{i=1}^{n}\left | \theta_i \right |<br>$$</p><p><strong>L2èŒƒæ•°ï¼šè¿™é‡Œæˆ‘æŸ¥äº†å¥½ä¹…çš„èµ„æ–™ï¼Œæˆ‘å‘ç°ç½‘ä¸Šæ‰€æœ‰çš„èµ„æ–™ï¼ŒåŒ…æ‹¬å‘¨è€å¸ˆçš„è¥¿ç“œä¹¦ä»¥åŠé‚±é”¡é¹æ•™æˆçš„ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹éƒ½æ˜¯è¯´ï¼ŒL2èŒƒæ•°æ˜¯å„ä¸ªå…ƒç´ çš„å¹³æ–¹å’Œå†æ±‚å¹³æ–¹æ ¹ï¼Œå³ï¼š</strong></p><p>$$<br>\left | \theta \right |_2=\sqrt{\sum_{i=1}^{n}\theta_i^2}<br>$$</p><p><strong>ä½†æ˜¯å´æ©è¾¾æ•™æˆã€æå®æ¯…æ•™æˆè¯¾ä¸Šè®²çš„ç‰ˆæœ¬ï¼Œä»¥åŠæˆ‘åœ¨å­¦æ ¡è¯¾ä¸Šï¼ˆæˆ‘ä»¬å­¦æ ¡çš„è¯¾ä¸å°±æ˜¯ç…§æ¬æå®æ¯…æ•™æˆçš„è¯¾å˜›ï¼‰æ‰€è®°å½•çš„ç‰ˆæœ¬ï¼Œéƒ½æ˜¯å†™çš„L2èŒƒæ•°ä¸ºå„ä¸ªå…ƒç´ çš„å¹³æ–¹å’Œï¼Œä¸å†æ±‚å¹³æ–¹æ ¹ï¼Œå³ï¼š</strong></p><p>$$<br>\left | \theta \right |_2=\sum_{i=1}^{n}\theta_i^2<br>$$</p><p><strong>å´æ©è¾¾æ•™æˆï¼š</strong></p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1_7.png"><p><strong>æå®æ¯…æ•™æˆï¼š</strong></p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1_8.png"><p><strong>æˆ‘çš„ç¬”è®°å°±ä¸æ‹¿å‡ºæ¥äº†ï¼Œå’Œå‰ä¸¤ä½çš„å·®ä¸å¤šã€‚åœ¨è¿™é‡Œæˆ‘è¿˜æ˜¯ä½¿ç”¨è¿™ä¸ªä¸å¼€æ ¹å·çš„ç‰ˆæœ¬ã€‚</strong></p><h3 id="1-L1èŒƒæ•°çš„ä½œç”¨"><a href="#1-L1èŒƒæ•°çš„ä½œç”¨" class="headerlink" title="(1) L1èŒƒæ•°çš„ä½œç”¨"></a><strong>(1) L1èŒƒæ•°çš„ä½œç”¨</strong></h3><p><strong>L1èŒƒæ•°å¯ä»¥äº§ç”Ÿç¨€ç–æƒå€¼çŸ©é˜µï¼Œä¸€å®šç¨‹åº¦ä¸Šä¹Ÿå¯ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚</strong></p><p><strong>ç¨€ç–æƒå€¼çŸ©é˜µçš„æ„æ€æ˜¯ï¼Œè¿™ä¸ªçŸ©é˜µä¸­å¤§éƒ¨åˆ†å…ƒç´ éƒ½æ˜¯0ï¼Œåªæœ‰å¾ˆå°ä¸€éƒ¨åˆ†å…ƒç´ ä¸ä¸º0ã€‚è¯•æƒ³ä¸€ä¸‹å½“æˆ‘ä»¬åœ¨çœ‹å‘¨æ°ä¼¦æ¼”å”±ä¼šæ—¶ï¼Œåªä¼šæŠŠæ³¨æ„åŠ›æ”¾åœ¨å‘¨è‘£èº«ä¸Šï¼Œä¸å¤ªä¼šå…³æ³¨ä¼´èˆå°å§å§ï¼Œæ›´ä¸å¯èƒ½å»å…³æ³¨æ—è¾¹åˆçŸ®åˆèƒ–çš„éŸ³å“ï¼ˆè¿™ä¸€å¥è€ƒè¯•åˆ«å†™ï¼‰ã€‚è€Œåœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸä¹Ÿä¸€æ ·ï¼Œä¼ è¿›æ¥ä¸€å¼ å›¾ç‰‡ï¼Œè¿™ä¸ªå›¾ç‰‡æœ‰å¾ˆå¤šå¾ˆå¤šçš„åƒç´ ï¼Œä½†æ˜¯æœºå™¨çœŸæ­£è¦å…³æ³¨çš„åªæœ‰å…¶ä¸­ä¸€éƒ¨åˆ†å…ƒç´ ï¼Œæ¯”å¦‚ä¸€å¼ ç”°åœ°é‡Œçš„å†œæ°‘ï¼Œæˆ–æ˜¯è‰åœ°é‡Œçš„ç‹—ç‹—ä¹‹ç±»çš„ï¼Œå…¶ä»–ä¸é‡è¦çš„ä¿¡æ¯å°±ç›´æ¥ä¸çœ‹äº†ï¼Œæ‰€ä»¥å’Œä¸»é¢˜æ— å…³çš„ä¿¡æ¯éƒ½ä¼šä¹˜ä¸Š0ï¼Œæœ‰æ„ä¹‰çš„ä¿¡æ¯æ‰ä¼šä¿ç•™ã€‚è‡ªç„¶è¯­è¨€å¤„ç†ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæœ‰å¾ˆå¤šæ— æ„ä¹‰çš„è¯éƒ½ä¼šä¹˜ä¸Š0ï¼ŒåªæŒ‘é€‰æœ‰æ„ä¹‰çš„ä¿¡æ¯ä¿ç•™ä¸‹æ¥ã€‚å…³äºå…·ä½“æ€ä¹ˆå®ç°çš„ä¸è®²äº†ï¼Œå»çœ‹å‘¨è€å¸ˆçš„è¥¿ç“œä¹¦å§ã€‚</strong></p><h3 id="2-L2èŒƒæ•°çš„ä½œç”¨"><a href="#2-L2èŒƒæ•°çš„ä½œç”¨" class="headerlink" title="(2) L2èŒƒæ•°çš„ä½œç”¨"></a><strong>(2) L2èŒƒæ•°çš„ä½œç”¨</strong></h3><p><strong>L2èŒƒæ•°ä¸»è¦ç”¨äºé˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆã€‚</strong></p><p><strong>L2èŒƒæ•°æ¯”è¾ƒé‡è¦ä¸€ç‚¹ï¼ŒL2èŒƒæ•°çš„ä½œç”¨æ˜¯æƒå€¼è¡°å‡ï¼Œç¼©å°å„ä¸ªæƒå€¼ï¼Œä½¿å¾—å‡½æ•°å°½å¯èƒ½æ¯”ä¸åŠ L2èŒƒæ•°å¹³æ»‘å¾ˆå¤šï¼Œå¢å¤§æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚å¦‚æœæŸå¤±å‡½æ•°åŠ ä¸ŠL2èŒƒæ•°åï¼Œæ˜¯è¿™æ ·ï¼š</strong></p><p>$$<br>L(\theta) = \frac{1}{2m}[\sum_{i=1}^{m}(h_{\theta}(x^{(i)}) - \hat{y}^{(i)})^2 + \lambda\sum_{j=1}^{n}\theta_j^2]<br>$$</p><p><strong>å½“ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ—¶ï¼Œå¾—å‡ºçš„å¼å­æ˜¯è¿™æ ·çš„ï¼š</strong><br>$$<br>\theta_jâ€™ \leftarrow (1-\eta\frac{\lambda}{m})\theta_j - \eta\frac{1}{m} \sum_{i=1}^{m}(h_{\theta}(x^{(i)}) - \hat{y}^{(i)})x^{(i)}<br>$$</p><p><strong>æ¯æ¬¡å‚æ•°æ›´æ–°æ—¶ï¼Œéƒ½è¦å…ˆæŠŠåŸæ¥çš„å‚æ•°ä¹˜ä¸Šä¸€ä¸ªä»‹äº0å’Œ1çš„æ•°ï¼Œæ‰€ä»¥å‚æ•°éƒ½ä¼šå…ˆç¼©å°ä¸€ç‚¹ç‚¹ï¼Œå†è¿›è¡Œæ›´æ–°ã€‚ä¸€èˆ¬æ¥è¯´$1-\eta\frac{\lambda}{m}$éƒ½ä¼šæ˜¯ä¸€ä¸ªå¾ˆæ¥è¿‘1çš„æ•°ï¼Œåˆ«çœ‹ä¸€ä¸ªæ•°æ‰“ä¹ä¹æŠ˜åæ²¡ä»€ä¹ˆå˜åŒ–ï¼Œå¯æ˜¯è¿­ä»£æ¬¡æ•°å¤šäº†åï¼Œè¿™ä¸ªæƒå€¼æ˜¯ä¼šè¡°å‡çš„å¾ˆä¸¥é‡çš„ã€‚é€šè¿‡è¿™ç§æ–¹æ³•ä¼šæœ‰æ•ˆé™ä½æƒå€¼ï¼Œä½¿å¾—å‡½æ•°æ›´ä¸ºå¹³æ»‘ï¼Œä½¿å¾—æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›æ›´å¼ºã€‚</strong></p><h2 id="10ã€ä¼˜åŒ–æŠ€å·§"><a href="#10ã€ä¼˜åŒ–æŠ€å·§" class="headerlink" title="10ã€ä¼˜åŒ–æŠ€å·§"></a><strong>10ã€ä¼˜åŒ–æŠ€å·§</strong></h2><p><strong>è®­ç»ƒé›†ä¸­å¸¸å¸¸æœ‰äº›ç‰¹å¾çš„èŒƒå›´å·®åˆ«å¾ˆå¤§ï¼Œè¿™æ ·ä¼šå¯¼è‡´åœ¨ä¼˜åŒ–æ—¶ï¼Œä¸åŒçš„å‚æ•°ä¼˜åŒ–é€Ÿåº¦å·®åˆ«å¾ˆå¤§ã€‚æ¯”å¦‚æˆ¿å­çš„å¤§å°ä»10~2000å¹³ç±³éƒ½æœ‰å¯èƒ½ï¼Œè€Œæˆ¿é—´æ•°åªèƒ½å¤„åœ¨1~10è¿™ä¸ªèŒƒå›´å†…ï¼Œåœ¨è¿›è¡Œä¼˜åŒ–æ—¶ï¼Œæˆ¿é—´æ•°çš„å‚æ•°å¾ˆå¿«å°±æ‰¾åˆ°äº†æœ€ä½ç‚¹ï¼Œè€Œæˆ¿å­å¤§å°çš„å‚æ•°è¿˜ç¦»æœ€ä½ç‚¹å¾ˆè¿œï¼Œè¿™æ ·çš„è¯ï¼Œæˆ¿é—´æ•°çš„å‚æ•°å°±åœ¨æœ€ä½ç‚¹æ¥å›æ³¢åŠ¨ï¼Œç­‰å¾…æˆ¿å­å¤§å°çš„å‚æ•°ä¼˜åŒ–å¥½ã€‚å¦‚æœèƒ½å°½é‡è®©æ‰€æœ‰å‚æ•°åŒæ—¶ä¼˜åŒ–å¥½ï¼Œé‚£ä¹ˆä¼šå¤§å¤§æé«˜ä¼˜åŒ–é€Ÿåº¦ã€‚</strong></p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1_ä¼˜åŒ–.png"><h3 id="1-Feature-Scaling-ç‰¹å¾ç¼©æ”¾-å½’ä¸€åŒ–"><a href="#1-Feature-Scaling-ç‰¹å¾ç¼©æ”¾-å½’ä¸€åŒ–" class="headerlink" title="(1) Feature Scaling - ç‰¹å¾ç¼©æ”¾/å½’ä¸€åŒ–"></a><strong>(1) Feature Scaling - ç‰¹å¾ç¼©æ”¾/å½’ä¸€åŒ–</strong></h3><p><strong>å½’ä¸€åŒ–çš„æ€è·¯æ˜¯ï¼šè®©è¾“å…¥çš„å€¼å‡å»æ ·æœ¬ä¸­æœ€å°çš„å€¼ï¼Œç„¶åé™¤ä»¥æ ·æœ¬èŒƒå›´ï¼ˆä¹Ÿå°±æ˜¯æ ·æœ¬æœ€å¤§å€¼å‡å»æ ·æœ¬æœ€å°å€¼ï¼‰ï¼Œè¿™æ ·ä¼šä½¿å¾—ç»“æœæ°¸è¿œåœ¨0~1çš„èŒƒå›´å†…ï¼Œæ‰€æœ‰ç‰¹å¾å‚æ•°å·®ä¸å¤šä¸€ä¸ªé€Ÿåº¦ä¼˜åŒ–åˆ°æœ€ä½ç‚¹ã€‚å¼å­å¦‚ä¸‹ï¼š</strong></p><p>$$<br>xâ€™=\frac{x-min}{max-min}<br>$$</p><h3 id="2-Mean-Normalization-å‡å€¼æ ‡å‡†åŒ–"><a href="#2-Mean-Normalization-å‡å€¼æ ‡å‡†åŒ–" class="headerlink" title="(2) Mean Normalization - å‡å€¼æ ‡å‡†åŒ–"></a><strong>(2) Mean Normalization - å‡å€¼æ ‡å‡†åŒ–</strong></h3><p><strong>å‡å€¼æ ‡å‡†åŒ–çš„æ€è·¯æ˜¯ï¼šè®©è¾“å…¥çš„å€¼å‡å»æ ·æœ¬å¹³å‡æ•°Î¼ï¼Œå†é™¤ä»¥æ ·æœ¬æ ‡å‡†å·®Ïƒã€‚ç»è¿‡è¿™æ ·çš„å¤„ç†ï¼Œæ•°æ®çš„å‡å€¼ä¼šæ˜¯0ï¼Œå¤§å°åœ¨-1~1ä¹‹é—´ã€‚å‡å€¼æ ‡å‡†åŒ–å’Œå½’ä¸€åŒ–ä¸€æ ·ï¼Œä¹Ÿæœ‰å»é™¤ä¸åŒç‰¹å¾é‡çº²ä¸åŒçš„é—®é¢˜ï¼Œå¦å¤–æœºå™¨å­¦ä¹ ä¸­å¾ˆå¤šå‡½æ•°å¦‚Sigmoidã€Tanhã€Softmaxç­‰éƒ½ä»¥0ä¸ºä¸­å¿ƒå·¦å³åˆ†å¸ƒï¼Œæ‰€ä»¥æ•°æ®ä»¥0ä¸ºä¸­å¿ƒå·¦å³åˆ†å¸ƒä¼šå¸¦æ¥å¾ˆå¤šä¾¿åˆ©ã€‚</strong><br>$$<br>{x}â€™=\frac{x-\mu}{\sigma}<br>$$</p><h2 id="11ã€æ€ä¹ˆè°ƒèŠ‚å­¦ä¹ ç‡"><a href="#11ã€æ€ä¹ˆè°ƒèŠ‚å­¦ä¹ ç‡" class="headerlink" title="11ã€æ€ä¹ˆè°ƒèŠ‚å­¦ä¹ ç‡"></a><strong>11ã€æ€ä¹ˆè°ƒèŠ‚å­¦ä¹ ç‡</strong></h2><p><strong>å½“æˆ‘ä»¬åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå‘ç°lossä¸‹é™çš„å¾ˆæ…¢æ—¶ï¼Œå¯ä»¥é€‚å½“å¢å¤§å­¦ä¹ ç‡ï¼›å‘ç°lossä¸é™åå¢çš„æ—¶å€™ï¼Œè¦é™ä½å­¦ä¹ ç‡ã€‚</strong></p><p><strong>å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯Adagradç®—æ³•ï¼Œé‚£ä¹ˆä¸€å¼€å§‹å­¦ä¹ ç‡å¯ä»¥è®¾ç½®çš„ç›¸å¯¹å¤§ä¸€ç‚¹ã€‚</strong></p><h2 id="12ã€é€»è¾‘å›å½’çš„å±€é™æ€§-æ·±åº¦ç¥ç»ç½‘ç»œçš„å…´èµ·å¯¼ç«ç´¢"><a href="#12ã€é€»è¾‘å›å½’çš„å±€é™æ€§-æ·±åº¦ç¥ç»ç½‘ç»œçš„å…´èµ·å¯¼ç«ç´¢" class="headerlink" title="12ã€é€»è¾‘å›å½’çš„å±€é™æ€§ - æ·±åº¦ç¥ç»ç½‘ç»œçš„å…´èµ·å¯¼ç«ç´¢"></a><strong>12ã€é€»è¾‘å›å½’çš„å±€é™æ€§ - æ·±åº¦ç¥ç»ç½‘ç»œçš„å…´èµ·å¯¼ç«ç´¢</strong></h2><p><strong>é€»è¾‘å›å½’ä¸å¯ä»¥ç›´æ¥å¤„ç†çº¿æ€§ä¸å¯åˆ†çš„é—®é¢˜ï¼Œä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å¼‚æˆ–é—®é¢˜ã€‚å¤„ç†æ–¹æ³•æ˜¯å…ˆé€šè¿‡ä¸€ä¸ªå‡½æ•°ï¼Œå°†åŸæ¥çš„å€¼æŠ•å½±è½¬æ¢ï¼Œå˜æˆçº¿æ€§å¯åˆ†é—®é¢˜ï¼Œå†ä½¿ç”¨é€»è¾‘å›å½’æ¥å¤„ç†ã€‚è¿™ä¸€æ­¥å«åšç‰¹å¾å˜æ¢ï¼Œå…ˆè¿›è¡Œç‰¹å¾å˜æ¢ï¼Œå†è¿›è¡Œé€»è¾‘å›å½’ï¼Œè¿™å°±æ˜¯ä¸¤å±‚ç¥ç»ç½‘ç»œçš„é›å½¢ï¼Œä¹Ÿæ˜¯ç¥ç»ç½‘ç»œçš„å…´èµ·çš„å¯¼ç«ç´¢ã€‚</strong></p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/1æ·±åº¦å­¦ä¹ å¯¼ç«ç´¢.jpg">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åŸºäºTensorFlowçš„CAPTCHAæ³¨å†Œç è¯†åˆ«å®éªŒ</title>
      <link href="/2019/03/27/%E5%9F%BA%E4%BA%8ETensorFlow%E7%9A%84CAPTCHA%E6%B3%A8%E5%86%8C%E7%A0%81%E8%AF%86%E5%88%AB%E5%AE%9E%E9%AA%8C/"/>
      <url>/2019/03/27/%E5%9F%BA%E4%BA%8ETensorFlow%E7%9A%84CAPTCHA%E6%B3%A8%E5%86%8C%E7%A0%81%E8%AF%86%E5%88%AB%E5%AE%9E%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<ul><li><p>å®éªŒä»»åŠ¡ï¼šä½¿ç”¨TensorFlowå®ç°CAPTCHAæ³¨å†Œç çš„è¯†åˆ«</p></li><li><p>åŸºæœ¬æ€è·¯ï¼šé‡‡ç”¨ Captcha åº“ç”ŸæˆéªŒè¯ç ï¼Œå°†éªŒè¯ç è¯†åˆ«é—®é¢˜è½¬åŒ–ä¸ºåˆ†ç±»é—®é¢˜ï¼Œé‡‡ç”¨ CNN ç½‘ç»œæ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œæœ€ç»ˆå®ç°å¯¹éªŒè¯ç çš„ç ´è§£ã€‚</p></li><li><p>å®éªŒæ­¥éª¤ï¼šè·å–éªŒè¯ç è®­ç»ƒé›† â†’ æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œå’Œå…¨è¿æ¥ç¥ç»ç½‘ç»œ â†’ å®šä¹‰æŸå¤±å‡½æ•°ä»¥åŠä¼˜åŒ–æ–¹å¼ â†’ è¿›è¡Œè®­ç»ƒå¹¶ä¿å­˜è®­ç»ƒç»“æœã€‚</p></li></ul><h2 id="è·å–éªŒè¯ç è®­ç»ƒé›†"><a href="#è·å–éªŒè¯ç è®­ç»ƒé›†" class="headerlink" title="è·å–éªŒè¯ç è®­ç»ƒé›†"></a>è·å–éªŒè¯ç è®­ç»ƒé›†</h2><p>ä½¿ç”¨captchaåº“æ¥ç”ŸæˆéªŒè¯ç ï¼Œcaptchaåº“å¯ä»¥ä½¿ç”¨anacondaå¾ˆè½»æ¾ä¸‹è½½ï¼Œcaptchaåº“ä¸ä»…å¯ä»¥ç”¨äºç”Ÿæˆå›¾ç‰‡éªŒè¯ç ï¼Œè¿˜å¯ä»¥ç”¨æ¥ç”Ÿæˆè¯­éŸ³éªŒè¯ç ã€‚</p><ol><li>æˆ‘ä»¬å°†ImageCaptchaç±»å®ä¾‹åŒ–ä¸ºimageå¯¹è±¡ï¼Œæ„é€ å‡½æ•°çš„å‚æ•°é‡ŒæŒ‡å®šå®½åº¦å’Œé«˜åº¦ã€‚</li></ol><p>image = ImageCaptcha(width=self.width, height=self.height)</p><ol start="2"><li><p>å­˜å‚¨è®­ç»ƒæ•°æ®ã€‚</p><p>æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªçŸ©é˜µXå’ŒYç”¨ä»¥è¡¨ç¤ºè®­ç»ƒé›†çš„è¾“å…¥éƒ¨åˆ†å’Œè¾“å‡ºéƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯éªŒè¯ç çš„å›¾ç‰‡æ•°æ®å­˜å‚¨ä»¥åŠéªŒè¯ç ä¸Šæ‰€å†™çš„å†…å®¹å­˜å‚¨ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X = np.zeros([batch_size, self.height, self.width, <span class="number">1</span>])</span><br><span class="line">Y = np.zeros([batch_size, self.char_num, self.classes])</span><br></pre></td></tr></table></figure></div><p>è¿™ä¸¤ä¸ªçŸ©é˜µçš„ç¬¬ä¸€ç»´å‚æ•°éƒ½æ˜¯batch_sizeï¼Œè¡¨ç¤ºè¿™ä¸€ç»„è®­ç»ƒé›†çš„ä¸ªæ•°ã€‚</p><p>Xçš„ç¬¬äºŒå’Œç¬¬ä¸‰ä½å‚æ•°åˆ†åˆ«è¡¨ç¤ºéªŒè¯ç çš„é«˜åº¦å’Œå®½åº¦ï¼Œæœ€åä¸€ä¸ªå‚æ•°è¡¨ç¤ºè¿™æ˜¯1é€šé“çš„é»‘ç™½å›¾ç‰‡ã€‚</p><p>Yçš„ç¬¬äºŒä½å‚æ•°è¡¨ç¤ºæ­¤éªŒè¯ç ä¸Šå†™äº†å‡ ä¸ªå­—ç¬¦ï¼Œç¬¬ä¸‰ä½å‚æ•°è¡¨ç¤ºæ¯ä¸ªå­—ç¬¦å…±æœ‰å¤šå°‘ç§é€‰æ‹©ï¼Œè¿™æ˜¯ä¸€æ¡é•¿ä¸ºself.classesçš„å‘é‡ï¼Œä»¥ç‹¬çƒ­ç¼–ç çš„å½¢å¼è®°å½•ä¿¡æ¯ã€‚</p></li><li><p>ç”ŸæˆéªŒè¯ç </p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(batch_size):</span><br><span class="line">        captcha_str = <span class="string">''</span>.join(random.sample(self.characters, self.char_num))</span><br><span class="line">        img = image.generate_image(captcha_str).convert(<span class="string">'L'</span>)</span><br><span class="line">        img = np.array(img.getdata())</span><br><span class="line">        X[i] = np.reshape(img, [self.height, self.width, <span class="number">1</span>]) / <span class="number">255.0</span></span><br><span class="line">        <span class="keyword">for</span> j, ch <span class="keyword">in</span> enumerate(captcha_str):</span><br><span class="line">            Y[i, j, self.characters.find(ch)] = <span class="number">1</span></span><br><span class="line">    Y = np.reshape(Y, (batch_size, self.char_num * self.classes))</span><br><span class="line">    <span class="keyword">yield</span> X, Y</span><br></pre></td></tr></table></figure></div><p>é¦–å…ˆï¼Œè¿™ä¸ªæ€»ä½“çš„æ— é™å¾ªç¯æ˜¯ä¸€ä¸ªè®­ç»ƒé›†çš„ç”Ÿæˆå™¨ï¼Œæ‰§è¡Œæ­¤ä»£ç åï¼Œä¼šåœ¨æœ€åçš„yieldè¯­å¥è¿”å›è®­ç»ƒé›†Xå’ŒYï¼Œç„¶åå¾ªç¯ç»“æŸã€‚ä¸‹æ¬¡å†æƒ³ç”ŸæˆéªŒè¯ç è®­ç»ƒé›†æ—¶ï¼Œä¼šä»yieldè¯­å¥ï¼ˆæœ€åä¸€å¥ï¼‰å¼€å§‹ï¼Œå›åˆ°å¼€å¤´å†æ‰§è¡Œä¸€æ¬¡å¾ªç¯ã€‚</p><p>è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä»¥å‰éƒ½æ˜¯å°†æ‰€æœ‰çš„è®­ç»ƒæ•°æ®å…¨éƒ¨å‡†å¤‡å¥½ï¼Œç„¶åæ‰‹åŠ¨åˆ†å‡ºå¾ˆå¤šbatchï¼Œä¸€ä¸ªä¸€ä¸ªçš„è®­ç»ƒï¼Œè¿™æ ·çš„è¯è¦æ±‚æŠŠæ‰€æœ‰çš„è®­ç»ƒæ•°æ®å…¨éƒ¨è£…å…¥å†…å­˜ï¼Œå¾ˆæµªè´¹å†…å­˜ç©ºé—´ã€‚è€Œä½¿ç”¨è¿™ç§ç”Ÿæˆå™¨è¯­å¥ï¼Œå¦‚æœæˆ‘è®­ç»ƒå“ªä¸€ä¸ªbatchçš„æ•°æ®ï¼Œå°±ç«‹å³ç”Ÿæˆæ•°æ®å¹¶è£…å…¥å†…å­˜ï¼Œç”¨å®Œå†æ’¤å‡ºå†…å­˜ï¼Œç´§æ¥ç€è®­ç»ƒä¸‹ä¸€ä¸ªbatchçš„æ•°æ®æ—¶ï¼Œå†ç«‹å³ç”Ÿæˆç„¶åå°†å…¶è£…å…¥å†…å­˜ã€‚åˆ†æ‰¹è£…å…¥å†…å­˜ï¼ŒèŠ‚çœäº†å¤§é‡çš„å†…å­˜ç©ºé—´ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">random.sample(self.characters, self.char_num)</span><br></pre></td></tr></table></figure></div><p>æ­¤ä»£ç ç”Ÿæˆä¸€ä¸ªéªŒè¯ç å­—ç¬¦ä¸²çš„éšæœºå˜é‡ï¼Œself.charactersä¸º62ä½çš„å­—ç¬¦ä¸²ï¼ˆ0~9A~Za~zï¼‰ï¼Œself.char_num=4ï¼ˆç”Ÿæˆ4ä¸ªå­—ç¬¦ï¼‰ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">img = image.generate_image(captcha_str).convert(<span class="string">'L'</span>)</span><br></pre></td></tr></table></figure></div><p>è¿™å¥ä»£ç ä½¿ç”¨çš„æ˜¯ImageCaptchaç±»çš„å†…ç½®æ–¹æ³•ï¼Œå°†å­—ç¬¦ä¸²å˜ä¸ºå›¾ç‰‡ã€‚convert(â€˜Lâ€™)ï¼šè¡¨ç¤ºç”Ÿæˆçš„æ˜¯ç°åº¦å›¾ç‰‡ï¼Œå°±æ˜¯é€šé“æ•°ä¸º1çš„é»‘ç™½å›¾ç‰‡ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X[i] = np.reshape(img, [self.height, self.width, <span class="number">1</span>]) / <span class="number">255.0</span></span><br></pre></td></tr></table></figure></div><p>æ¯ä¸ªåƒç´ å€¼éƒ½è¦é™¤ä»¥255ï¼Œè¿™æ˜¯ä¸ºäº†å½’ä¸€åŒ–å¤„ç†ï¼Œå› ä¸ºç°åº¦çš„èŒƒå›´æ˜¯0~255ï¼Œè¿™é‡Œé™¤ä»¥255å°±è®©æ¯ä¸ªåƒç´ çš„å€¼åœ¨0~1ä¹‹é—´ï¼Œç›®çš„æ˜¯ä¸ºäº†åŠ å¿«æ”¶æ•›é€Ÿåº¦ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> j, ch <span class="keyword">in</span> enumerate(captcha_str):</span><br><span class="line">    Y[i, j, self.characters.find(ch)] = <span class="number">1</span></span><br></pre></td></tr></table></figure></div><p>è¿™é‡Œç”¨ä»¥ç”Ÿæˆå¯¹åº”çš„æµ‹è¯•é›†Yï¼Œjå’Œchç”¨ä»¥éå†åˆšåˆšç”Ÿæˆçš„éšæœºå­—ç¬¦ä¸²ï¼Œjè®°å½•indexï¼ˆ0~3ï¼Œè¡¨ç¤ºç¬¬å‡ ä¸ªå­—ç¬¦ï¼‰ï¼Œchè®°å½•å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ã€‚æ‰¾åˆ°Yçš„ç¬¬iæ¡æ•°æ®ä¸­çš„ç¬¬jä¸ªå­—ç¬¦ï¼Œç„¶åæŠŠ62é•¿åº¦çš„å‘é‡å’Œchç›¸å…³çš„é‚£ä¸ªç½®ä¸º1ã€‚</p></li></ol><h2 id="æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œå’Œå…¨è¿æ¥ç¥ç»ç½‘ç»œ"><a href="#æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œå’Œå…¨è¿æ¥ç¥ç»ç½‘ç»œ" class="headerlink" title="æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œå’Œå…¨è¿æ¥ç¥ç»ç½‘ç»œ"></a>æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œå’Œå…¨è¿æ¥ç¥ç»ç½‘ç»œ</h2><ol><li><p>conv2D</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">conv2d</span><span class="params">(self, x, W)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> tf.nn.conv2d(x, W, strides=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=<span class="string">'SAME'</span>)</span><br></pre></td></tr></table></figure></div><p>è¿™æ˜¯2ç»´å·ç§¯å‡½æ•°ã€‚xè¡¨ç¤ºä¼ å…¥çš„å¾…å¤„ç†å›¾ç‰‡ï¼ŒWè¡¨ç¤ºå·ç§¯æ ¸ï¼Œstrides=[1, 1, 1, 1]ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ª1åˆ†åˆ«è¡¨ç¤ºxæ–¹å‘æ­¥é•¿å’Œyæ–¹å‘æ­¥é•¿ï¼Œpadding=â€™SAMEâ€™è¡¨ç¤ºè¾¹ç•Œå¤„ç†ç­–ç•¥è®¾ä¸ºâ€™SAMEâ€™ï¼Œè¿™æ ·å·ç§¯å¤„ç†å®Œå›¾ç‰‡å¤§å°ä¸å˜ã€‚</p></li></ol><ol start="2"><li><p>max_pool_2x2</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">max_pool_2x2</span><span class="params">(self, x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> tf.nn.max_pool(x, ksize=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], strides=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], padding=<span class="string">'SAME'</span>)</span><br></pre></td></tr></table></figure></div><p>è¿™æ˜¯2x2æœ€å¤§å€¼æ± åŒ–å‡½æ•°ã€‚xè¡¨ç¤ºå¾…è¢«æ± åŒ–å¤„ç†çš„å›¾ç‰‡ï¼Œksize=[1, 2, 2, 1]ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ª2åˆ†åˆ«è¡¨ç¤ºæ± åŒ–çª—å£é«˜åº¦å’Œæ± åŒ–çª—å£å®½åº¦ï¼Œstrideså’Œpaddingæ„ä¹‰åŒä¸Šã€‚</p></li><li><p>weight_variable</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">weight_variable</span><span class="params">(self, shape)</span>:</span></span><br><span class="line">    initial = tf.truncated_normal(shape, stddev=<span class="number">0.1</span>)</span><br><span class="line">    <span class="keyword">return</span> tf.Variable(initial)</span><br></pre></td></tr></table></figure></div><p>è¿™å°±æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„å‡½æ•°äº†ï¼Œç”¨è¿™ä¸ªå‡½æ•°çš„ç›®çš„æ˜¯ä»<strong>æˆªæ–­</strong>çš„æ­£æ€åˆ†å¸ƒä¸­è¾“å‡ºéšæœºå€¼ã€‚å¬ç€åå­—å°±ä¸çŸ¥é“æ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹æ­£å¤ªåˆ†å¸ƒçš„ä¸€ä¸ªæ€§è´¨ï¼š</p><p>åœ¨æ­£æ€åˆ†å¸ƒçš„æ›²çº¿ä¸­ï¼Œæ¨ªè½´åŒºé—´ï¼ˆÎ¼-Ïƒï¼ŒÎ¼+Ïƒï¼‰å†…çš„é¢ç§¯ä¸º68.268949%ã€‚</p><p>æ¨ªè½´åŒºé—´ï¼ˆÎ¼-2Ïƒï¼ŒÎ¼+2Ïƒï¼‰å†…çš„é¢ç§¯ä¸º95.449974%ã€‚</p><p>æ¨ªè½´åŒºé—´ï¼ˆÎ¼-3Ïƒï¼ŒÎ¼+3Ïƒï¼‰å†…çš„é¢ç§¯ä¸º99.730020%ã€‚</p><p>Xè½åœ¨ï¼ˆÎ¼-3Ïƒï¼ŒÎ¼+3Ïƒï¼‰ä»¥å¤–çš„æ¦‚ç‡å°äºåƒåˆ†ä¹‹ä¸‰ï¼Œåœ¨å®é™…é—®é¢˜ä¸­å¸¸è®¤ä¸ºç›¸åº”çš„äº‹ä»¶æ˜¯ä¸ä¼šå‘ç”Ÿçš„ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥æŠŠåŒºé—´ï¼ˆÎ¼-3Ïƒï¼ŒÎ¼+3Ïƒï¼‰çœ‹ä½œæ˜¯éšæœºå˜é‡Xå®é™…å¯èƒ½çš„å–å€¼åŒºé—´ï¼Œè¿™ç§°ä¹‹ä¸ºæ­£æ€åˆ†å¸ƒçš„â€œ3Ïƒâ€åŸåˆ™ã€‚</p><img src="http://pp41mkw5b.bkt.clouddn.com/static/images/captcha_1.jpg"><p>è€Œä»<strong>æˆªæ–­</strong>çš„æ­£æ€åˆ†å¸ƒä¸­è¾“å‡ºéšæœºå€¼çš„æ„æ€å°±æ˜¯ï¼ŒåŒæ ·ä¹Ÿæ˜¯éšæœºç”Ÿæˆçš„å€¼ï¼Œä½†æ˜¯ç”Ÿæˆçš„å€¼å¿…é¡»æœä»å…·æœ‰æŒ‡å®šå¹³å‡å€¼å’Œæ ‡å‡†åå·®çš„æ­£æ€åˆ†å¸ƒï¼Œå¦‚æœç”Ÿæˆçš„å€¼å¤§äºå¹³å‡å€¼2ä¸ªæ ‡å‡†åå·®çš„å€¼åˆ™ä¸¢å¼ƒé‡æ–°é€‰æ‹©ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯å¦‚æœéšæœºç”Ÿæˆçš„å€¼å¦‚æœè½åœ¨äº†(Î¼-2Ïƒ,Î¼+2Ïƒ)ä¹‹å¤–ï¼Œå°±é‡æ–°ç”Ÿæˆå€¼ï¼Œè¿™æ ·å°±ä¿è¯äº†éšæœºç”Ÿæˆçš„å€¼éƒ½åœ¨å‡å€¼é™„è¿‘ã€‚</p><p>æ‰¯äº†è¿™ä¹ˆå¤šï¼Œå…¶å®å°±æ˜¯éšæœºç”Ÿæˆä¸€ç»„æ•°ï¼Œè¦æ±‚ä¸è¦ç¦»ä¸­å¿ƒç‚¹Î¼å¤ªè¿œã€‚</p></li><li><p>bias_variable</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bias_variable</span><span class="params">(self, shape)</span>:</span></span><br><span class="line">    initial = tf.constant(<span class="number">0.1</span>, shape=shape)</span><br><span class="line">    <span class="keyword">return</span> tf.Variable(initial)</span><br></pre></td></tr></table></figure></div><p>ç”Ÿæˆä¸€ç»„å…¨éƒ¨éƒ½æ˜¯0.1çš„å¸¸é‡æ•°ï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚</p></li><li><p>æ„å»ºç¬¬ä¸€å±‚å·ç§¯ç¥ç»ç½‘ç»œ</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">w_conv1 = self.weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">32</span>])</span><br><span class="line">b_conv1 = self.bias_variable([<span class="number">32</span>])</span><br><span class="line">h_conv1 = tf.nn.relu(tf.nn.bias_add(self.conv2d(x_images, w_conv1), b_conv1))</span><br><span class="line">h_pool1 = self.max_pool_2x2(h_conv1)</span><br><span class="line">h_dropout1 = tf.nn.dropout(h_pool1, keep_prob)</span><br><span class="line">conv_width = math.ceil(self.width / <span class="number">2</span>)</span><br><span class="line">conv_height = math.ceil(self.height / <span class="number">2</span>)</span><br></pre></td></tr></table></figure></div><p>w_conv1æ˜¯å·ç§¯æ ¸ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€å…±æœ‰32ä¸ªå·ç§¯æ ¸ï¼Œæ¯ä¸ªå·ç§¯æ ¸çš„å°ºå¯¸æ˜¯(5, 5, 1)ï¼Œå³é•¿åº¦å’Œå®½åº¦éƒ½æ˜¯5ï¼Œé€šé“æ˜¯1ã€‚æ¯ä¸ªå·ç§¯æ ¸å¯¹å›¾ç‰‡å¤„ç†å®Œå°±ä¼šäº§ç”Ÿä¸€å¼ ç‰¹å¾å›¾ï¼Œ32ä¸ªå·ç§¯æ ¸å¯¹å›¾ç‰‡å¤„ç†å®Œåå°±ä¼šäº§ç”Ÿ32ä¸ªç‰¹å¾å›¾ï¼Œå°†è¿™äº›ç‰¹å¾å›¾å åŠ æ’åˆ—ï¼Œé‚£ä¹ˆåŸæœ¬é€šé“æ•°ä¸º1çš„å›¾ç‰‡ç°åœ¨é€šé“æ•°å˜ä¸ºå›¾ç‰‡çš„ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯32ã€‚å›¾ç‰‡çš„å°ºå¯¸å˜åŒ–ä¸º(?, 60, 160, 1) â€“&gt; (?, 60, 160, 32)ã€‚</p><p>éšååˆå¯¹å›¾ç‰‡è¿›è¡Œä¸€æ¬¡æ± åŒ–å¤„ç†ï¼Œæ± åŒ–çª—å£ä¸º2Ã—2ï¼Œæ‰€ä»¥å›¾ç‰‡çš„é•¿åº¦å’Œå®½åº¦éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ä¸€åŠã€‚å›¾ç‰‡çš„å°ºå¯¸å˜åŒ–ä¸º(?, 60, 160, 32) â†’ (?, 30, 80, 32)ã€‚</p><p>éšååˆè¿›è¡Œäº†ä¸€æ¬¡dropoutä»¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†åŠ å¤§ä¸ªåˆ«ç¥ç»å…ƒçš„è®­ç»ƒå¼ºåº¦ã€‚</p></li><li><p>æ„å»ºç¬¬äºŒå±‚å·ç§¯ç¥ç»ç½‘ç»œ</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">w_conv2 = self.weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">32</span>, <span class="number">64</span>])</span><br><span class="line">b_conv2 = self.bias_variable([<span class="number">64</span>])</span><br><span class="line">h_conv2 = tf.nn.relu(tf.nn.bias_add(self.conv2d(h_dropout1, w_conv2), b_conv2))</span><br><span class="line">h_pool2 = self.max_pool_2x2(h_conv2)</span><br><span class="line">h_dropout2 = tf.nn.dropout(h_pool2, keep_prob)</span><br><span class="line">conv_width = math.ceil(conv_width / <span class="number">2</span>)</span><br><span class="line">conv_height = math.ceil(conv_height / <span class="number">2</span>)</span><br></pre></td></tr></table></figure></div><p>w_conv2æ˜¯ç¬¬äºŒå±‚å·ç§¯ç¥ç»ç½‘ç»œçš„å·ç§¯æ ¸ï¼Œå…±æœ‰64ä¸ªï¼Œæ¯ä¸ªå·ç§¯æ ¸çš„å°ºå¯¸æ˜¯(5, 5, 32)ï¼Œå¤„ç†ä¹‹åå›¾ç‰‡çš„å°ºå¯¸å˜åŒ–ä¸º(?, 30, 80, 32) â†’ (?, 30, 80, 64)ã€‚</p><p>éšååˆå¯¹å›¾ç‰‡è¿›è¡Œä¸€æ¬¡æ± åŒ–å¤„ç†ï¼Œæ± åŒ–çª—å£ä¸º2Ã—2ï¼Œæ‰€ä»¥å›¾ç‰‡çš„é•¿åº¦å’Œå®½åº¦éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ä¸€åŠã€‚å›¾ç‰‡çš„å°ºå¯¸å˜åŒ–ä¸º(?, 30, 80, 64) â†’ (?, 15, 40, 64)ã€‚</p><p>å†è¿›è¡Œä¸€æ¬¡dropoutä»¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†åŠ å¤§ä¸ªåˆ«ç¥ç»å…ƒçš„è®­ç»ƒå¼ºåº¦ã€‚</p></li><li><p>æ„å»ºç¬¬ä¸‰å±‚å·ç§¯ç¥ç»ç½‘ç»œ</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">w_conv3 = self.weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">64</span>, <span class="number">64</span>])</span><br><span class="line">b_conv3 = self.bias_variable([<span class="number">64</span>])</span><br><span class="line">h_conv3 = tf.nn.relu(tf.nn.bias_add(self.conv2d(h_dropout2, w_conv3), b_conv3))</span><br><span class="line">h_pool3 = self.max_pool_2x2(h_conv3)</span><br><span class="line">h_dropout3 = tf.nn.dropout(h_pool3, keep_prob)</span><br><span class="line">conv_width = math.ceil(conv_width / <span class="number">2</span>)</span><br><span class="line">conv_height = math.ceil(conv_height / <span class="number">2</span>)</span><br></pre></td></tr></table></figure></div><p>w_conv3æ˜¯ç¬¬ä¸‰å±‚å·ç§¯ç¥ç»ç½‘ç»œçš„å·ç§¯æ ¸ï¼Œå…±æœ‰64ä¸ªï¼Œæ¯ä¸ªå·ç§¯æ ¸çš„å°ºå¯¸æ˜¯(5, 5, 64)ï¼Œå¤„ç†ä¹‹åå›¾ç‰‡çš„å°ºå¯¸å˜åŒ–ä¸º(?, 15, 40, 64) â†’ (?, 15, 40, 64)ã€‚</p><p>éšååˆå¯¹å›¾ç‰‡è¿›è¡Œä¸€æ¬¡æ± åŒ–å¤„ç†ï¼Œæ± åŒ–çª—å£ä¸º2Ã—2ï¼Œæ‰€ä»¥å›¾ç‰‡çš„é•¿åº¦å’Œå®½åº¦éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ä¸€åŠã€‚å›¾ç‰‡çš„å°ºå¯¸å˜åŒ–ä¸º(?, 15, 40, 64) â†’ (?, 8, 20, 64)ï¼Œè¿™é‡Œçš„15 / 2 = 8ï¼Œæ˜¯å› ä¸ºè¾¹ç•Œç­–ç•¥ä¸ºSAMEï¼Œé‚£ä¹ˆé‡åˆ°å‰©ä¸‹è¿˜æœ‰ä¸è¶³4ä¸ªåƒç´ çš„æ—¶å€™åŒæ ·é‡‡å–ä¸€æ¬¡æœ€å¤§å€¼æ± åŒ–å¤„ç†ã€‚</p><p>å†è¿›è¡Œä¸€æ¬¡dropoutä»¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†åŠ å¤§ä¸ªåˆ«ç¥ç»å…ƒçš„è®­ç»ƒå¼ºåº¦ã€‚</p></li><li><p>æ„å»ºç¬¬ä¸€å±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œ</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">conv_width = int(conv_width)</span><br><span class="line">conv_height = int(conv_height)</span><br><span class="line">w_fc1 = self.weight_variable([<span class="number">64</span> * conv_width * conv_height, <span class="number">1024</span>])</span><br><span class="line">b_fc1 = self.bias_variable([<span class="number">1024</span>])</span><br><span class="line">h_dropout3_flat = tf.reshape(h_dropout3, [<span class="number">-1</span>, <span class="number">64</span> * conv_width * conv_height])</span><br><span class="line">h_fc1 = tf.nn.relu(tf.nn.bias_add(tf.matmul(h_dropout3_flat, w_fc1), b_fc1))</span><br><span class="line">h_fc1_drop = tf.nn.dropout(h_fc1, keep_prob)</span><br></pre></td></tr></table></figure></div><p>è¿™é‡Œå°±æŠŠåˆšåˆšå·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å‡ºä½œä¸ºä¼ ç»Ÿç¥ç»ç½‘ç»œçš„è¾“å…¥äº†ï¼Œw_fc1(10240, 1024)å’Œb_fc1(1024)åˆ†åˆ«æ˜¯è¿™ä¸€å±‚ç¥ç»ç½‘ç»œçš„å‚æ•°ä»¥åŠbiasã€‚ä¸Šé¢ä»£ç ç¬¬äº”è¡Œå°†å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å‡ºæ•°æ®ç”±(?, 8, 20, 64)è½¬ä¸ºäº†(?, 64 <em> 20 </em> 8)ï¼Œå¯ä»¥å¾ˆæ˜æ˜¾æ„Ÿè§‰å‡ºæ¥æŠŠæ‰€æœ‰çš„æ•°æ®æ‹‰æˆäº†ä¸€æ¡ä¸€ç»´å‘é‡ï¼Œç„¶åç»è¿‡çŸ©é˜µå¤„ç†ï¼Œè¿™é‡Œçš„æ•°æ®å˜ä¸ºäº†(1024, 1)çš„å½¢çŠ¶ã€‚</p></li><li><p>æ„å»ºç¬¬äºŒå±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œ</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">w_fc2 = self.weight_variable([<span class="number">1024</span>, self.char_num * self.classes])</span><br><span class="line">b_fc2 = self.bias_variable([self.char_num * self.classes])</span><br><span class="line">y_conv = tf.add(tf.matmul(h_fc1_drop, w_fc2), b_fc2)</span><br></pre></td></tr></table></figure></div><p>å†è¿æ¥ä¸€æ¬¡ç¥ç»ç½‘ç»œï¼Œè¿™æ¬¡ä¸å†éœ€è¦æ·»åŠ æ¿€åŠ±å‡½æ•°äº†ReLuäº†ï¼Œå› ä¸ºå·²ç»åˆ°è¾¾è¾“å‡ºå±‚ï¼Œçº¿æ€§ç›¸åŠ åç›´æ¥è¾“å‡ºå°±å¯ä»¥äº†ï¼Œç»“æœä¿å­˜åœ¨y_convå˜é‡é‡Œï¼Œæœ€åå°†y_convè¿”å›ç»™è°ƒç”¨å‡½æ•°ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_conv = model.create_model(x, keep_prob)</span><br></pre></td></tr></table></figure></div><p>è¿™æ˜¯å¤–å±‚å‡½æ•°è°ƒç”¨modelåæ‰€å¾—åˆ°çš„è®­ç»ƒç»“æœã€‚</p></li></ol><h2 id="å®šä¹‰æŸå¤±å‡½æ•°ä»¥åŠä¼˜åŒ–æ–¹å¼"><a href="#å®šä¹‰æŸå¤±å‡½æ•°ä»¥åŠä¼˜åŒ–æ–¹å¼" class="headerlink" title="å®šä¹‰æŸå¤±å‡½æ•°ä»¥åŠä¼˜åŒ–æ–¹å¼"></a>å®šä¹‰æŸå¤±å‡½æ•°ä»¥åŠä¼˜åŒ–æ–¹å¼</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cross_entropy = tf.reduce_mean(tf.nn.sigmoid_cross_entropy_with_logits(labels=y_, logits=y_conv))</span><br></pre></td></tr></table></figure></div><p>ç”±äºè¯†åˆ«éªŒè¯ç æœ¬è´¨ä¸Šæ˜¯å¯¹éªŒè¯ç ä¸­çš„ä¿¡æ¯è¿›è¡Œåˆ†ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä½¿ç”¨cross_entropyçš„æ–¹æ³•æ¥è¡¡é‡æŸå¤±ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_step = tf.train.AdamOptimizer(<span class="number">1e-4</span>).minimize(cross_entropy)</span><br></pre></td></tr></table></figure></div><p>ä¼˜åŒ–æ–¹å¼é€‰æ‹©çš„æ˜¯AdamOptimizerï¼Œå­¦ä¹ ç‡è®¾ç½®æ¯”è¾ƒå°ï¼Œä¸º1e-4ï¼Œé˜²æ­¢å­¦ä¹ çš„å¤ªå¿«è€Œè®­ç»ƒä¸å¥½ã€‚</p><h2 id="è¿›è¡Œè®­ç»ƒå¹¶ä¿å­˜è®­ç»ƒç»“æœ"><a href="#è¿›è¡Œè®­ç»ƒå¹¶ä¿å­˜è®­ç»ƒç»“æœ" class="headerlink" title="è¿›è¡Œè®­ç»ƒå¹¶ä¿å­˜è®­ç»ƒç»“æœ"></a>è¿›è¡Œè®­ç»ƒå¹¶ä¿å­˜è®­ç»ƒç»“æœ</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">saver = tf.train.Saver()</span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    sess.run(tf.global_variables_initializer())</span><br><span class="line">    step = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        batch_x, batch_y = next(captcha.gen_captcha(<span class="number">64</span>))</span><br><span class="line">        _, loss = sess.run([train_step, cross_entropy], feed_dict=&#123;x: batch_x, y_: batch_y, keep_prob: <span class="number">0.75</span>&#125;)</span><br><span class="line">        print(<span class="string">'step:%d,loss:%f'</span> % (step, loss))</span><br><span class="line">        <span class="keyword">if</span> step % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">            batch_x_test, batch_y_test = next(captcha.gen_captcha(<span class="number">100</span>))</span><br><span class="line">            acc = sess.run(accuracy, feed_dict=&#123;x: batch_x_test, y_: batch_y_test, keep_prob: <span class="number">1.</span>&#125;)</span><br><span class="line">            print(<span class="string">'###############################################step:%d,accuracy:%f'</span> % (step, acc))</span><br><span class="line">            <span class="keyword">if</span> acc &gt; <span class="number">0.99</span>:</span><br><span class="line">                saver.save(sess, <span class="string">"capcha_model.ckpt"</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        step += <span class="number">1</span></span><br></pre></td></tr></table></figure></div><p>ä»ç¬¬äºŒè¡Œå¼€å§‹è¿›å…¥è®­ç»ƒéƒ¨åˆ†ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦åˆå§‹åŒ–å˜é‡ï¼Œç„¶åè¿›å…¥ä¸€ä¸ªå¾ªç¯ï¼Œç›´åˆ°è®­ç»ƒçš„å‡†ç¡®åº¦é«˜äº99%æ‰ä¼šåœæ­¢è®­ç»ƒï¼Œå¦åˆ™ä¼šä¸€ç›´è®­ç»ƒä¸‹å»ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">batch_x, batch_y = next(captcha.gen_captcha(<span class="number">64</span>))</span><br></pre></td></tr></table></figure></div><p>ç”¨äºç”Ÿæˆè®­ç»ƒé›†ï¼Œæ¯æ¬¡ç”Ÿæˆ64æ¡è®­ç»ƒæ•°æ®ï¼Œè¾“å…¥éƒ¨åˆ†ä¿å­˜åœ¨batch_xé‡Œï¼Œè¾“å‡ºéƒ¨åˆ†ä¿å­˜åœ¨batch_yé‡Œï¼Œæ¯æ¬¡å¾ªç¯åˆ°è¿™é‡Œå°±ä¼šå†æ¬¡è¯»å…¥64æ¡è®­ç»ƒæ•°æ®ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_, loss = sess.run([train_step, cross_entropy], feed_dict=&#123;x: batch_x, y_: batch_y, keep_prob: <span class="number">0.75</span>&#125;)</span><br></pre></td></tr></table></figure></div><p>å¼€å§‹è®­ç»ƒï¼Œlossè®°å½•æŸå¤±ï¼Œ_å˜é‡ä¸è®°å½•ä»»ä½•ä¸œè¥¿ï¼Œæˆ‘debugä¸‹æ¥æ¯æ¬¡_é‡Œé¢éƒ½æ˜¯ç©ºï¼Œå¯èƒ½åªæ˜¯ä¸ºäº†è¯­æ³•çš„éœ€è¦ï¼Œè¿™é‡Œå¿…é¡»æœ‰ä¸ªå˜é‡æ¥å—ç‚¹ä»€ä¹ˆã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> step % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">    batch_x_test, batch_y_test = next(captcha.gen_captcha(<span class="number">100</span>))</span><br><span class="line">    acc = sess.run(accuracy, feed_dict=&#123;x: batch_x_test, y_: batch_y_test, keep_prob: <span class="number">1.</span>&#125;)</span><br><span class="line">    print(<span class="string">'###############################################step:%d,accuracy:%f'</span> % (step, acc))</span><br><span class="line">    <span class="keyword">if</span> acc &gt; <span class="number">0.99</span>:</span><br><span class="line">        saver.save(sess, <span class="string">"capcha_model.ckpt"</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div><p>æ¯è®­ç»ƒä¸€ç™¾æ¬¡ï¼Œå°±ä¼šè¿›è¡Œä¸€æ¬¡Testã€‚å…·ä½“æ“ä½œæ˜¯ï¼Œç”Ÿæˆ100æ¡æµ‹è¯•æ•°æ®ï¼Œå’Œä¹‹å‰ç”Ÿæˆè®­ç»ƒæ•°æ®æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç„¶åç›´æ¥è¿›è¡Œæµ‹è¯•ï¼Œå¦‚æœå‡†ç¡®åº¦é«˜äº99%é‚£ä¹ˆå°±åœæ­¢è®­ç»ƒï¼ŒæŠŠè®­ç»ƒå¥½çš„æ¨¡å‹æ”¾åœ¨â€capcha_model.ckptâ€è¿™ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œå¯ä»¥ä¾›ä»¥åä½¿ç”¨ã€‚å¦‚æœæ²¡æœ‰è¾¾åˆ°99%çš„å‡†ç¡®åº¦å°±ç»§ç»­è®­ç»ƒã€‚</p><h2 id="å…­ã€å®Œæ•´ä»£ç "><a href="#å…­ã€å®Œæ•´ä»£ç " class="headerlink" title="å…­ã€å®Œæ•´ä»£ç "></a>å…­ã€å®Œæ•´ä»£ç </h2><h3 id="train-captcha-py"><a href="#train-captcha-py" class="headerlink" title="train_captcha.py"></a>train_captcha.py</h3><p>è®­ç»ƒçš„ä¸»ä»£ç </p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> generate_captcha</span><br><span class="line"><span class="keyword">import</span> captcha_model</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    captcha = generate_captcha.GenerateCaptcha()  <span class="comment"># åˆ›å»ºä¸€ä¸ªéªŒè¯ç å¯¹è±¡</span></span><br><span class="line">    width, height, char_num, characters, classes = captcha.get_parameter()  <span class="comment"># è·å–æ­¤éªŒè¯ç å¯¹è±¡çš„å„ç§å±æ€§</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># xï¼šè®­ç»ƒé›†è¾“å…¥å ä½ç¬¦</span></span><br><span class="line">    <span class="comment"># yï¼šè®­ç»ƒé›†è¾“å‡ºå ä½ç¬¦</span></span><br><span class="line">    <span class="comment"># keep_probï¼šdropoutå¤„ç†ä¿ç•™æ­¤ç¥ç»å…ƒçš„æ¦‚ç‡å ä½ç¬¦</span></span><br><span class="line">    x = tf.placeholder(tf.float32, [<span class="literal">None</span>, height, width, <span class="number">1</span>])</span><br><span class="line">    y_ = tf.placeholder(tf.float32, [<span class="literal">None</span>, char_num * classes])</span><br><span class="line">    keep_prob = tf.placeholder(tf.float32)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”Ÿæˆè®­ç»ƒæ¨¡å‹å¯¹è±¡</span></span><br><span class="line">    model = captcha_model.CaptchaModel(width, height, char_num, classes)</span><br><span class="line">    <span class="comment"># y_conv: æ¨¡å‹è®­ç»ƒå®Œçš„ç»“æœ</span></span><br><span class="line">    y_conv = model.create_model(x, keep_prob)</span><br><span class="line">    <span class="comment"># æŸå¤±å‡½æ•°ï¼Œç”¨cross_entropyæ¥æè¿°æŸå¤±</span></span><br><span class="line">    cross_entropy = tf.reduce_mean(tf.nn.sigmoid_cross_entropy_with_logits(labels=y_, logits=y_conv))</span><br><span class="line">    <span class="comment"># ä¼˜åŒ–å™¨ï¼Œé€‰ç”¨AdamOptimizer</span></span><br><span class="line">    train_step = tf.train.AdamOptimizer(<span class="number">1e-4</span>).minimize(cross_entropy)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†è®­ç»ƒå®Œçš„ç»“æœreshapeä¸º(?, 4, 62)çš„å½¢çŠ¶</span></span><br><span class="line">    predict = tf.reshape(y_conv, [<span class="number">-1</span>, char_num, classes])</span><br><span class="line">    <span class="comment"># å°†çœŸå®å€¼ä¹Ÿreshapeä¸º(?, 4, 62)çš„å½¢çŠ¶</span></span><br><span class="line">    real = tf.reshape(y_, [<span class="number">-1</span>, char_num, classes])</span><br><span class="line">    <span class="comment"># è®¡ç®—é¢„æµ‹æ­£ç¡®çš„ä¸ªæ•°</span></span><br><span class="line">    correct_prediction = tf.equal(tf.argmax(predict, <span class="number">2</span>), tf.argmax(real, <span class="number">2</span>))</span><br><span class="line">    <span class="comment"># è½¬å‹ä¸ºæµ®ç‚¹æ•°æ ¼å¼</span></span><br><span class="line">    correct_prediction = tf.cast(correct_prediction, tf.float32)</span><br><span class="line">    <span class="comment"># æ±‚å‡å€¼ï¼Œå°±æ˜¯å‡†ç¡®ç‡</span></span><br><span class="line">    accuracy = tf.reduce_mean(correct_prediction)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç­‰æ¨¡å‹è®­ç»ƒå¥½åï¼Œå¯ä»¥ç”¨saverä¿å­˜æ¨¡å‹ï¼Œä¾¿äºä»¥åä½¿ç”¨</span></span><br><span class="line">    saver = tf.train.Saver()</span><br><span class="line">    <span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">        sess.run(tf.global_variables_initializer())</span><br><span class="line">        step = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># batch_xå’Œbatch_yå­˜å‚¨64æ¡è®­ç»ƒæ•°æ®çš„è¾“å…¥å’Œè¾“å‡ºå€¼</span></span><br><span class="line">            batch_x, batch_y = next(captcha.gen_captcha(<span class="number">64</span>))</span><br><span class="line">            <span class="comment"># losså­˜å‚¨æœ¬æ¬¡è®­ç»ƒçš„æŸå¤±å€¼</span></span><br><span class="line">            _, loss = sess.run([train_step, cross_entropy], feed_dict=&#123;x: batch_x, y_: batch_y, keep_prob: <span class="number">0.75</span>&#125;)</span><br><span class="line">            print(<span class="string">'step:%d,loss:%f'</span> % (step, loss))</span><br><span class="line">            <span class="comment"># æ¯è¿›è¡Œ100æ¬¡ï¼Œå°±è¿›è¡Œä¸€æ¬¡æµ‹è¯•</span></span><br><span class="line">            <span class="keyword">if</span> step % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># è·å–100æ¡æµ‹è¯•æ•°æ®</span></span><br><span class="line">                batch_x_test, batch_y_test = next(captcha.gen_captcha(<span class="number">100</span>))</span><br><span class="line">                acc = sess.run(accuracy, feed_dict=&#123;x: batch_x_test, y_: batch_y_test, keep_prob: <span class="number">1.</span>&#125;)</span><br><span class="line">                print(<span class="string">'###############################################step:%d,accuracy:%f'</span> % (step, acc))</span><br><span class="line">                <span class="comment"># å¦‚æœæµ‹è¯•å‡†ç¡®åº¦åœ¨99%ä»¥ä¸Šå°±é€€å‡ºï¼Œå¦åˆ™ç»§ç»­è®­ç»ƒ</span></span><br><span class="line">                <span class="keyword">if</span> acc &gt; <span class="number">0.99</span>:</span><br><span class="line">                    saver.save(sess, <span class="string">"capcha_model.ckpt"</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            step += <span class="number">1</span></span><br></pre></td></tr></table></figure></div><h3 id="generate-captcha-py"><a href="#generate-captcha-py" class="headerlink" title="generate_captcha.py"></a>generate_captcha.py</h3><p>ç”ŸæˆéªŒè¯ç çš„ç±»</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> captcha.image <span class="keyword">import</span> ImageCaptcha</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GenerateCaptcha</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,</span></span></span><br><span class="line"><span class="function"><span class="params">                 width=<span class="number">160</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                 height=<span class="number">60</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                 char_num=<span class="number">4</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                 characters=string.digits + string.ascii_uppercase + string.ascii_lowercase)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        GenerateCaptchaç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="string">        :param width: éªŒè¯ç å›¾ç‰‡çš„å®½</span></span><br><span class="line"><span class="string">        :param height: éªŒè¯ç å›¾ç‰‡çš„é«˜</span></span><br><span class="line"><span class="string">        :param char_num: éªŒè¯ç å­—ç¬¦ä¸ªæ•°</span></span><br><span class="line"><span class="string">        :param characters: éªŒè¯ç ç»„æˆå­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å«æ€»æ•°å­—ä¸²(0~9)+å¤§å†™å­—æ¯ä¸²(A~Z)+å°å†™å­—æ¯ä¸²(a~z)</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.width = width</span><br><span class="line">        self.height = height</span><br><span class="line">        self.char_num = char_num</span><br><span class="line">        self.characters = characters</span><br><span class="line">        self.classes = len(characters)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_captcha</span><span class="params">(self, batch_size=<span class="number">50</span>)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        ç”Ÿæˆä¸€ç»„éªŒè¯ç è®­ç»ƒæ•°æ®</span></span><br><span class="line"><span class="string">        :param batch_size:ç”¨ä»¥æŒ‡å®šè¿™ä¸€ç»„è®­ç»ƒæ•°æ®çš„ä¸ªæ•°</span></span><br><span class="line"><span class="string">        :return:Xï¼ˆè¿™ä¸€ç»„è®­ç»ƒæ•°æ®çš„è¾“å…¥Xï¼‰, Yï¼ˆè¿™ä¸€ç»„è®­ç»ƒæ•°æ®çš„è¾“å‡ºYï¼‰</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># éªŒè¯ç å›¾ç‰‡å¯¹è±¡ï¼Œè¿™é‡Œåªé™å®šäº†å°ºå¯¸ï¼Œè¿˜æ²¡æœ‰å†™å†…å®¹</span></span><br><span class="line">        image = ImageCaptcha(width=self.width, height=self.height)</span><br><span class="line">        <span class="comment"># X:ç”¨ä»¥å­˜æ”¾è®­ç»ƒæ•°æ®çš„è¾“å…¥éƒ¨åˆ†</span></span><br><span class="line">        <span class="comment"># batch_size: è¿™ä¸€ç»„è®­ç»ƒæ•°æ®å…±æœ‰batch_sizeä¸ª</span></span><br><span class="line">        <span class="comment"># self.height: æ¯ä¸€ä¸ªè®­ç»ƒæ•°æ®ï¼ˆéªŒè¯ç ï¼‰çš„é«˜åº¦</span></span><br><span class="line">        <span class="comment"># self.width: æ¯ä¸€ä¸ªè®­ç»ƒæ•°æ®ï¼ˆéªŒè¯ç ï¼‰çš„å®½åº¦</span></span><br><span class="line">        <span class="comment"># 1: æ¯ä¸€ä¸ªè®­ç»ƒæ•°æ®ï¼ˆéªŒè¯ç ï¼‰çš„é€šé“æ•°ï¼Œå› ä¸ºæ˜¯é»‘ç™½å›¾ç‰‡æ‰€ä»¥ä¸º1</span></span><br><span class="line">        X = np.zeros([batch_size, self.height, self.width, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Y:ç”¨ä»¥å­˜æ”¾è®­ç»ƒæ•°æ®çš„è¾“å‡ºéƒ¨åˆ†</span></span><br><span class="line">        <span class="comment"># batch_size: è¿™ä¸€ç»„è®­ç»ƒæ•°æ®å…±æœ‰batch_sizeä¸ª</span></span><br><span class="line">        <span class="comment"># self.char_num: æ¯ä¸€ä¸ªè®­ç»ƒæ•°æ®ï¼ˆéªŒè¯ç ï¼‰çš„å†…å®¹ä¸­åŒ…å«å‡ ä¸ªå­—ç¬¦</span></span><br><span class="line">        <span class="comment"># self.classes: è¿™ä¸ªå­—ç¬¦çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼ˆè¿™æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º62çš„å‘é‡ï¼Œå› ä¸º10ä¸ªæ•°å­—åŠ 26ä¸ªå¤§å†™å­—æ¯åŠ 26ä¸ªå°å†™å­—æ¯é•¿åº¦ä¸º62ï¼Œåªæœ‰ä¸€ä¸ªå€¼ä¸º1ï¼Œè¡¨ç¤ºè¿™ä¸ªå­—ç¬¦å†…å®¹ï¼Œå…¶ä»–éƒ½æ˜¯0ï¼‰</span></span><br><span class="line">        Y = np.zeros([batch_size, self.char_num, self.classes])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(batch_size):</span><br><span class="line">                <span class="comment"># random.sample(self.characters, self.char_num)ç”¨äºç”Ÿæˆä¸€ä¸ªéªŒè¯ç å­—ç¬¦ä¸²éšæœºå˜é‡</span></span><br><span class="line">                <span class="comment"># self.charactersï¼š62ä½å­—ç¬¦ä¸²ï¼ˆ0~9A~Za~zï¼‰</span></span><br><span class="line">                <span class="comment"># self.char_numï¼š4ï¼ˆç”Ÿæˆ4ä¸ªå­—ç¬¦ï¼‰</span></span><br><span class="line">                <span class="comment"># captcha_strç”¨ä»¥å°†è½¬å¥½çš„éšæœºå˜é‡è½¬ä¸ºå­—ç¬¦ä¸²ç±»å‹</span></span><br><span class="line">                captcha_str = <span class="string">''</span>.join(random.sample(self.characters, self.char_num))</span><br><span class="line"></span><br><span class="line">                <span class="comment"># ç”¨å†…ç½®æ–¹æ³•ï¼Œå°†å­—ç¬¦ä¸²å˜ä¸ºå›¾ç‰‡</span></span><br><span class="line">                <span class="comment"># convert('L')ï¼šè¡¨ç¤ºç”Ÿæˆçš„æ˜¯ç°åº¦å›¾ç‰‡ï¼Œå°±æ˜¯é€šé“æ•°ä¸º1çš„é»‘ç™½å›¾ç‰‡</span></span><br><span class="line">                img = image.generate_image(captcha_str).convert(<span class="string">'L'</span>)</span><br><span class="line">                <span class="comment"># å°†ç”Ÿæˆå¥½çš„å›¾ç‰‡æ•°æ®è½¬æˆnp.arrayç±»å‹</span></span><br><span class="line">                img = np.array(img.getdata())</span><br><span class="line">                <span class="comment"># reshapeä¸€ä¸‹æ­¤å›¾ç‰‡çš„æ ¼å¼ï¼Œè®©ä»–çš„é«˜åº¦å’Œå®½åº¦ç¬¦åˆè¦æ±‚</span></span><br><span class="line">                <span class="comment"># æ¯ä¸ªåƒç´ å€¼éƒ½è¦é™¤ä»¥255ï¼Œè¿™æ˜¯ä¸ºäº†å½’ä¸€åŒ–å¤„ç†ï¼Œå› ä¸ºç°åº¦çš„èŒƒå›´æ˜¯0~255ï¼Œè¿™é‡Œé™¤ä»¥255å°±è®©æ¯ä¸ªåƒç´ çš„å€¼åœ¨0~1ä¹‹é—´ï¼ŒåŠ å¿«æ”¶æ•›é€Ÿåº¦</span></span><br><span class="line">                <span class="comment"># å°†æ­¤å›¾ç‰‡ä¿¡æ¯æ”¾å…¥Xçš„ç¬¬iä¸ªä½ç½®ï¼Œè¡¨ç¤ºè¿™æ˜¯è®­ç»ƒé›†çš„ç¬¬iæ¡æ•°æ®</span></span><br><span class="line">                X[i] = np.reshape(img, [self.height, self.width, <span class="number">1</span>]) / <span class="number">255.0</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># è¿™é‡Œç”¨ä»¥ç”Ÿæˆå¯¹åº”çš„æµ‹è¯•é›†</span></span><br><span class="line">                <span class="comment"># jå’Œchç”¨ä»¥éå†åˆšåˆšç”Ÿæˆçš„éšæœºå­—ç¬¦ä¸²ï¼Œjè®°å½•indexï¼ˆ0~3ï¼Œè¡¨ç¤ºç¬¬å‡ ä¸ªå­—ç¬¦ï¼‰ï¼Œchè®°å½•å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦</span></span><br><span class="line">                <span class="keyword">for</span> j, ch <span class="keyword">in</span> enumerate(captcha_str):</span><br><span class="line">                    <span class="comment"># æ‰¾åˆ°Yçš„ç¬¬iæ¡æ•°æ®ä¸­ï¼Œç¬¬jä¸ªå­—ç¬¦ï¼Œç„¶åæŠŠ62é•¿åº¦çš„å‘é‡å’Œchç›¸å…³çš„é‚£ä¸ªç½®ä½1</span></span><br><span class="line">                    Y[i, j, self.characters.find(ch)] = <span class="number">1</span></span><br><span class="line">            <span class="comment"># é‡æ–°æ•´ç†ä¸€ä¸‹Yï¼Œç¬¬ä¸€ç»´åº¦ä¾ç„¶æ˜¯batch_sizeï¼Œåé¢æŠŠchar_numå’Œclassesç›¸ä¹˜ï¼Œæ•´åˆæˆä¸€æ¡å‘é‡</span></span><br><span class="line">            Y = np.reshape(Y, (batch_size, self.char_num * self.classes))</span><br><span class="line">            <span class="keyword">yield</span> X, Y</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_parameter</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.width, self.height, self.char_num, self.characters, self.classes</span><br></pre></td></tr></table></figure></div><h3 id="captcha-model-py"><a href="#captcha-model-py" class="headerlink" title="captcha_model.py"></a>captcha_model.py</h3><p>è®­ç»ƒæ¨¡å‹çš„ç±»</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CaptchaModel</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,</span></span></span><br><span class="line"><span class="function"><span class="params">                 width=<span class="number">160</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                 height=<span class="number">60</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                 char_num=<span class="number">4</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                 classes=<span class="number">62</span>)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        è®­ç»ƒæ¨¡å‹ç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="string">        :param width: éªŒè¯ç å®½åº¦</span></span><br><span class="line"><span class="string">        :param height: éªŒè¯ç é«˜åº¦</span></span><br><span class="line"><span class="string">        :param char_num: éªŒè¯ç å†…å­—ç¬¦æ•°</span></span><br><span class="line"><span class="string">        :param classes: éªŒè¯ç å¾…é€‰å­—ç¬¦ä¸ªæ•°</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.width = width</span><br><span class="line">        self.height = height</span><br><span class="line">        self.char_num = char_num</span><br><span class="line">        self.classes = classes</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">conv2d</span><span class="params">(self, x, W)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        2ç»´å·ç§¯å‡½æ•°</span></span><br><span class="line"><span class="string">        strides=[1, 1ï¼ˆxæ–¹å‘æ­¥é•¿ï¼‰, 1ï¼ˆyæ–¹å‘æ­¥é•¿ï¼‰, 1]</span></span><br><span class="line"><span class="string">        padding='SAME'ï¼ˆè¾¹ç•Œå¤„ç†ç­–ç•¥ï¼Œè®¾ä¸º'SAME'å·ç§¯å¤„ç†å®Œå›¾ç‰‡å¤§å°ä¸å˜ï¼‰</span></span><br><span class="line"><span class="string">        :param x: è¢«å·ç§¯å¤„ç†çš„å›¾ç‰‡</span></span><br><span class="line"><span class="string">        :param W: å·ç§¯æ ¸</span></span><br><span class="line"><span class="string">        :return: å·ç§¯å¤„ç†å®Œçš„å›¾ç‰‡</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> tf.nn.conv2d(x, W, strides=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=<span class="string">'SAME'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">max_pool_2x2</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        2x2æœ€å¤§å€¼æ± åŒ–å‡½æ•°</span></span><br><span class="line"><span class="string">        ksize=[1, 2ï¼ˆæ± åŒ–çª—å£é«˜åº¦ï¼‰, 2(æ± åŒ–çª—å£é«˜åº¦), 1]</span></span><br><span class="line"><span class="string">        strides=[1, 1ï¼ˆxæ–¹å‘æ­¥é•¿ï¼‰, 1ï¼ˆyæ–¹å‘æ­¥é•¿ï¼‰, 1]</span></span><br><span class="line"><span class="string">        padding='SAME'</span></span><br><span class="line"><span class="string">        :param x: å¾…è¢«æ± åŒ–å¤„ç†çš„å›¾ç‰‡</span></span><br><span class="line"><span class="string">        :return: å¤„ç†å¥½çš„å›¾ç‰‡</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> tf.nn.max_pool(x, ksize=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], strides=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], padding=<span class="string">'SAME'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">weight_variable</span><span class="params">(self, shape)</span>:</span></span><br><span class="line">        <span class="comment"># æˆªæ–­å¼æ­£æ€åˆ†å¸ƒç”Ÿæˆå˜é‡</span></span><br><span class="line">        initial = tf.truncated_normal(shape, stddev=<span class="number">0.1</span>)</span><br><span class="line">        <span class="keyword">return</span> tf.Variable(initial)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bias_variable</span><span class="params">(self, shape)</span>:</span></span><br><span class="line">        <span class="comment"># ç”Ÿæˆä¸€ç»„å¸¸é‡</span></span><br><span class="line">        initial = tf.constant(<span class="number">0.1</span>, shape=shape)</span><br><span class="line">        <span class="keyword">return</span> tf.Variable(initial)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_model</span><span class="params">(self, x_images, keep_prob)</span>:</span></span><br><span class="line">        <span class="comment"># first layer</span></span><br><span class="line">        w_conv1 = self.weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">32</span>])</span><br><span class="line">        b_conv1 = self.bias_variable([<span class="number">32</span>])</span><br><span class="line">        <span class="comment"># ç¬¬ä¸€æ¬¡å·ç§¯ (?, 60, 160, 1) --&gt; (?, 60, 160, 32)</span></span><br><span class="line">        h_conv1 = tf.nn.relu(tf.nn.bias_add(self.conv2d(x_images, w_conv1), b_conv1))</span><br><span class="line">        <span class="comment"># ç¬¬ä¸€æ¬¡æ± åŒ– (?, 60, 160, 32) --&gt; (?, 30, 80, 32)</span></span><br><span class="line">        h_pool1 = self.max_pool_2x2(h_conv1)</span><br><span class="line">        <span class="comment"># ç¬¬ä¸€å±‚dropout</span></span><br><span class="line">        h_dropout1 = tf.nn.dropout(h_pool1, keep_prob)</span><br><span class="line">        conv_width = math.ceil(self.width / <span class="number">2</span>)</span><br><span class="line">        conv_height = math.ceil(self.height / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># second layer</span></span><br><span class="line">        w_conv2 = self.weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">32</span>, <span class="number">64</span>])</span><br><span class="line">        b_conv2 = self.bias_variable([<span class="number">64</span>])</span><br><span class="line">        <span class="comment"># ç¬¬äºŒæ¬¡å·ç§¯ (?, 30, 80, 32) --&gt; (?, 30, 80, 64)</span></span><br><span class="line">        h_conv2 = tf.nn.relu(tf.nn.bias_add(self.conv2d(h_dropout1, w_conv2), b_conv2))</span><br><span class="line">        <span class="comment"># ç¬¬äºŒæ¬¡æ± åŒ– (?, 30, 80, 64) --&gt; (?, 15, 40, 64)</span></span><br><span class="line">        h_pool2 = self.max_pool_2x2(h_conv2)</span><br><span class="line">        <span class="comment"># ç¬¬äºŒå±‚dropout</span></span><br><span class="line">        h_dropout2 = tf.nn.dropout(h_pool2, keep_prob)</span><br><span class="line">        conv_width = math.ceil(conv_width / <span class="number">2</span>)</span><br><span class="line">        conv_height = math.ceil(conv_height / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># third layer</span></span><br><span class="line">        w_conv3 = self.weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">64</span>, <span class="number">64</span>])</span><br><span class="line">        b_conv3 = self.bias_variable([<span class="number">64</span>])</span><br><span class="line">        <span class="comment"># ç¬¬ä¸‰æ¬¡å·ç§¯ (?, 15, 40, 64) --&gt; (?, 15, 40, 64)</span></span><br><span class="line">        h_conv3 = tf.nn.relu(tf.nn.bias_add(self.conv2d(h_dropout2, w_conv3), b_conv3))</span><br><span class="line">        <span class="comment"># ç¬¬ä¸‰æ¬¡æ± åŒ– (?, 15, 40, 64) --&gt; (?, 8, 20, 64)</span></span><br><span class="line">        h_pool3 = self.max_pool_2x2(h_conv3)</span><br><span class="line">        <span class="comment"># ç¬¬ä¸‰å±‚dropout</span></span><br><span class="line">        h_dropout3 = tf.nn.dropout(h_pool3, keep_prob)</span><br><span class="line">        conv_width = math.ceil(conv_width / <span class="number">2</span>)</span><br><span class="line">        conv_height = math.ceil(conv_height / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¬¬ä¸€å±‚å…¨è¿æ¥ç¥ç»ç½‘ç»œ</span></span><br><span class="line">        conv_width = int(conv_width)</span><br><span class="line">        conv_height = int(conv_height)</span><br><span class="line">        <span class="comment"># ç¬¬ä¸€å±‚æƒå€¼ (64 * 20 * 8, 1024)</span></span><br><span class="line">        w_fc1 = self.weight_variable([<span class="number">64</span> * conv_width * conv_height, <span class="number">1024</span>])</span><br><span class="line">        <span class="comment"># ç¬¬ä¸€å±‚bias (1, 1024)</span></span><br><span class="line">        b_fc1 = self.bias_variable([<span class="number">1024</span>])</span><br><span class="line">        <span class="comment"># å°†CNNçš„è¾“å‡ºç»“æœå±•å¼€æˆä¸€æ¡çº¿ï¼Œshapeä¸º(64 * 20 * 8, 1)</span></span><br><span class="line">        h_dropout3_flat = tf.reshape(h_dropout3, [<span class="number">-1</span>, <span class="number">64</span> * conv_width * conv_height])</span><br><span class="line">        <span class="comment"># ç¥ç»ç½‘ç»œå¤„ç†ï¼Œæ¿€å‘å‡½æ•°é€‰æ‹©relu (64 * 20 * 8, 1) --&gt; (1024, 1)</span></span><br><span class="line">        h_fc1 = tf.nn.relu(tf.nn.bias_add(tf.matmul(h_dropout3_flat, w_fc1), b_fc1))</span><br><span class="line">        <span class="comment"># dropoutå¤„ç†</span></span><br><span class="line">        h_fc1_drop = tf.nn.dropout(h_fc1, keep_prob)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># second fully layer</span></span><br><span class="line">        w_fc2 = self.weight_variable([<span class="number">1024</span>, self.char_num * self.classes])</span><br><span class="line">        b_fc2 = self.bias_variable([self.char_num * self.classes])</span><br><span class="line">        <span class="comment"># ç¥ç»ç½‘ç»œå¤„ç†, (1024, 1) --&gt; (4 * 62, 1)</span></span><br><span class="line">        y_conv = tf.add(tf.matmul(h_fc1_drop, w_fc2), b_fc2)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> y_conv</span><br></pre></td></tr></table></figure></div><h3 id="predict-captcha-py"><a href="#predict-captcha-py" class="headerlink" title="predict_captcha.py"></a>predict_captcha.py</h3><p>æˆ‘ä»¬æŠŠè®­ç»ƒå¥½çš„æ¨¡å‹ä¿å­˜èµ·æ¥ï¼Œä¹‹åå¯ä»¥ä½¿ç”¨æ­¤ä»£ç å»è¯†åˆ«ä»»æ„çš„éªŒè¯ç ï¼Œåªè¦å›¾ç‰‡è¾“å…¥çš„è¦æ±‚ç¬¦åˆé«˜60å®½160ä¸”1é€šé“é»‘ç™½å›¾ç‰‡å³å¯ã€‚è¿™ä¸ªç±»ä¸Šé¢æˆ‘æ²¡è®²è§£ï¼Œæˆ‘ä¹Ÿæ²¡æœºä¼šè¯•ï¼Œå› ä¸ºè®­ç»ƒæ—¶é—´å¤ªä¹…äº†æˆ‘è¿˜æ²¡è®­å‡ºæ¥å‘¢ï¼Œæ®è¯´GPUè®­ç»ƒéœ€è¦4~5ä¸ªå°æ—¶ï¼ŒCPUè®­ç»ƒçš„è¯éœ€è¦20å°æ—¶ï¼Œå¤§å®¶è®­ç»ƒå¥½äº†å¯ä»¥æ‹¿å»è¯•è¯•ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> generate_captcha</span><br><span class="line"><span class="keyword">import</span> captcha_model</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    captcha = generate_captcha.GenerateCaptcha()</span><br><span class="line">    width, height, char_num, characters, classes = captcha.get_parameter()</span><br><span class="line"></span><br><span class="line">    gray_image = Image.open(sys.argv[<span class="number">1</span>]).convert(<span class="string">'L'</span>)</span><br><span class="line">    img = np.array(gray_image.getdata())</span><br><span class="line">    test_x = np.reshape(img, [height, width, <span class="number">1</span>]) / <span class="number">255.0</span></span><br><span class="line">    x = tf.placeholder(tf.float32, [<span class="literal">None</span>, height, width, <span class="number">1</span>])</span><br><span class="line">    keep_prob = tf.placeholder(tf.float32)</span><br><span class="line"></span><br><span class="line">    model = captcha_model.CaptchaModel(width, height, char_num, classes)</span><br><span class="line">    y_conv = model.create_model(x,keep_prob)</span><br><span class="line">    predict = tf.argmax(tf.reshape(y_conv, [<span class="number">-1</span>,char_num, classes]),<span class="number">2</span>)</span><br><span class="line">    init_op = tf.global_variables_initializer()</span><br><span class="line">    saver = tf.train.Saver()</span><br><span class="line">    gpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=<span class="number">0.95</span>)</span><br><span class="line">    <span class="keyword">with</span> tf.Session(config=tf.ConfigProto(log_device_placement=<span class="literal">False</span>, gpu_options=gpu_options)) <span class="keyword">as</span> sess:</span><br><span class="line">        sess.run(init_op)</span><br><span class="line">        saver.restore(sess, <span class="string">"capcha_model.ckpt"</span>)</span><br><span class="line">        pre_list = sess.run(predict, feed_dict=&#123;x: [test_x], keep_prob: <span class="number">1</span>&#125;)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> pre_list:</span><br><span class="line">            s = <span class="string">''</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">                s += characters[j]</span><br><span class="line">            print(s)</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> Deep Learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> lab </tag>
            
            <tag> tensorflow </tag>
            
            <tag> cnn </tag>
            
            <tag> dnn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ€è§„åˆ’ - Dynamic Programming</title>
      <link href="/2019/03/27/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%20-%20Dynamic%20Programming/"/>
      <url>/2019/03/27/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%20-%20Dynamic%20Programming/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Those who cannot remember the past are condemned to repeat.</p><p>-Dynamic Programming</p></blockquote><a id="more"></a><p>ä»Šå¤©çš„ç®—æ³•è¯¾è®²çš„å°±æ˜¯åŠ¨æ€è§„åˆ’ï¼Œè™½æ—©å·²ä¹…ä»°å¤§åï¼Œä½†å§‹ç»ˆä¸å¤ªæ‡‚èƒŒååŸç†ã€‚å¬å®Œè¯¾åèµ¶ç´§æŠŠä»Šå¤©å­¦åˆ°çš„ä¸œè¥¿è®°ä¸‹æ¥ã€‚</p><p>åŠ¨æ€è§„åˆ’å’Œåˆ†æ²»æ³•æœ‰ç±»ä¼¼ä¹‹å¤„ï¼Œä»–ä»¬éƒ½æ˜¯é€šè¿‡ç»„åˆå­é—®é¢˜çš„è§£æ¥æ±‚è§£åŸé—®é¢˜ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œåˆ†æ²»æ³•å¸¸å¸¸ç”¨äºå°†åŸé—®é¢˜åˆ’åˆ†ä¸ºå‡ ä¸ª<strong>äº’ä¸ç›¸äº¤</strong>çš„å­é—®é¢˜ï¼Œå¦‚æœåˆ’åˆ†åï¼Œæœ‰å¾ˆå¤š<strong>å®Œå…¨ç›¸åŒ</strong>çš„å­é—®é¢˜ï¼Œé‚£å°±ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ€è·¯æ¯”è¾ƒå¥½ã€‚ä¾‹å¦‚å¿«é€Ÿæ’åºï¼Œå°†ä¸€æ®µæ•°ç»„ä»¥æ¢çº½å€¼ä¸ºç•Œä¸€åˆ†ä¸ºäºŒï¼Œå†å°†è¿™ä¸¤æ®µåˆ†åˆ«æ’åºã€‚å°†åˆ†å‡ºæ¥çš„ä¸¤æ®µæ•°ç»„åˆ†åˆ«æ’åºå°±æ˜¯äº’ä¸ç›¸äº¤çš„ä¸¤ä¸ªå­é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨åˆ†æ²»æ³•æ¥è§£å†³ã€‚å†å¦‚æ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬né¡¹é—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“æ–æ³¢é‚£å¥‘æ•°åˆ—çš„è§„å¾‹æ˜¯<br>$$<br>F(0) = 0 \quad F(1) = 1 \quad F(n) = F(n - 1) + F(n - 2) (n &gt;= 2)<br>$$<br>æˆ‘ä»¬å‘ç°æ±‚F(n)éœ€è¦è®¡ç®—F(n-1)å’ŒF(n-2)ï¼Œå¯æ˜¯å½“è®¡ç®—F(n-1)å’ŒF(n-2)æ—¶ï¼Œéƒ½éœ€è¦è®¡ç®—F(n-3)ï¼Œè¿™æ ·å°±é€ æˆäº†é‡å¤è®¡ç®—ï¼Œå¤§å¹…é™ä½äº†æ•ˆç‡ï¼Œè€ŒåŠ¨æ€è§„åˆ’ç®—æ³•çš„ç›®çš„å°±æ˜¯é¿å…æ­¤ç±»é‡å¤è®¡ç®—ã€‚</p><p>å»å¹´æš‘å‡ï¼Œæˆ‘å¥½å¥½æ€è€ƒäº†ä¸€ä¸‹ä¸Šå°é˜¶é—®é¢˜ï¼š</p><blockquote><p>æœ‰100çº§å°é˜¶ï¼Œæ¯æ¬¡åªå…è®¸ä¸Š1çº§å°é˜¶æˆ–ä¸Š2çº§å°é˜¶ï¼Œè‹¥è¦æ±‚ä¸Šå®Œå…¨éƒ¨å°é˜¶ï¼Œå…±æœ‰å¤šå°‘ç§ä¸Šæ³•ï¼Ÿ</p></blockquote><p>ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿˜ä»¥ä¸ºæ˜¯ç»„åˆæ•°å­¦é—®é¢˜ï¼Œåæ¥ä¹Ÿæ²¡åšå‡ºæ¥ã€‚å†ä¸€æƒ³ï¼Œè¦ä¸ç›´æ¥æšä¸¾å§ï¼Œé‚£è¿™æ ·çš„æ•°æ®è§„æ¨¡æ˜¯æƒŠäººçš„ï¼Œæ˜¯æŒ‡æ•°çº§çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><p>emmm~æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹åˆ†æ²»æ³•å§ã€‚å‡è®¾ä¸€ä¸‹ï¼Œç°åœ¨å·²ç»ç«™åœ¨äº†ç¬¬100å±‚å°é˜¶ä¸Šï¼Œå›å¿†ä¸€ä¸‹åˆšåˆšæœ€åä¸€æ­¥æˆ‘æ˜¯æ€ä¹ˆä¸Šæ¥ç€çš„ã€‚æˆ‘æœ€åä¸€æ­¥å¯ä»¥æ˜¯ä»98å±‚ä¸€æ­¥è·¨ä¸Šæ¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»99å±‚è¸©ä¸Šä¸€çº§å°é˜¶ä¸Šæ¥ã€‚è¿™æ—¶è®©æˆ‘ä»¬æ—¶å…‰å€’æµï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æœ€åä¸€æ­¥ä»98å±‚è·¨ä¸¤çº§ä¸Šæ¥ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä»99å±‚çˆ¬ä¸€çº§ä¸Šæ¥ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å°†è¿™ä¸¤ç§å¯èƒ½åˆ†å¼€è®¨è®ºï¼Œå¦‚æœæˆ‘é™å®šæœ€åä¸€æ­¥åªèƒ½èµ°ä¸€æ­¥ï¼Œé‚£ä¹ˆä¹‹å‰æˆ‘å°±å¿…é¡»ä¸Šåˆ°99å±‚ï¼Œè€Œ99å±‚åˆ°100å±‚åªæœ‰1æ¡è·¯å¯èµ°ï¼Œä¸Šåˆ°100å±‚çš„ä¸Šæ³•å°±ç­‰äºä¸Šåˆ°99å±‚çš„ä¸Šæ³•ï¼Œæ‰€ä»¥æˆ‘ç°åœ¨åªè¦å¾—çŸ¥ä¸Šåˆ°99å±‚æœ‰å¤šå°‘ç§ä¸Šæ³•ï¼Œå°±çŸ¥é“äº†ä¸Šåˆ°100å±‚æœ‰å¤šå°‘ç§ä¸Šæ³•ï¼›åŒç†ï¼Œå¦‚æœæˆ‘é™å®šæœ€åä¸€æ­¥å¿…é¡»è·¨ä¸¤æ­¥ï¼Œé‚£ä¹ˆæˆ‘ä¹‹å‰å°±å¿…é¡»ä¸Šåˆ°98å±‚ï¼Œæ‰€ä»¥æˆ‘ç°åœ¨åªè¦å¾—çŸ¥ä¸Šåˆ°98å±‚æœ‰å¤šå°‘ç§ä¸Šæ³•ï¼Œ98å±‚åˆ°100å±‚ä¹Ÿåªæœ‰è·¨ä¸¤çº§è¿™ä¸€æ¡è·¯ï¼Œæ‰€ä»¥ä¸Šåˆ°100å±‚çš„ä¸Šæ³•å°±ç­‰äºä¸Šåˆ°98å±‚çš„ä¸Šæ³•äº†ã€‚</p><p>ç°å®é‡Œï¼Œæœ€åä¸€æ­¥å¯ä»¥è·¨ä¸¤çº§ï¼Œä¹Ÿå¯ä»¥åªçˆ¬ä¸€çº§ï¼Œæ‰€ä»¥ä¸Šåˆ°100å±‚çš„ä¸Šæ³•ï¼Œåº”è¯¥ç­‰äºä¸Šåˆ°98å±‚çš„ä¸Šæ³•åŠ ä¸Šä¸Šåˆ°99å±‚çš„ä¸Šæ³•ã€‚å¦‚æœç”¨å‡½æ•°F(n)è¡¨ç¤ºä¸Šåˆ°ç¬¬nå±‚ä¸€å…±æœ‰å¤šå°‘ç§ä¸Šæ³•ï¼Œé‚£ä¹ˆå°±æœ‰F(100) = F(99) + F(98)ï¼Œæ¥ä¸‹æ¥ä¹Ÿæœ‰F(99) = F(98) + F(97)ï¼ŒF(98) = F(97) + F(96)â€¦â€¦ã€‚</p><p>è¿™æ ·é—®é¢˜å°±å¾ˆç®€å•äº†ï¼Œåªè¦è¿™æ ·ä¸æ–­é€’å½’ä¸‹å»ï¼Œæ€»ä¼šé€’å½’åˆ°ä¸€ä¸ªç»ˆç‚¹ï¼Œè¿™ä¸ªç»ˆç‚¹å°±æ˜¯F(1)å’ŒF(2)ï¼Œä¸Šä¸€å±‚å°é˜¶æœ‰å¤šå°‘ç§ä¸Šæ³•å‘¢ï¼Œæ˜¾ç„¶é™¤äº†ä¸€æ­¥è·¨ä¸Šå»æ²¡åˆ«çš„æ–¹æ³•äº†å§ï¼Œæ‰€ä»¥F(1) = 1ï¼›ä¸Šä¸¤å±‚å°é˜¶å‘¢ï¼Ÿä¸€æ­¥ä¸€æ­¥çˆ¬ï¼Œæˆ–æ˜¯ä¸€æ­¥è·¨ä¸¤ä¸ªï¼ŒF(2)åº”è¯¥ç­‰äº2ã€‚é‚£ä¹ˆç°åœ¨çš„é€’å½’å¼åº”è¯¥æ˜¯ï¼š<br>$$<br>F(1) = 1 \quad F(2) = 2 \quad F(n) = F(n - 1) + F(n - 2) (n &gt; 2)<br>$$<br>å°†nå–å€¼ä¸º100ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç®—å‡ºç»“æœäº†ï¼Œç”¨c++å†™å‡ºçš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">F</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> F(n - <span class="number">1</span>) + F(n - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> result = F(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; result;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>è¿™ä¸ªä»£ç è·‘å¾ˆä¹…éƒ½æ˜¯è·‘ä¸å‡ºæ¥çš„ï¼Œå°±æ˜¯å› ä¸ºé‡å¤è®¡ç®—çš„éƒ¨åˆ†å¤ªå¤šäº†ï¼Œè¯¦ç»†è®²æ¥ï¼Œå¦‚æœæˆ‘ä»¬è¦ç®—f(100)ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å…ˆå¾—çŸ¥f(99)å’Œf(98)ï¼Œç„¶åæƒ³è¦å¾—çŸ¥f(99)å’Œf(98)ï¼Œéƒ½éœ€è¦å…ˆç®—å‡ºf(97)ï¼Œè¿™æ ·f(97)å°±è®¡ç®—äº†ä¸¤éï¼Œé€ æˆäº†é‡å¤è®¡ç®—ï¼Œæµªè´¹äº†å¤§é‡æ—¶é—´ã€‚ä¸Šé¢ä»£ç ä¸­åŒ…å«å¤§é‡é‡å¤è®¡ç®—çš„å†…å®¹ï¼Œè€ŒåŠ¨æ€è§„åˆ’ç®—æ³•å°±å¾ˆå¥½çš„è§£å†³äº†é‡å¤è®¡ç®—çš„é—®é¢˜ã€‚</p><p>ç°åœ¨æˆ‘ä»¬ä¸å†ä»100å±‚å¼€å§‹é€å±‚å‘ä¸‹é€’å½’ï¼Œè€Œæ˜¯ä»ç¬¬ä¸€å±‚å¼€å§‹é€å±‚å‘ä¸Šèµ°ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ­£å¦‚ä¸Šé¢æåˆ°çš„é—®é¢˜ï¼Œå¦‚æœä»ä¸‹å¾€ä¸Šè®¡ç®—çš„è¯ï¼Œæˆ‘ä»¬å…ˆç®—å‡ºäº†f(97)çš„å€¼ï¼Œç„¶ååœ¨è®¡ç®—f(99)å’Œf(98)çš„æ—¶å€™ï¼Œå°±å¯ä»¥å…±äº«ä¸€ä¸ªè®¡ç®—æˆæœï¼Œä¸éœ€è¦èŠ±ä¸¤å€çš„æ—¶é—´æ¥è®¡ç®—ã€‚</p><p>ä»åº•å±‚å¼€å§‹è®¡ç®—æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆå¾—çŸ¥f(1) = 1ä»¥åŠf(2) = 2ï¼Œæ ¹æ®F(n) = F(n - 1) + F(n - 2)çš„å…¬å¼ï¼Œå¯ä»¥å¾ˆè½»æ¾ç®—å‡ºF(3) = 3ï¼ŒF(4) = 5ï¼Œç„¶åç»§ç»­å‘ä¸‹æ¨ï¼Œç›´åˆ°nåˆ°100å°±å¯ä»¥å¾—åˆ°ç»“æœã€‚ç”¨ä»£ç å®ç°çš„è¯ï¼Œå¯ä»¥æ–°å¼€ä¸€ä¸ªæ•°ç»„arrayï¼Œarray[n]å†…å­˜å‚¨äº†F(n)çš„ç»“æœã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">F</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">long</span>&gt; <span class="built_in">array</span>(n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">array</span>[i] = <span class="built_in">array</span>[i - <span class="number">1</span>] + <span class="built_in">array</span>[i - <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">array</span>[n];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> result = F(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; result;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>è¿™é‡Œåªéœ€è¦ä¸€ä¸ªå¾ªç¯å°±å¯ä»¥å¾—å‡ºç»“æœå•¦~è¿™ä¸ªä»£ç çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç©ºé—´å¤æ‚åº¦ä¹Ÿè¾¾åˆ°äº†O(n)ï¼Œæˆ‘ä»¬å‘ç°å¾ˆå¤šæ•°æ®éƒ½æ˜¯åªä½¿ç”¨äº†ä¸€æ¬¡å°±ä¸å†ä½¿ç”¨äº†ï¼Œå°†è¿™ä¸ªæ•°ç»„æ”¹ä¸º3ä¸ªå˜é‡å¾ªç¯äº¤æ›¿ä½¿ç”¨å¯ä»¥åŠ å¤§ä½¿ç”¨æ•ˆç‡ã€‚</p><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">F</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> A, B, C;</span><br><span class="line">    A = <span class="number">1</span>;</span><br><span class="line">    B = <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> A;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n == <span class="number">2</span>) <span class="keyword">return</span> B;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            C = A + B;</span><br><span class="line">            A = B;</span><br><span class="line">            B = C;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> C;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> result = F(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; result;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æˆ‘ä»¬ä½¿ç”¨3ä¸ªå˜é‡ABCäº¤æ›¿ä½¿ç”¨ï¼Œåªè¦å§‹ç»ˆä¿æŒABCçš„å…ˆåé¡ºåºå°±å¯ä»¥å•¦ï¼è¿™ç§æ–¹æ³•è¿˜å°†ç©ºé—´å¤æ‚åº¦é™ä¸ºäº†O(1)ã€‚å½“ç„¶è¿™é¢˜æˆ‘ä»¬å‘ç°åˆšå¥½æ˜¯æ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬101é¡¹ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨æ–æ³¢é‚£å¥‘æ•°åˆ—æ±‚ç¬¬né¡¹å…¬å¼å¯ä»¥åœ¨å¸¸æ•°çº§çš„æ—¶é—´å†…æ±‚å‡ºç»“æœï¼Œä½†é‚£å’ŒåŠ¨æ€è§„åˆ’æ²¡æœ‰å…³ç³»å•¦~</p><p>æ€»ç»“ä¸€ä¸‹ï¼šçº¿æ€§è§„åˆ’å°±æ˜¯å…ˆç”¨åˆ†æ²»æ³•çš„æ–¹æ³•ï¼Œä»ç»ˆç‚¹å¾€å‰æ€è€ƒï¼Œç”¨é€’å½’çš„æ–¹å¼å®šä¹‰è§£ï¼›ç„¶åæˆ‘ä»¬å‘ç°å…¶ä¸­æœ‰å¾ˆå¤šé‡å¤çš„å­é—®é¢˜ï¼Œè¿™æ ·æˆ‘ä»¬åˆä»èµ·ç‚¹å¼€å§‹ï¼Œé€æ­¥è®°å½•å·²ç»æ±‚å¥½çš„å­é—®é¢˜çš„è§£ï¼Œç„¶åéœ€è¦æ—¶å†æ‹¿å‡ºæ¥ç”¨ï¼Œä»¥æ­¤èŠ‚çº¦æ—¶é—´ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
